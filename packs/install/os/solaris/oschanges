#!/sbin/sh
# Copy some files and remove some files after the os pkgs were installed
# $Id: oschanges,v 1.17 2003-04-12 15:24:27 ghudson Exp $

# copied from AFS
rm -f $UPDATE_ROOT/usr/ucblib/libucb.so.1
rm -f $UPDATE_ROOT/usr/ucblib/libucb.so
cp -p /os/usr/ucblib/libucb.so.1 $UPDATE_ROOT/usr/ucblib
ln -s libucb.so.1 $UPDATE_ROOT/usr/ucblib/libucb.so



# removed
rm -f $UPDATE_ROOT/etc/rc2.d/S25tsaldog
rm -f $UPDATE_ROOT/etc/rc2.d/S76nscd
rm -f $UPDATE_ROOT/etc/rc2.d/S85power
rm -f $UPDATE_ROOT/etc/rc2.d/S88sendmail
rm -f $UPDATE_ROOT/etc/rc2.d/S89bdconfig
rm -f $UPDATE_ROOT/etc/rc2.d/S99audit
rm -f $UPDATE_ROOT/etc/rc2.d/S80lp
rm -f $UPDATE_ROOT/etc/rc2.d/S90wbem
rm -f $UPDATE_ROOT/etc/rc2.d/S94skiserv
rm -f $UPDATE_ROOT/etc/rc3.d/S76snmpdx
rm -f $UPDATE_ROOT/etc/rc3.d/S77dmi

rm -f $UPDATE_ROOT/usr/openwin/lib/X11/fonts/75dpi/*
rm -f $UPDATE_ROOT/usr/openwin/lib/X11/fonts/misc/*
cp -p -r /os/usr/openwin/lib/X11/fonts/75dpi/* $UPDATE_ROOT/usr/openwin/lib/X11/fonts/75dpi/
cp -p -r /os/usr/openwin/lib/X11/fonts/misc/* $UPDATE_ROOT/usr/openwin/lib/X11/fonts/misc/
rm -f $UPDATE_ROOT/usr/openwin/server/lib/libtypesclr.so*
rm -f $UPDATE_ROOT/usr/openwin/server/lib/libfont.so*
cp -p /os/usr/openwin/server/lib/libfont.so.1 $UPDATE_ROOT/usr/openwin/server/lib/
cp -p /os/usr/openwin/server/lib/libtypesclr.so.0 $UPDATE_ROOT/usr/openwin/server/lib/
ln -s ../libfont.so.1 $UPDATE_ROOT/usr/openwin/server/lib/libfont.so
ln -s ../libtypesclr.so.0 $UPDATE_ROOT/usr/openwin/server/lib/libtypesclr.so

# Turn off sgid bit due to unfixed security hole.
chmod g-s $UPDATE_ROOT/usr/sbin/arp

# Make sure /tmp is a symlink.  /var/rtmp is created by the install.
if [ ! -h $UPDATE_ROOT/tmp ]; then
  rm -rf $UPDATE_ROOT/tmp
  ln -s var/rtmp $UPDATE_ROOT/tmp
fi

# Generate windex files so apropos works
chroot ${UPDATE_ROOT:-/} /usr/bin/catman -w -M /usr/openwin/share/man:/usr/dt/share/man:/usr/share/man

commit 3c95bc468e1af00d98795b0381b5c502bb27115d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:53:01 2010 +0000

    debian: Finalise changelog for 1.4.0-1

commit 2fc0696ba622798ca980e501834d3296619b50fc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:52:26 2010 +0000

    NEWS: Finalise for 1.4.0

commit 08d971a54daf4fc317c05e910a0ca0d8df16092a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:46:47 2010 +0000

    po: Update copyright notice

commit 6a071d5237d08cd577f5a8251aba40117f21534a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:46:27 2010 +0000

    schroot_base::main: Update copyright notice

commit 9eb7739d4b02c2d6830f6824dc2b3aec643f34b2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:33:29 2010 +0000

    sbuild::chroot_facet_session_clonable: Use basename correctly

commit faae6d8d17ff089ae348bed442dd08ffc30d5273
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:33:16 2010 +0000

    debian: Add ${misc:Depends}

commit 580142dbfab068b753b24bf763cbb104a32da3d1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:12:22 2010 +0000

    po: Update

commit 4c57bea8f882f465c1d40be58ce5458276a1c7ab
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:11:59 2010 +0000

    po: Remove sbuild-dirstream.cc from POTFILES.in

commit 810725e28c11705cd199fad52c9fc1d323395214
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 15:06:59 2010 +0000

    sbuild: Remove separator argument from path functions

commit 548200a4c1fb47b1d4887b34d8833dfcb704d887
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 14:55:44 2010 +0000

    .gitignore: Don't ignore test/sbuild-dirstream

commit 986b516a2ece888d858e54b0bc541f13966ee2aa
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 12:59:52 2010 +0000

    debian: Bump version to 1.4.0 and close fixed bugs

commit 063e32f3c62a7f26b7390b6e706f072478292ba8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 12:59:30 2010 +0000

    NEWS: Bump version to 1.4.0

commit 138745a15b38f969d698e0e2ffe798fe09a3c5a3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 16 12:57:44 2010 +0000

    sbuild::dirstream: Replace with boost::filesystem
    
    Fixes issue with path length restrictions.

commit ed8f1696bd84838091ccabc62eb614e61258f4a3
Author: Tim Abbott <tabbott@MIT.EDU>
Date:   Fri Jan 15 23:40:38 2010 +0000

    etc: Update bash completion for schroot

commit 546b04dc2f3745229e6abcffe4df79ecea27dc51
Author: Holger Wansing <linux@wansing-online.de>
Date:   Fri Jan 15 23:32:32 2010 +0000

    po: Update de translation

commit 64d4fed0183a742f9e11a5ebbcffaa973d10469e
Author: Ji ZhengYu <zhengyuji@gmail.com>
Date:   Fri Jan 15 22:04:02 2010 +0000

    po: Update zh_CN translation

commit fd22eef5b97a621fc84e99e16da29059e4c7cc4f
Author: Vincenzo Campanella <vinz65@gmail.com>
Date:   Fri Jan 15 22:02:25 2010 +0000

    po: Add it translation

commit 432e381fe6fb6b6b7819132a4bf3d53a8c2f02b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 21 22:58:41 2009 +0000

    po: Update

commit 2b7972008b35b2f5f4eff4e634fd5ad667067aee
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 21 21:19:57 2009 +0000

    debian: Close #561033

commit 096ee1edd69091e673c09b54618ecdc38fa2fab4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 21 21:18:23 2009 +0000

    sbuild::chroot_block_device: Create session file when using union

commit 3775225ff516fdb2c2c2af5d75da7d71d049bcbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 22:32:06 2009 +0000

    sbuild::chroot: Remove obsolete EXEC_START and EXEC_STOP

commit 5e9a520df47be4dee9533b1a233b2919055c171d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 19:24:15 2009 +0000

    po: Update

commit 1771e6b5899948b7b05c106162ad832c35ea762e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 19:23:55 2009 +0000

    20copyfiles: Remove debug line

commit 49ba6764b8ed5fd95cf1e28f07366a31b27183ea
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 17:34:56 2009 +0000

    debian: Close #559019

commit 2f83302b9c426f598d3afe45f49ebad08aa3cc92
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 17:33:22 2009 +0000

    20copyfiles: Allow copying of special files

commit 2ac672598fbcd7a1f22c2d2f27632a54209c075b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 14:37:20 2009 +0000

    debian: Close #557197

commit f6861681aef2728f12823911a4c17810d6f34445
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 14:35:02 2009 +0000

    sbuild::chroot_block_device: Create session file

commit 2d576ba33dce63c38d4d85c9568b1e2161a830f8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 01:31:01 2009 +0000

    debian: Close #560832

commit b2322fa86aeb45435743270a495aeb19dbb8e5c7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 13 01:29:48 2009 +0000

    Bump version to 1.3.2

commit 810e282f515e59394ccbae6ef6e531789d1926a1
Author: Helge Kreutzmann <debian@helgefjell.de>
Date:   Sun Dec 13 01:26:45 2009 +0000

    po: Update de translation
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 1c0bc8e0abacd4e0af8c67952da052f2840c5944
Author: Jonathan Callen <abcd@gentoo.org>
Date:   Sat Dec 12 13:53:19 2009 +0000

    sbuild::chroot_block_device: Build correctly when LVM snapshot support is not available
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 67abc7560e62fe2916c27330875238846deb7a10
Author: Geoffrey Thomas <geofft@mit.edu>
Date:   Fri Nov 20 20:32:04 2009 -0500

    etc/setup.d/00check: Permit union chroots on the root directory
    
    It's only unsafe for the chroot directory to be the root directory if
    we're not doing a union mount on top of it.
    
    Note that aufs won't let you do a union mount of a parent directory of
    /var/lib/schroot/union/overlay, so you'll need to make that directory a
    separate filesystem, e.g., by mounting a tmpfs there.
    
    Signed-off-by: Geoffrey Thomas <geofft@mit.edu>
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 45e28cef927366943b43bae317299f8792f87d7a
Author: Geoffrey Thomas <geofft@mit.edu>
Date:   Fri Nov 20 20:32:03 2009 -0500

    build: Auto-detect whether -mt is needed for Boost libs
    
    This makes compiling on older distributions easier.
    
    Signed-off-by: Geoffrey Thomas <geofft@mit.edu>
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit b48c7a3b0d1af280e83d02ea06fd4d0d1e433cc9
Author: Geoffrey Thomas <geofft@mit.edu>
Date:   Fri Nov 20 20:32:02 2009 -0500

    scripts/git-version: Ask git for date differently
    
    --date=iso appears to be broken in lenny's git (1.5.6.5). This code is
    simpler anyway.
    
    Signed-off-by: Geoffrey Thomas <geofft@mit.edu>
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 57ea00ec1a2f656a80f13698256c200786c50987
Author: Geoffrey Thomas <geofft@mit.edu>
Date:   Fri Nov 20 20:32:01 2009 -0500

    build: Only use silent-rules if it's available
    
    This permits compiling with an older automake.
    
    Signed-off-by: Geoffrey Thomas <geofft@mit.edu>
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 021904c07d0f4513110b65d2a2aaa1d63cb548a1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 11:39:52 2009 +0000

    NEWS: Document personality fix

commit 913b48cd4ff9bc2626bd70af0b7f51c1bf52384b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 11:14:20 2009 +0000

    TODO: Remove completed items

commit fb1b19fa35044a9af40619b595ddf2b937437c07
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 11:13:34 2009 +0000

    scripts: git-version uses version from NEWS

commit 1dc012bf47a80143e13f0e8a9f3be2933d8449b0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 10:48:12 2009 +0000

    NEWS: Bump version to 1.3.1

commit 11f852474962c43c2cc80d235ea19b1c5a9ddb2a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 10:47:59 2009 +0000

    debian: Close #554907

commit 807a7d07cf7e38ae2dab7400a8be3ba268cd9377
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 7 10:25:53 2009 +0000

    sbuild::session: Set child_status to EXIT_SUCCESS following authentication
    
    If not done at this point, ending sessions etc. can return failure
    even though they completed.

commit c840bc363d63f714778cff774980c158a200a00c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Oct 17 10:10:34 2009 +0100

    test: Fix sbuild-personality to support non-Linux architectures

commit 345826d0edf7aefd57fb2246a0f7ef0fe4774aba
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 23:09:38 2009 +0100

    po: Update

commit 9ec6d78fee4fb3cf94c64910ae2e727f82e7194a
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 23:08:28 2009 +0100

    sbuild::session: When run with --begin-session, exit status must be success

commit b978d7ed824fbb615e9c3c0daa0b1842c43e353c
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 21:45:00 2009 +0100

    debian: Remove empty lines from changelog

commit 9e2d41a2f1766daac53e3085841b90c38f4c6536
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 21:43:55 2009 +0100

    po: Update en.po

commit 90eb2cad2fa69313bf5572cd89b54edafe1f2f3b
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 21:16:30 2009 +0100

    build: Replace SCHROOT_RELEASE_DATE with m4_esyscmd

commit 97f253b800c917f8ff62ce4ec7e76da585ce1325
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 20:31:26 2009 +0100

    po: Update po files and en translation

commit 7aac0cea37b2eff26b06f79ca285a17bfeb494cc
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 19:04:46 2009 +0100

    debian: Use Standards-Version 3.8.3 and Boost >= 1.39

commit 9d75a50252d4fd7f487f807929b8486107f3932a
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 09:29:06 2009 +0100

    NEWS: Bump version to 1.3.0

commit 11653f7e7df4998d00e53c5a1e0d81b28b5d0512
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 09:12:26 2009 +0100

    debian: changelog: Add 1.2.x changelog entries

commit a4ba507b1771cb56da818dc17ee7a63e053d4d65
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 16 09:10:59 2009 +0100

    NEWS: Add 1.2.x changes

commit d533f019d030b1739784ca27b2ee3e95b7fff9f6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 11 13:53:27 2009 +0100

    sbuild::stat: Support C string constructor

commit 11ea9932e8d90e4e0681f3062f26b494842e675d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 22:52:44 2009 +0100

    sbuild: Add reentrant passwd and group wrappers
    
    In order to make the library thread-safe, use the reentrant
    getpw*_r and getgr*_r functions in place of the older unsafe
    functions which use static buffers.  The passwd and group
    structures are inherited by C++ classes of the same name which
    allow handling of dynamic memory allocation while at the same
    time allowing use of RAII and passing to C functions.

commit 6fe0df0c4cb22e81e3850384fd3b208b8848bbe7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 21:02:35 2009 +0100

    test: Add root-user preservation check to chroot-directory

commit 15f37205a1ac958eb94cf23e30042455d85af049
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 20:54:49 2009 +0100

    sbuild::chroot_facet_session_clonable: Only allow session creator to access session
    
    Previously, any user who had access to a chroot automatically gained
    access to any sessions created from the chroot.  This has now changed.
    Only the user creating the session will be granted access, in order
    to improve the security of sessions.
    
    The chroot clone_session method takes two additional arguments: the
    user who will own the session, and whether or not the user is to
    have root access.  This is used by the session code, and eventually
    passed to the session clone_session_setup method which will update
    the properties to match what was requested.

commit 4cf19754d5225f516898ead8644255aeb40d12bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 20:15:34 2009 +0100

    sbuild::chroot_facet_session: Remove unused clone_session_setup
    
    clone_session_setup is now in chroot_facet_session_clonable.

commit c41b52a2a58d1c793cba23eeda63053eece5663e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 20:13:43 2009 +0100

    sbuild: Validation of chroot properties allows strings to be empty
    
    Before a chroot is fully initialised, it is possible for some
    properties to be empty strings.  Don't fail in this case.

commit 43caff2968a412abeebfa386c96c675f2f89e117
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 12:39:27 2009 +0100

    build: Remove -mt suffix from Boost library names
    
    This matches changes upstream and in Debian

commit bb99a14ecd929324d1d4d97250fe74ead819969e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 27 12:33:56 2009 +0100

    bin: schroot_base_main: action_version prints configured options
    
    schroot::main_base additionally prints configured chroot types.

commit 6b13c94d56a5d5d1d25cf01640ca51b04425a0cc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 20 11:19:51 2009 +0100

    csbuild: Update option group description

commit 82a89e791735a1184239341fa94f56f4d289ea39
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 20 11:19:29 2009 +0100

    csbuild: Fail following exec failure

commit 8aa73e3278edeaa456efa56015a7787bb3b79be2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 20 00:26:17 2009 +0100

    csbuild: Add all sbuild options and wrap sbuild
    
    All sbuild options are supported.
    Excutes sbuild following options parsing.
    Initially csbuild is simply a thin wrapper around the perl
    implementation of sbuild, and does nothing that a direct
    invocation does not do.  It may be possible to move logic
    into the csbuild implementation in the future.

commit 8bd31862e2339508f2e49f9df4bf5b3fb26030b3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 19 18:15:05 2009 +0100

    build: Use MKDIR_P in place of mkinstalldirs

commit a09167ff1be49eddbb18a134c09c97881ca532bd
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Sep 14 20:32:14 2009 +0100

    debian: Close #545706

commit 869bc1ae63dfd92ac69fb6a1d6c1ae39724b8059
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Sep 11 11:17:30 2009 +0100

    sbuild::session: Default child_status to EXIT_FAILURE
    
    Previously, the default of 0 (EXIT_SUCCESS) would result in
    a zero exit status on authentication failure.  By defaulting
    to failure, a nonzero exit status is returned for all failure
    conditions.

commit 57c2ce78e6f4eaa31e05f354445676a0e562cc82
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Sep 9 21:50:26 2009 +0100

    sbuild::chroot_facet_source_clonable: Remove source_clonable member

commit 6826d5cdff99be9469aada0a7d7a6413e2a4156d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 23 13:58:35 2009 +0100

    build: Require automake 1.10 and use silent-rules

commit fb9c16f18e82b016a50895262852b86b38725f1f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 13 21:48:30 2009 +0100

    sbuild::chroot_facet_session_clonable: Remove source keyfile deprecation

commit 30bf30e3500d6192be08ac2ecba2620aaf47a728
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Thu Aug 13 21:21:00 2009 +0100

    doc: Fix some doxygen class headers
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 8095714d69e3b321a116c9d63cfdbc5aea98be29
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Thu Aug 13 20:52:22 2009 +0100

    schroot: Document session usage relating to --chroot
    
    Also warn if --session-name is used inappropriately.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 01fb0738d264c47a55721fa1318051ad0dfbd94a
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:21:14 2009 +0100

    test: Cleanup keyfile and environment tests
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit e0005ca5bd530673db7f4c43d2b835ccde8f0e0d
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:11:15 2009 +0100

    test: Print key and value for keyfile and env
    
    When checking keyfiles and environments print the value of the
    missing or additional key and value pairs.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 1a3720699ec9c3ce20e90852e16233922fad9c66
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:09:06 2009 +0100

    sbuild::chroot_block_device_base: Don't lock union block devices
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit bdf80af0fa323f09253dc1971f4d9a2353d9c808
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:07:05 2009 +0100

    .gitignore: Add VERSION and .gdb_history
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 5650787b8f0f0c2e33be4b4d411917add55ff7a9
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:06:15 2009 +0100

    sbuild::chroot_facet_union: Really use own error messages
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 5bdfde2bdebd69e30ac6670a440db1b5575815d0
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Mon Aug 10 23:05:24 2009 +0100

    etc/setup.d: Cleanup union handling in scripts
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit a76b43792cacb0cf27eb7e78c602594f58ff80d0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 8 23:14:28 2009 +0100

    TODO: Distinguish between chroot, source and session

commit 78c21735a84ff63515582765f6fd4d4efc091491
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 8 23:08:43 2009 +0100

    sbuild::chroot_facet_mountable: Only serialise mount-device for sessions

commit 1bb9bd6f4334a42322461a3a9fcde004f5a39b52
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 8 22:44:04 2009 +0100

    test: Add mount-device to keyfile checks

commit 3f93c650e2ddb338d515713a01d584ea6c3f9cb0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 8 13:26:53 2009 +0100

    sbuild::chroot_facet_session: Split into chroot_facet_session_clonable
    
    This is the same as the chroot_facet_source split.  Basic chroots
    have the chroot_facet_session_clonable facet if they support
    session cloning.  Once cloned, this is replaced by the
    chroot_facet_session facet.
    
    The session facet no longer has session_managaeable and session_active
    properties; these are implicit based upon the presence of the
    chroot_facet_session_clonable and chroot_facet_session facets,
    respectively.
    
    get_active now just checks for the presence of the chroot_facet_session
    facet.  set_active is no longer supported, and has been removed.

commit d6645ac9dfdacda98ae73fd26d28e9f3c45f8e29
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 6 22:07:42 2009 +0100

    etc: Remove SBUILD script default
    
    50sbuild was removed from both schroot and sbuild, so SBUILD is now
    redundant.

commit e1e1156f904007a2f4574a8a9186ae6022fe0298
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 6 22:06:57 2009 +0100

    man: Document NSSDATABASES

commit 5394988549e0c8f13f1989a1b5f909e8c1a3c73a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 6 00:22:54 2009 +0100

    sbuild::run_parts: Correct poll conditional
    
    Use 'revent & POLLIN' rather than 'revent | POLLIN' which is always
    true, to prevent blocking indefinitely on reads.

commit 463e9bddb66b8def7438b6bd99a58f85fa88dfff
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Aug 5 23:55:24 2009 +0100

    sbuild::run_parts: Handle EINTR during reads

commit 81a14a9f4b9d526c58ceff35af903b40dc127817
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Aug 5 23:33:07 2009 +0100

    po: Update

commit 9a5292e6dead8021d8dcb5213a36da466b3ae44c
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Aug 5 23:11:24 2009 +0100

    po: Add .tcc files

commit 1342c21c0185d7ab16050940aed22d30ca24b134
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Aug 5 23:10:39 2009 +0100

    etc/setup.d: Set file unpack directory and add extra logging

commit bc695fa6c8e6cb600a2f4280c4a2c01f04cee3ca
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 4 23:23:43 2009 +0100

    TODO: Remove done and add pending changes

commit 1644447f06ef0c1273cc660e2e9619f3bfef1e25
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 4 23:19:24 2009 +0100

    sbuild::session: Split UUID generation into support function

commit d5fb5daaaab816a3d8394acfcea1e3927e13b567
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 4 21:35:45 2009 +0100

    sbuild::chroot_facet_session: Use correct class name for null method pointers

commit 46a99ea9e16626905358afbfc6af96adc2878452
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 4 21:34:21 2009 +0100

    sbuild::chroot_facet_mountable: Serialise mount-device to keyfile

commit a526955cac959d2fde5700197fe57e74c224f6b0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 4 21:32:44 2009 +0100

    sbuild::basic_keyfile: Ask user to update deprecated keys

commit 45364d48302ab5a4f3152159955c217306146a8c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 2 23:58:46 2009 +0100

    sbuild::chroot_facet_session: Move deserialisation code from chroot_facet_source

commit ecef43fd08506c3ab071bd6b5348534d3b9ba11d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 2 18:24:49 2009 +0100

    sbuild::chroot: clone_session is pure virtual and chroots always clone
    
    All types of chroot except plain support session cloning in all
    circumstances.  Previously, block-device and loopback types only
    cloned a session when union support was active.
    
    Update tests to reflect the change.

commit 61d81581994dc1c562dd9f0911d71e604c7f9b7c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 2 18:21:29 2009 +0100

    etc/setup.d/10mount: Comma-separate loop mount option

commit 5d326a300617724d140da35041e01f09ad2de5de
Author: Tim Abbott <tabbott@ksplice.com>
Date:   Sun Aug 2 18:20:05 2009 +0100

    etc/setup.d/10mount: Properly quote do_mount calls in 10mount
    
    Signed-off-by: Tim Abbott <tabbott@ksplice.com>
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 42eafc2fabb7b9c7b0d0b106ebe30b9ecaa91fad
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 2 18:15:51 2009 +0100

    build: Build static library by default

commit 4bf986a593950a5d5e1ad1294e3cd17d57bec8c7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 15:27:33 2009 +0100

    etc/mount-defaults: Add /dev and /proc/bus/usb (but commented out)

commit 97e3ab2c8e86762fc42c4dcab89e688fbd325c55
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 15:27:11 2009 +0100

    po: Update

commit 89f76a2e05ecc01e3a9ca2a75927f38f47e19a3f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 15:25:29 2009 +0100

    po: Update POTFILES.in for new sources

commit e0ea93c0ef4b2e0cf8122147add98f382fa66004
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 15:14:25 2009 +0100

    scripts/git-version: Allow hyphens in version number

commit 88c68712abeef2c30cac98f280d5612de6c5bc50
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 14:54:27 2009 +0100

    NEWS: Update to 1.3.0-rc1

commit dd3f92d076b8bed1b7e0d93d24923c750d9206bf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 14:53:58 2009 +0100

    build: Add git tagging code

commit fd1dd4f9e5b972f054d230e1875efe6bac1e0945
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 12:47:31 2009 +0100

    sbuild::chroot: Don't write 'active' key
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit c86463b94ca36626eb80111e9c7c8eb96f40e1e9
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 12:44:57 2009 +0100

    debian: control: Add better schroot-dbg package dependencies
    
    Changes dependencies and adds conflicts to allows installation
    of a single binary package together with the -dbg package.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 64a0d8b31a39ecaeab9620778e7414bdd1c4adf2
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 12:42:09 2009 +0100

    sbuild::chroot Convert facets from vector to list
    
    For chroots implementing the union facet a source facet is added
    dynamically to the facet. This happens on load depending on the
    configured union type and renders most iterators invalid.
    
    So we use list as its iterators won't invalidate except if their
    list item is freed.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 6b9c69188e1d6e5f0e4ca3ae26523fa5e89c7857
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 11:53:52 2009 +0100

    etc/setup.d/10mount: Don't quote mount options

commit 2c12c3f204dba97abd98141fc46b42c71a8e6423
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 11:52:54 2009 +0100

    etc/setup.d/10mount: Reuse loopback device
    
    Checks if any loopback device points to the file and reuses it.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 1a9a722761e5046d5f60c492a00c700559414afa
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 1 11:27:00 2009 +0100

    sbuild::session: Only use session_id property for cloning sessions
    
    Only set from user options, and don't use for reporting or setting
    environment.  For these uses, use the session chroot's session_id
    instead.

commit fce481cf76cf7c30c0924a7534351ed4a0538ead
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 11:13:58 2009 +0100

    sbuild: Some cleanup for directory and union chroots
    
    Introduces own error messages for session underlay and overlay
    directories.  Drop an unnecessary variable usage from the session code.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit a7b8d4501bce399bc10edb26e443a757c6aed91e
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 11:03:05 2009 +0100

    build: Use $(mkinstalldirs)
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit b18fb9aa88484f10ce096f018b3e3e4aff005c22
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 10:59:54 2009 +0100

    etc/setup.d: Cleanup union handling in scripts
    
    The underlay directory should be empty after umounts, so it
    should be sufficient to remove it. This won't purge content
    if umount failed.
    
    Additionally cleanup 10mount to fail if union filesystem is
    missing and just cleanup underlay in union mode.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 51bf94f6a4675edcb7bd1e88d6e8e3cdb31ebdca
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 01:32:48 2009 +0100

    test: Unify environment tests
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit a5c7ba9a86f898f9c063ce35770f8502b5f51f84
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Aug 1 00:09:52 2009 +0100

    test: Add set_run_setup_scripts tests
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit bcc4cfe6286744f58ca1920f5335ed50074986fa
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Fri Jul 31 01:06:47 2009 +0100

    test: Use sbuild::getcwd to get abs_testdata_dir
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 7d8fdb8b8cddcf4cab080613a374927c713bd605
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 31 00:48:06 2009 +0100

    sbuild::chroot_facet: Update all facet uses to use ptr and const_ptr types

commit 2f4ddd9a192b95ed387a8222022252df48879af6
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 31 00:31:07 2009 +0100

    sbuild::chroot_union: Replace with chroot_facet_union

commit d66c5c052424d286afa2a0a49608d134d866517e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 30 21:46:18 2009 +0100

    sbuild::chroot_mountable: Replace with chroot_facet_mountable

commit ad8cc140e83af2650473c3c5f799a9d445adab1e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 30 20:31:49 2009 +0100

    sbuild::chroot_source: Reimplement as facets
    
    Split into two facets, chroot_facet_source_clonable (for chroots
    providing clone_source functionality) and chroot_facet_source
    (for the resulting clone).  This separation means that a single
    class doesn't need to cater for two essentially separate uses.
    
    The ability to list the installed facets, and name each facet for
    human consumption has been added.

commit 9c4662296fd453af03be07797b3b70d068ddb10e
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 29 23:52:47 2009 +0100

    sbuild::chroot: Add clone_source virtual method
    
    By default, return null.  Also make clone_session non pure,
    and remove it from chroot_plain since the default implementation
    works in place.

commit c9d6af6ac06578a4b2f6bb068c305440faca536d
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 29 23:22:18 2009 +0100

    sbuild::chroot: Enable session facet
    
    Replace sbuild::chroot_session inheritance with
    sbuild::chroot_facet_session.
    
    Side effects are:
    - "active" keyfile is no longer used.  Deprecate and make non-functional.
      active status requires setting by hand.
    - SESSION_CREATE flag is now set consistently for all chroot types.
    - sbuild::chroot has a copy constructor to correctly copy chroots,
      including duplicating contained facets (or else it does a shallow
      copy of the pointers only).
    - sbuild::chroot {get,set}_active call sbuild::chroot_facet_session
      {get,set}_session_active methods, respectively.

commit 8f0bc6e4d26bba0d089f78173a2eed6590096328
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 29 23:13:12 2009 +0100

    sbuild::chroot_facet_session: Add new session facet
    
    This will replace the current session code in chroot_session.

commit a743ad25bacde5494a3ed2f0c5241c8ac00cc037
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 29 23:12:24 2009 +0100

    sbuild::chroot_facet*: Add ptr typedefs and create and clone methods

commit 83e49492e36e643e460198f3f3b46e8763200659
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 29 23:11:28 2009 +0100

    sbuild::chroot: Add const_ptr typedef

commit bafc393311aeb1ea044f865035a68eb789fd71a8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 23:05:39 2009 +0100

    sbuild::session: Use common name for personality facet pointer

commit 8d07133fd784fff46b472f36cd7328f5fa7313df
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 21:05:13 2009 +0100

    sbuild::chroot: Call methods from facets in addition to virtual methods
    
    For all methods provided by the chroot_facet interface of installed
    facets, call the appropriate method for all installed facets in addition
    to calling the virtual class methods for the specific chroot type.
    
    Replace personality support directly in the base class with
    chroot_facet_personality to test facet support.

commit 863cd9e721a8171470fa014f08e749b6a60f622a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 21:03:22 2009 +0100

    sbuild::chroot_facet_personality: Add personality support from sbuild::chroot
    
    Copy all personality code from chroot base class.

commit 435a946e08e32fe4a2d4d8714ada1deba3571eb2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 17:47:04 2009 +0100

    sbuild::chroot: Pass chroot as parameter to facet functions
    
    This is the first step to separating all derived chroot functionality
    such that it will not be derived from the sbuild::chroot class, but
    instead be contained within the chroot.

commit 8147ea935fb54c5f8b9339a99e9649442de3fa4a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 16:02:16 2009 +0100

    sbuild::chroot: Add interface to add, remove, replace and get facets

commit d6379763009c1b66f977aa0205e3db6742900d19
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:10:50 2009 +0100

    po: Update

commit cf0d610a5688c23318de28bbf2e24c4d64e6f895
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:08:40 2009 +0100

    sbuild::chroot: Session ID detail only printed if session is active

commit 9d5d449c3b246fda000ea9540e619d00d12a2452
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:08:03 2009 +0100

    sbuild::chroot: setup_env method is const

commit ea4881cda14bbb9482dd3f0a229d26912908d8f9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:06:56 2009 +0100

    sbuild::chroot: Add initial chroot_facet support

commit c37ff4407743e15aa90fde1504cad813e1d85c3c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:03:37 2009 +0100

    sbuild::chroot_source: Allow setting of source-* properties for non-clonable chroots
    
    Pointless, but needed for backward-compatibility with sessions written out
    by older schroot versions.

commit d9931d8c685476ef9b8c6fb8ef316d33109ff8c9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 12:02:18 2009 +0100

    sbuild::basic_keyfile_parser: Constructor explicitly initialises all members

commit fedc7f9b861e36dd1173aa92d7c2248e51537384
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 11:59:51 2009 +0100

    sbuild::keyfile_parser is a class not a struct
    
    Explicitly default construct parent class.  This would have already
    been done implicitly, it's just for safety.

commit ce23707a79d98c0ce20721d8a841cd68fa4a1dff
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 11:58:40 2009 +0100

    sbuild::session: Search for command-prefix using search path
    
    An absolute path is no longer needed for the command.

commit d07479ec678a229f4e8edd6e6f643607f9e6cd78
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 11:55:10 2009 +0100

    .gitignore: Ignore new separate chroot-* tests

commit 6f78459d4de09a1821a9a41785e7dc905f34b723
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 26 11:53:10 2009 +0100

    sbuild::chroot_facet: Add chroot_facet interface and skeleton personality facet
    
    Facets are aspects of chroot functionality which are extensions to the
    functionality of the basic chroot class.

commit 52b88e78094098e0204c16d1c3fe4adea8d5dc99
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 20 20:20:26 2009 +0100

    [sbuild::chroot] setup_env is const

commit 5923ed6c2b66c8ef591bca22d9c3dea98f452af7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 19 14:49:02 2009 +0100

    [po] Update translations

commit 49d8cda372494dac9bf08ee600908db2fd9dc0dc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 19 14:47:34 2009 +0100

    [sbuild] Enable chroot_session in session
    
    sbuild::session creates sessions using clone_session.
    lvm_snapshot exports snapshot options into environment.
    tests updated for session creation.

commit bc54529b116097d9a77731dba4874863fe16d281
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 19 00:34:22 2009 +0100

    [sbuild] Update doxygen comments to fix missing or broken parts

commit 12b1ad5bd82991df0f4b5a6b20a1885ae753141e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 19 00:33:09 2009 +0100

    [doc] Use .log files in place of -stamp files
    
    Make schroot depend on sbuild to avoid breaking parallel builds.

commit cb2db1b4a05f63566f7728cad07586f32b62652b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:58:57 2009 +0100

    [doc] Update doxygen version to 1.5.9

commit 7b68a82f74b507b9952af927d54a66f50f48e950
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:55:48 2009 +0100

    [test] Add tests for keyfile and environment
    
    Add automatically created chroots for testing session and
    source as well as regular chroots, plus union variants of
    all three.
    
    Add checks for all usable variants of the above for
    keyfile and environment serialisation.
    
    Note: no tests for de-serialisation.
    Note: no tests for source->session, only chroot->session
    and union->session.
    
    Common test parameters added to base class.

commit 1f887ebf1ae73e9b4ef4d1a0efd1a0139326cc7f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:51:38 2009 +0100

    [sbuild::chroot_session] setup_env is virtual

commit 5c1b68334c3002cf58cb6b77343fc03cca40452a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:50:46 2009 +0100

    [sbuild::chroot_session] set_session_active chains up to base set_active
    
    Needed for compatibility until the main codebase uses the
    chroot_session functionality.

commit 870cbb053eefc5f7986a22991fda8608c99afa83
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:50:12 2009 +0100

    [sbuild::chroot_file] Reindent conditional statement

commit bff7df114e2488402f43a9b64179570fef7c10ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:45:13 2009 +0100

    [sbuild::chroot_file] Purge if active
    
    If session active (i.e. a clone) then mark as purgeable.

commit 9c2a2fd50020f576384be8805f071cda4eac8ecf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:42:53 2009 +0100

    [sbuild] clone_ methods satisfy testcases
    
    Update all clone_source and clone_session methods to pass
    testsuite.
    Don't make temporary copies of shared_ptrs for no reason.
    Remove unnecessary nested #ifdefs.

commit 1bfe9677972b48441909766740c9b05beccc7075
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:40:08 2009 +0100

    [sbuild] define copy constructur in classes inheriting chroot_session
    
    Since chroot_session is temporarily using virtual inheritance
    until it can be refactored, copy constructurs much initialise
    it first in the initialiser list or else it gets default
    constructed.

commit 8b194667255b47a2d44b8889764dbcc6c6b400c1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 18 23:02:53 2009 +0100

    [sbuild] sbuild::chroot inheritance is non-virtual
    
    Being virtual is no longer needed, and complicated
    copy constructors.

commit c935709ba1d6924db50569892b317fc666b8d0fa
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 17 23:54:31 2009 +0100

    [test] Add session checks to sbuild::chroot_loopback

commit e8a3b112a62d42356237469ec4bc7c7aa1eb6016
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 17 23:53:25 2009 +0100

    [sbuild::chroot_union] Set SESSION_PURGE session flag if a session

commit 3b25c7523b57fd09e0aff8fbf1bcdd27d1d66c64
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 17 23:52:11 2009 +0100

    [sbuild::chroot_session] Set base chroot active and set source options
    
    Set the base chroot active property when cloning a session.
    If a source chroot, also disable cloning.

commit e030079e44a455a9f62a4347338c85050a32ac95
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 17 23:08:11 2009 +0100

    [sbuild] Add support for chroot_session to all session-creating chroot types

commit 3c14e12b972ab57f6f81c9a78ea0157ab6562a49
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 13 23:26:09 2009 +0100

    [sbuild::chroot_session] New class for session handling
    
    Implement in sbuild::chroot_directory.
    
    Rather than handling chroot session logic in the general
    sbuild::session, this should be handled directly in chroots,
    which will remove the need for all the special-casing in
    sbuild::session.  Chroot setup can then be handled directly
    by chroots themselves.  Sessions will then be cloned from
    chroots in exactly the same manner as source chroots.

commit 6aeff726fbe487c7180ec2618a3358cccb7a07a4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 12 01:30:28 2009 +0100

    [test] Test source environment

commit 9b4c05c69d1531a83c3711c92ad540a4f425f8b2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 12 01:08:15 2009 +0100

    [sbuild] Don't call specific clone_source_setup
    
    Calling specific class implementation precludes virtual
    functions being overridden in derived classes such as
    chroot-union.

commit fc82935922dcc04b8748463e3e8c2ca68c9eb5cd
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 12 01:06:53 2009 +0100

    [sbuild::chroot_union] Display union type

commit 9e0959ee69ea357b0813f56da84a50b0b5f7927c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 12 01:06:17 2009 +0100

    [sbuild::chroot_block_device] Chain up to virtual base in all copy constructors

commit 7d1625f7161ceb890d229ba5d6309c62ed0c0502
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 23:08:31 2009 +0100

    [test] setup_env_chroot adds common environment

commit 06559fbfed0b9c84a1549725e504fee190ae3ee2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 21:30:47 2009 +0100

    [TODO] Remove virtual inheritance

commit cd45e35e903396a66f163cba6931b8e5cf85c9ce
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 21:28:25 2009 +0100

    [test] Test keyfile serialisation
    
    This has picked up a number of subtle issues with the code,
    which were fixed in the previous commits.

commit 7d3826b77d31033131b73e7be1ac426dd3bbf42d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 21:27:47 2009 +0100

    [sbuild::chroot] Make some methods public for testing
    
    get_details, print_details, get_keyfile and set_keyfile are public

commit 3206495531a5580b572cb91681069de0649f08a8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 21:24:45 2009 +0100

    [sbuild::chroot_source] Replace is_source with source_clonable
    
    This fits the use-case for is_source rather better, and allows
    it to be overridden by chroot_union (since source options aren't
    available when union is not enabled).

commit 98e38238674878dd665a05f819c0bcb616905970
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 21:22:35 2009 +0100

    [sbuild::chroot_lvm_snapshot] Only inactive sessions serialise lvm-snapshot-options
    
    Not used by active sessions since the LVM snapshot device has
    already been created.  The same applies vice-versa for
    lvm-snapshot-device.

commit b494804d6334e701cec491b35c243216002f3b3a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 00:25:11 2009 +0100

    [sbuild::chroot_block_device] Chain up to chroot in copy constructor
    
    Since chroot is pure virtual, it must be chained up to in the
    copy constructor of the most derived class or else it gets
    default constructed.  This is needed for lvm-snapshot source
    chroot construction (which worked previously due to block_device
    being a direct base).
    
    Long-term, the virtual public chroot inheritance needs removing.

commit ff341cd1474cedf9e98f3cd065b0e4fa7a2ad06c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 11 00:24:41 2009 +0100

    [sbuild::environment] get method is const

commit 589b26fa174e9810f3a04735c2cfe2d9e16888bc
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 10 20:22:48 2009 +0100

    sbuild/sbuild-config.h.in: Get default environment filter from configure

commit b46335ecfa4d0beb5ad5f6856a793e93568f1c4c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:46:49 2009 +0100

    [sbuild] Rename chroot_plain_base to chroot_directory_base

commit ee45beabf3212707c4492aedf4df7597f3d516d5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:37:17 2009 +0100

    [sbuild::chroot] get_mount_location is not virtual
    
    Not overridden in any derived classes, and of no benefit.

commit b2b97969b33d7e9be6de49597ca33a87e7b15c66
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:34:17 2009 +0100

    [sbuild::chroot_mountable] get|set_mount_device are pure virtual

commit 1176d3aacf3ed7f9783e036d47bcdc3ae1e34f02
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:33:11 2009 +0100

    [setup] 15killprocs doesn't abort if there's no mount location set
    
    Not all chroot types set it, so just exit without error if not present.

commit 7ac6634d4ec672868694f72070e2aa60aff95f78
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:32:52 2009 +0100

    [setup] 05union doesn't abort for non-union supporting chroots

commit 775db410ec04bd92878e17542796b712ef2237d2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:31:32 2009 +0100

    [sbuild::session] Correct check for plain chroot type
    
    Inverse check caused mount location to not be set for non-plain
    chroot types.

commit 6347d1102aaf5b77a2bf756733b107e9db5a44d7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 23:26:36 2009 +0100

    [sbuild] Split chroot_plain into chroot_plain_base
    
    chroot_plain and chroot_directory inherit from chroot_plain_base.
    This allows dynamic_cast to chroot_plain from chroot_directory to
    fail due to not being in the inheritance hierarchy for directory.

commit 0b4a5118386ab83197a209c597abebb416f0935e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:50:37 2009 +0100

    [po] Update translations

commit 969731a65d52c40edb72a5f4182a4bab4b0e0310
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:47:31 2009 +0100

    Update copyright message for 2009

commit 4efeb8e1b0b63df278fdc27f196626fc2369b6bc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:44:21 2009 +0100

    [po] Update translations

commit a5eeb29243a3beb82dd316072793762ba506d764
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:43:11 2009 +0100

    [sbuild::session] Don't special-case handing of union mount location
    
    Union can use the same mount location as all other types; the 10mount
    script can alter which of the variables is used for mounting at which
    point.

commit 116b57a499cb70abb0571f5342832b63d31bbde7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:41:25 2009 +0100

    [setup] 10mount union mounting uses underlay directory
    
    CHROOT_SESSION_PURGE logic removed; it is not required for union support.
    Don't modprobe modules by hand, since it's automatic.

commit 9b486bd93bddd8b39635ba27db7865b587159a75
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:40:33 2009 +0100

    [setup] Rename 05fsunion to 05union

commit b255369875d6e208a6a171537a4fec8c9fb16112
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:38:44 2009 +0100

    [setup] 15killprocs adds sanity check for CHROOT_MOUNT_LOCATION

commit fda09dc8474301af4cb125a2d22c01b9d9ecafc7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:38:03 2009 +0100

    [setup] Add 99check symlink to 00check to run on setup-stop

commit 8f2eb3ed7e496b6ff3c64a9a2ab3aaf5692a5973
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:25:17 2009 +0100

    [sbuild::run_parts] Fix script stream buffering
    
    Give stderr priority over stdout.
    Always flush buffer to the maximum possible.
    Use split_string_strict to avoid losing newlines.

commit ce38ce45588fff9c7b812d516902728fc40fecb8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:24:32 2009 +0100

    [sbuild::chroot_union] Only set keyfile keys if union is configured

commit 43cfe200c2f00f36476c704739c061c993c40b8f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:22:48 2009 +0100

    [sbuild::util] Add split_string_strict
    
    split_string splits a string into chunks separated by the
    specified separator.  split_string_strict doesn't eliminate
    empty strings when the separator appears at the string start
    or end, or if multiple separators are joined together.

commit 4801d8ac4c3975a6be488ee0577f1a36f3945acf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 17:22:03 2009 +0100

    [sbuild::session] Only display command/shell if verbose

commit e86d4dc045f4e4764a3c03dd4a740992ebaa0262
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 16:31:44 2009 +0100

    [NEWS] Document filesystem union support

commit 5c85dec311d9a298a2bab8fcddb319d483ff1422
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 12:13:21 2009 +0100

    [debian] Update to Standards-Version 3.8.2

commit dba8eba033b5912c10b0b2a552da51a15e2fc1bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 12:12:09 2009 +0100

    [man] Disable adjustment on long line to fix groff warning

commit 0f30b3a1b9d2775c443b85c14842dff05c682b14
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 11:07:21 2009 +0100

    [sbuild::session] Correct logic for setting mount location
    
    Set mount location if:
    - the mount location is not already set AND
    - the chroot type is NOT plain
    - AND additionally, if union support is available, if union is
      configured.

commit fa0183e6997c150b0f4177eaa692b3c710dd9f0a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 10:43:14 2009 +0100

    [sbuild::chroot_directory] Always chain up to union methods
    
    Union itself handles whether or not it is enabled, so directory
    doesn't need to handle it specially.

commit 4a7fe3f8c0eda5c30e07b0d04d5122c17fcbb802
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 10:42:43 2009 +0100

    [sbuild::chroot_union] Only print union details if configured

commit ce842934c2e05646823df5e4d00c8d2d0ab530f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 02:05:20 2009 +0100

    [sbuild::chroot] set_run_setup_scripts is protected

commit 766e881ec392612b6aa5354847847a2af157665c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 02:03:41 2009 +0100

    [sbuild::chroot*] Remove duplicated source methods and members

commit 4a19a112e56e03af929061b5bef038cf263d7ce7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 5 00:17:51 2009 +0100

    [sbuild::chroot_source] Re-unify source member variables and methods

commit ac237e1d3d6685628186756207a2d51505f02064
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:54:36 2009 +0100

    [sbuild::chroot_block_device_base] Simplify session flags

commit beae18c3245a46b2e21a19f6be276c4fff3203f1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:52:39 2009 +0100

    [test] Remove obsolete run_setup_scripts checks

commit 86cc0c5b0c23756999aae9b9f8d199670d40bde4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:51:07 2009 +0100

    [test] Make filesystem union tests conditional
    
    Also add tests for session flags when unions are enabled

commit eaa9b086be62fd26afb521ab22eb31a9ac04bc69
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:28:42 2009 +0100

    [sbuild::chroot] Reindent session flags

commit 22b2b21f6dc86fb9519030581deb98e5c0be2137
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 23:27:53 2009 +0100

    [sbuild::chroot] set_session_id sets session ID

commit a6b821f798033e4d4be403caaa92d055d89bee80
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 23:26:56 2009 +0100

    [sbuild::chroot_loopback] Add locking

commit 1247adea3fbcff8e77d8e12062ada3387f3be741
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:22:28 2009 +0100

    [sbuild] Reindent sbuild::util operator functions

commit f4ed0a80c7d63b24d9f3b4d6276018313a52d062
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 23:21:36 2009 +0100

    [sbuild] Move getcwd from sbuild-session.cc to sbuild-util.cc

commit e71a686cfa65927460afff06ffaba5e6e0ac8bd1
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 23:19:36 2009 +0100

    [setup] Remove plain chroot type
    
    Plain chroots don't run setup scripts, so remove all special-casing
    for plain chroots.  Add a check to 00check to ensure the scripts
    abort if plain chroots attempt to run them.

commit 2b9aa33ee2e84c708853daf5e1b6af0a392de367
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 23:18:40 2009 +0100

    [debian] Remove debian/install after running dh_prep

commit 5e694ee0d09dfca42af1213c9218327565f8d3ef
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 15:36:13 2009 +0100

    [build] Fix union configure check

commit c0b320da8a4fef15bfe9044650c21628adf28f14
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 15:04:32 2009 +0100

    [build] Remove config.h.in~ when bootstrapping

commit a470e128144c555852765306f783dd27535cd45b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 15:01:08 2009 +0100

    [test] sbuild_chroot_loopback: Update to use current union interface
    
    Remove use of get/set_container and chroot_strings.

commit 5cb078fac13fc117f4b34969146863846bc94730
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 15:00:44 2009 +0100

    [test] Remove whitespace

commit 41d4b203ecb896fb66f726106c75166858916a31
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 14:58:03 2009 +0100

    [test] Improve environment diagnostic
    
    Add observed and expected descriptions

commit 90a472a5251ab42a6ba6ee05622070a74075fc6a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 14:57:22 2009 +0100

    [sbuild::chroot_union] Use dynamic_pointer_cast for tr1::shared_ptr

commit ba990e921c49f58af78b1e8b24e4a4cc8f579dbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 14:56:57 2009 +0100

    [test] Use dynamic_pointer_cast for shared_ptr types

commit 5dbc1de5ac11424de219f696bdbe38ccf42083a3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 14:54:04 2009 +0100

    [test] Remove deprecated run-setup-scripts from tests
    
    Leave one instance of run-setup-scripts and run-exec-scripts
    in test/config-directory-deprecated.ex to test error messages.

commit 8d603e03603f9d6f8487c4e99db1be5e13d4ceec
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 14:34:25 2009 +0100

    [sbuild::chroot_union] Simplify conditional logic

commit eb2bdec96cf0c385e1e5569de9e9c3dd846e7a89
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Jul 4 13:38:06 2009 +0100

    [test] Add test for chroot_loopback

commit a1c80871a3ffd6abf778eaf522bb244a530010c9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 4 12:09:50 2009 +0100

    [debian] Close #494481

commit 0fff8813ace96ace204274bb93f66c409400d196
Author: Tim Abbott <tabbott@mit.edu>
Date:   Sat Jul 4 12:07:17 2009 +0100

    [setup] 05lvm: Reorder lvm snapshot options to make more flexible

commit caabd26a5a5632c0597eb609b5e31a60a95ab96e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [man] schroot.conf.5: Document block-device union support

commit 2d84eefa1b2f1ed5c0965003f3f99d77e7f4c2d5
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Tue Jun 30 23:32:58 2009 +0100

    [build] Add missing whitespace

commit f436c608b8468a6b232dfa188c4574b46fac10bc
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [TODO] Add enum |= and &= operators

commit 8599085e15aa917cd8f24330e41febcfe5d11488
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 23:28:10 2009 +0100

    [test] Update tests for filesystem unions

commit da59233d63c55379ea0eb4d20f6800e1949bc4e6
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 23:26:40 2009 +0100

    [sbuild::chroot_union] Don't set SESSION_CREATE unless union in use

commit 534c32992916cf3aa9ff931228c8c5860c030b1f
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 23:22:56 2009 +0100

    [sbuild::chroot_source] Move SESSION_PURGE into chroot_lvm_snapshot
    
    This was preventing making chroot_source more generally usable, due
    to not all source users being purgable.

commit 164ae1eb8ee40dd793c7e79947037a8b93dfca61
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_directory] Set SESSION_CREATE in all cases

commit 8fff76aa9c898bac2de00d46ada32f9e39da03b7
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_block_device] Add union filesystem support

commit bcda70b977fb2da33f28c5ce7037d6beca45d5bc
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_loopback] Chain up to chroot::setup_env

commit 11ddb69cceb282ee4c7949a4eec8ab76f3d53f93
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_loopback] Include config header for conditional building

commit 2b99f9317191f2cdf5c5d5b1cfcc5522067a3942
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_directory] Add missing newline

commit ef34bd49cef0a050d040e2480aad30cc8cff2e59
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot_loopback] Add union filesystem support

commit eef7c76b4d43cc00fd5fe21260eff3bf91a54b5d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 21:23:06 2009 +0100

    [sbuild::chroot_source] clone_source_setup is virtual
    
    Needed to allow correct functioning when inherited by chroot_union.

commit f1a3d63391de7af03f5bed4a03c8a522dc043a51
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 21:16:14 2009 +0100

    [sbuild::chroot_directory] Make chroot_union support configurable

commit a10882643f2ca00726eef6de2e0e78a50700d414
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 21:14:11 2009 +0100

    [sbuild::chroot_union] Add clone_source_setup
    
    Because source chroots by definition won't support unioning in order
    to allow access to the underlying filesystem, explicitly disable
    union support on cloning a source chroot.

commit 5dc9d3afd3b0e970763218df4e7f64817f542d89
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 30 08:03:00 2009 +0100

    [sbuild::chroot:block_device] Split into block_device_base
    
    In order to support union mounts on block devices, it can't
    conflict with the chroot_source support for lvm_snapshot.
    Therefore split into a base class, block_device_base, from
    which block_device and lvm_snapshot derive.  Each can then
    implement chroot_source and/or chroot_union independently.
    block_device now has an explicit protected copy constructor
    for lvm_snapshot in order to allow its use as a source
    chroot type.
    
    This will prevent lvm_snapshot from gaining chroot_union
    support due to being directly derived from chroot_block_device.

commit d8ba8499cfee76c256356acb61b744395ea7c2da
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 23:46:25 2009 +0100

    [TODO] Add union items

commit 47105b0d7d1df93de98dff1b5596fadc95dd43e1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 23:44:09 2009 +0100

    [sbuild::chroot_union] Synchronise with current master branch
    
    Replace CHROOT_UNION_RO_BRANCH with CHROOT_UNDERLAY_DIRECTORY.
    Updated tests.
    All chroots except plain run session scripts
    Split chroot from chroot_directory
    sbuild::session: Set chroot mount location for union chroots

commit 4796835c8ea60690633d99c8d6f147a60ad65d05
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 23:04:36 2009 +0100

    [sbuild::chroot_union] Rework union mounts
    
    Rename from fs_union to union.
    Make configuration options more user friendly.
    Update documentation to be more clear.

commit a35f53ab6d78748032ba16d3fb83ac0ab0009fb5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 21:54:54 2009 +0100

    [sbuild::chroot_fs_union] Add underlay directory in addition to overlay
    
    This allows for mounting of both the read-only underlying filesystem
    and read-write overlaying filesystem independently of the mountpoint
    of the resulting union.  These are currently union/overlay and
    union/underlay.

commit c1d1a2d00dbbe2cceba0110f3fee55788c12e8a1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 21:42:57 2009 +0100

    [sbuild::chroot_source] Don't inherit from chroot

commit de70b8fe75b7566ef10de4f09f561f7821a6f580
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 21:22:49 2009 +0100

    [sbuild::chroot_mountable] Don't derive from chroot
    
    chroot_mountable does not need any access to chroot methods or
    data, so don't derive from chroot.
    
    chroot::get_path is now pure virtual in order to permit this.

commit ea827d4f9fd9336e216f98a3855f19ebf2493d53
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 21:20:03 2009 +0100

    [sbuild::chroot_fs_union] get_path always returns the mount location
    
    Also remove trailing whitespace

commit 610e5fdad321c29fc42157db9392ba2d6c1bdbb6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 21:14:11 2009 +0100

    [sbuild] chroot_mountable: Refactor as partial interface
    
    chroot_mountable now contains virtual functions.  This cleans up
    ambiguity in getting the mount device.

commit 8e48373634910694a91d23b85859434b827145fc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 28 19:04:17 2009 +0100

    [setup] Simplify conditional to use cleaner syntax

commit d6e15f3c7b2100199194e722ea891d87e2ce781e
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sun Jun 28 18:47:15 2009 +0100

    [sbuild::chroot_directory] Add filesystem union support
    
    Change directory chroots to inheritate from chroot_fs_union
    instead of chroot and adapt setup scripts, documentation and
    tests.

commit 330fa7a5cdaf4229c8121594c7a78ca4dd18733b
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sun Jun 28 18:01:59 2009 +0100

    [sbuild::chroot_fs_union] New class to add filesysten union support
    
    Introduces a new type of chroot options.  This allows chroot
    sessions to be generated using an unioning filesystem like aufs
    or unionfs.  Per default this feature is disabled.  Check out
    schroot.conf.5 for further information.

commit 1477dddf327e8b23249179414fb66474331bde12
Merge: f72e33f e4ac2e7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 27 10:48:41 2009 +0100

    Merge branch 'master' of ssh://git.debian.org/git/buildd-tools/schroot

commit f72e33ff5b0bbdd53f192946e15622098c2e032f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 27 10:47:59 2009 +0100

    [sbuild::chroot_directory] Include correct header for parent class

commit e4ac2e7f3eda14360d7af3b5a0bcdb27a8b57faa
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Wed May 20 19:55:52 2009 +0200

    [sbuild::chroot_directory] Inherit from chroot_plain

commit 8a8ded0993e4a911c1a3f3ea6acf3022e1c60723
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Wed May 20 19:55:52 2009 +0200

    [sbuild::chroot_directory] Inherit from chroot_plain

commit a3bb05057c34d04d32e6c005630d962dbcbc8f2c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 14 21:26:16 2009 +0100

    [test] Update chroot_directory tests

commit 28ef09edfcbe92ef79a67725b1ec411ce3eb8613
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 14 20:15:27 2009 +0100

    [sbuild::chroot] Add session_id property
    
    Allow use of separate name and session_id chroot properties,
    and use get_keyfile_name to use the appropriate name for
    keyfile serialisation.

commit 8515d036a8da93ae20a65a3545a01f57542925b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 12 22:27:14 2009 +0100

    [TODO] Remove completed basic_keyfile string_list removal

commit e617b09810bfae0f1989a0a0aba2a3a9ecc6763a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 12 22:25:52 2009 +0100

    [sbuild::basic_keyfile] Replace last std::string usage with traits types

commit 42b83f0239f7309cabf7a4c5235b917b84527d2b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 01:19:01 2009 +0100

    [sbuild::chroot_directory] Remove erroneously added clone_source

commit b69ae48242d31463175359ac5252e1ca5ff59e34
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 01:18:39 2009 +0100

    [schroot::main_base] Use new PAM header names

commit 15ce0e8ba65f80b1d49f79a38a8708d50019aee4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 01:18:10 2009 +0100

    [sbuild::auth_pam] Add missing prototype

commit a217356bd76b527509af3accef53c304d3a57325
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 00:16:23 2009 +0100

    [sbuild::auth] Add split auth_null and auth_pam

commit 696512cd242ecd024051b3c15252605c735d2d59
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 00:15:58 2009 +0100

    [NEWS] Document major changes

commit fe21b3496fdabd57087c99eb08dc8e7adf91573f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 00:15:29 2009 +0100

    [debian] Remove old checks for obsolete versions

commit 43fdf62b42d6cd2dd73a71f940233b5e0c38339e
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 00:15:05 2009 +0100

    [build] Remove last traces of exec.d

commit 6ee128c08793b06a026a308b493018a8e54c80e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 11 00:14:02 2009 +0100

    [build] Remove duplicated checks for UUID support

commit 5ba4e8d5795ec2c6ffe1ee7e3ec6f79cd72ef72d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 18:19:35 2009 +0100

    [build] Make UUID support configurable

commit 590c8e82d879d2e90f33adc097a3c3e65e430a48
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 17:21:32 2009 +0100

    [po] Update English translation

commit d9d9a98a6e884e704c3f8615b31e1a3fc1b020e6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 17:22:23 2009 +0100

    [po] Add new source files

commit 8d26f733b79ce2cebd9683102b1649097015ea42
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 17:14:18 2009 +0100

    [debian] control: schroot-dbg is in section debug

commit 6657309ac7bf6e33460bc8379bc72153718f83f8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 15:52:36 2009 +0100

    [sbuild] Add pam prefix to all pam auth names

commit 255ddb53001c5c62a548fa48d852b68cc28f7874
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 15:36:34 2009 +0100

    [sbuild::auth] Split into auth_pam and auth_null
    
    PAM conversation handling classes are now all smart pointer-based
    only.  Construction of base objects is not allowed.
    
    sbuild::session defaults to using auth_null, so dchroot and dchroot-dsa
    can't authenticate.  schroot specifically adds auth_pam if available.

commit 7d2491c82040e318688926cd3976600225afab16
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 13:23:17 2009 +0100

    [sbuild] Make PAM support configurable
    
    On systems without PAM authentication, any attempt at authentication
    will fail.  If not switching users, the program will not require
    authentication and so will work for most common uses.

commit eef6520812d03e3532546a5b33a0373cf3aa4766
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 9 01:37:25 2009 +0100

    [build] Make UUID support configurable

commit d390d962e21a345aa428ab6ce31c00537d6bc2e0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 9 01:28:10 2009 +0100

    [build] Loopback chroot doesn't depend on block-device

commit f7f219cc081c6177ec11c3ffa2bb24921ef9fec5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 9 00:54:38 2009 +0100

    [build] Make personality support configurable
    
    Because personality support already has a fallback to "undefined" in
    case where we don't have personality(2) this does not need to be
    configured out of the build.  Create the necessary automake conditional
    for potential future use.

commit 74c2bd086cfa457fa3d6c558ff263ce11c33e7da
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 9 00:29:47 2009 +0100

    [build] Include correct lockdev headers for sbuild-lock

commit 91e94f3bee9a684816c10496d5912b321484f223
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 8 23:56:41 2009 +0100

    [build] Build loopback chroot support conditionally

commit 03ad30155ebcb513e8efa62b35ae1d8fcac1c754
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 8 23:23:33 2009 +0100

    [build] Conditionally compile block-device and lvm-snapshot support

commit 06eba6b16eac545b3913c91b462884e9e10e1560
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 10 17:32:11 2009 +0100

    [sbuild::chroot_plain] Split from chroot_directory
    
    Conflicts:
    
    	sbuild/sbuild-chroot-directory.cc
    	sbuild/sbuild-chroot-directory.h
    	sbuild/sbuild-chroot-plain.cc
    	sbuild/sbuild-chroot-plain.h

commit 039462e57e49289958be3fe091331d4768882ff3
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 5 09:44:40 2009 +0100

    [sbuild::chroot] All chroots except plain run session scripts
    
    Setting run-session-scripts in the configuration is deprecated.

commit af486d2b89d79eb1ea81181da6a6e1281561385b
Author: Nick Fortino <nfortino@gmail.com>
Date:   Mon May 4 11:13:32 2009 +0100

    [build] Use LIBS rather than LDFLAGS in library checks
    
    This allows for the correct ordering of options if the user uses
    the --as-needed linker option.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit f22bd68d37a6f34a318e7c2e727d4ab9895a1c55
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 4 00:52:21 2009 +0100

    [TODO] Add cleanup items for union and file chroots

commit a0d688ab579125d8b336bf696a11ce160882de0a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 4 00:48:52 2009 +0100

    [sbuild::chroot_file] Move CHROOT_FILE_UNPACK_DIR from session UNPACK_DIR

commit f734a54a242df8d88621412d38aa37f88394072f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 4 00:39:01 2009 +0100

    [schroot-mount] Act like mkdir -p rather than mkdir creating mountpoints
    
    This prevents failure when the path does not already exist.

commit 633a2a5d99950489207d22b8ed07a02bd89f33e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 18:20:17 2009 +0100

    [debian] Close #526788

commit 00d42ff02d5f060daebf768c6b316cc5e5a07f69
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 18:20:01 2009 +0100

    [etc] mount-defaults: Bind mount /dev/shm

commit 0447d20b5cefa5eb38fb97d507e5ca1bc81dc151
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 18:10:49 2009 +0100

    [setup.d] 20nssdatabases: Make executable

commit 811f16fc8f83314051cc1b29adaa981aa7a28c7f
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 8 19:31:48 2009 +0100

    [TODO] Add new items

commit 08b757d0969ee895ca799d46e4f32020fc269f45
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 1 21:32:09 2009 +0100

    [sbuild] chroot: Remove unused location member

commit 0b3fdec22c3bc761a242d3eb995ec89be06b5115
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 1 21:28:27 2009 +0100

    [sbuild] chroot_mountable: Move location property from chroot

commit 95d94bee472b4331b6d6a1d4993caa8a595726fc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 16:12:27 2009 +0100

    [sbuild::chroot] Remove prototypes and member for run_exec_scripts

commit 54c529d3bc4b6a922c0e62f36e960cfe66fc7adb
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 14:34:22 2009 +0100

    [sbuild] run_parts: Log script output
    
    Instead of leaving script stdout and stderr hooked up to our
    stdout and stderr, attach them to pipes and read output via
    poll and then log as info and error messages, respectively to
    stderr.
    
    This has the nice benefit of never writing to stdout when
    --verbose is used, which could interfere with user programs
    reading stdout.

commit f8b431d73a3621f4b0f07491f00557cc75744aaf
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 14:33:23 2009 +0100

    [setup.d] Remove W: message prefix
    
    To be added by run_parts and logged to stderr

commit 3edb93e2d274138841d54e7ff03407777bfb8be0
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 14:24:34 2009 +0100

    [schroot-mount] Don't log command being executed

commit 7e0ffa36c21de2844f1295bedede543d62097cdc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 17:33:56 2009 +0100

    [sbuild] Remove run_exec_scripts
    
    The run-exec-scripts configuration key is allowed, but deprecated
    and does nothing.
    
    Conflicts:
    
    	sbuild/sbuild-chroot-fs-union.cc

commit 891c8ca3cbf63792a14fc36205a05bb2d1635cd2
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 12:14:42 2009 +0100

    [sbuild] basic_keyfile: Allow NULL method pointers

commit ca1ce5e157e7c6ed0dcb3ee5c522f9240afec89d
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 12:14:07 2009 +0100

    [man] Document removal of run-exec-scripts
    
    Also update NEWS and sample configuration file.

commit fa68decb3102ae3dd5dfc1cd6b693a444529359d
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 11:28:42 2009 +0100

    [sbuild] sbuild-session: Remove support for exec scripts

commit 050881e10ed9bf6963e6387d3c5be1e7c57c00b2
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 11:15:25 2009 +0100

    [etc] Add .d suffix to exec and setup script directories

commit 4655ecb062c2589a4067744edf96a9c1020974a2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 17:12:02 2009 +0100

    [build] 05fsunion setup script not yet merged

commit b19ec203c8ca9829e02b2969b2a9653a33761072
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 11:15:49 2009 +0100

    [build] Remove manpages from bin/schroot/Makefile.am

commit 4f5a283fa8fdcadd88c652dad43c4da8fa616715
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 10 10:40:58 2009 +0100

    Rearrange configuration and manual pages
    
    Move all configuration data under etc.
    Move all manual pages under man.

commit ef5637528ca91463a194862c73f74877ae7377ab
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 9 22:30:52 2009 +0100

    [sbuild] sbuild-chroot-block-device: Update TODO item

commit 7a0e32283cd4552297781c79a6e418e849d30785
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 3 17:01:47 2009 +0100

    [sbuild] chroot_mountable: Add mount_device member
    
    Conflicts:
    
    	bin/schroot/schroot-setup.5.in
    	sbuild/sbuild-chroot-mountable.cc

commit 3be2107313b63498cf7e2794f3e00c5882b3f0e1
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 8 19:29:06 2009 +0100

    [debian] Build-Depend on boost 1.38

commit b977a280bb09132cd5ca8eb7ca678314aeeba56b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Apr 6 18:28:10 2009 +0100

    [setup] 15killprocs: Use /bin/kill to remove bashism

commit 76f03a838ce822e49dab9d76b3d5b4eb19cb01d9
Merge: 3835ffb 14951b1
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Mar 31 23:54:59 2009 +0100

    Merge branch 'fs-union'

commit 14951b1a19b5324b8d839620a9ecfcc43fec85f0
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Tue Mar 31 23:54:20 2009 +0100

    [sbuild] setup: Use CHROOT_DIRECTORY
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit a08e6687de4d1ab922684aeb9e967e7bf5fc8933
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Mar 31 23:53:48 2009 +0100

    [sbuild::chroot_directory] Add directory property to replace location

commit 6999055ea4275d6078c4432450f62d04ac3e3100
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Mar 31 23:52:18 2009 +0100

    [test] Add new chroot_directory tests for directory property

commit f56b95ff7623018f37b5f1fece4571258e4cb8bf
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Mar 31 23:51:34 2009 +0100

    [schroot] Document chroot_directory directory property

commit fb4c96f21bb7d833fde6668d7a66d680082590dd
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Tue Mar 31 23:50:56 2009 +0100

    [test] Add chroot_directory test data
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit b914a1d77a689ef6972c847c7418dd05b06b9027
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sun Mar 29 21:35:17 2009 +0100

    [sbuild] chroot: Drop mount_device member
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 0675ba2bbcbb09b72729cbe66f29b1b7be3e0ee5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 29 20:18:42 2009 +0100

    [debian] rules: Only mkdir debian/build if it doesn't already exist

commit 3835ffbf2843516b916c89ba6c302fbf4af5eb68
Merge: 43985d0 04c19bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 13:24:35 2009 +0000

    Merge branch 'fs-union'
    
    Conflicts:
    	debian/changelog

commit 43985d0e600f8e6f6b08f59e1b1cbe154a08706d
Merge: b9ff02b 52edb9a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 13:23:47 2009 +0000

    Merge branch 'master' of ssh+git://git.debian.org/git/buildd-tools/schroot

commit 04c19bb6c28295a387e60066c48db7f443e5b925
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 13:22:08 2009 +0000

    [sbuild-log] Rename DebugLevel to debug_level
    
    Also rename sbuild::debug_level to sbuild::debug_log_level to avoid
    a name clash.  DebugLevel was the last remaining CamelCase typedef
    from the original GObject-based C implementation.

commit 991360778a0be53da8db5911d3bd0753337e4ca2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 13:11:02 2009 +0000

    [sbuild-log] Unify reason logging as a single function

commit a8bd356dc8495aba321668bb027f134964207e98
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 12:43:11 2009 +0000

    [sbuild-error] Add third error detail parameter
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 7e5d11190ae06b0a3958a57ab0ee2f465dab668f
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 11:34:09 2009 +0000

    [build] Use $(mkinstalldirs) to create directories
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 7a37dc22435902adadd8a2c37e2088c53b465360
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 11:30:21 2009 +0000

    [build] Use autoreconf in place of separate autotools commands

commit a7b94bdbde689dd7066d03b6c747f8e14c4ad1aa
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 11:28:08 2009 +0000

    [build] Adapt boostrap from libtoolize suggestions
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit adcee512b95fe878f68bafe07279859f7b495dd0
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 11:21:17 2009 +0000

    [debian] rules: Use "$(MAKE) -C" in place of explicit "cd && make"
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 023ab59630176a2ccf12673a8248dd925838cc1e
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 11:15:11 2009 +0000

    [debian] rules: Run check before install when building packages
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit ff8f846bd10b4034ead9b38d221677ca4dbbf72c
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 11:00:48 2009 +0000

    [debian] libsbuild-doc: Fix build-deps and dependencies
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit e66ecd4ff2c6b1f5ea8e1634c877aeba8d46642f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 10:57:35 2009 +0000

    [debian] Document schroot-dbg addition

commit 4ccf072e554ffff0195b6ee6185798c687894a17
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 10:51:28 2009 +0000

    [debian] schroot-dbg: Add debug symbols package
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 30d35dc4d98932405a7c77c8be232c4c0ba42209
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 10:47:44 2009 +0000

    [.gitignore] debian: Simplify ignore rules
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 24c88103340af0eb0b06e37765ba17d17f408898
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 10:46:30 2009 +0000

    [debian] libsbuild-doc: Install docs from debian/build

commit 5d7b1dba1a6978b0f7136445d7cd856f1d75f971
Author: Jan-Marek Glogowski <glogow@fbihome.de>
Date:   Sat Mar 28 01:53:55 2009 +0000

    [build] Just link schroot-mount to boost filesystem lib
    
    Follow suggestion from dh_shlibdeps, as no other program uses
    symbols from libboost_filesystem.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit 609496cca9c1b12303540e2be70bb79222ec7b4e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 10:45:31 2009 +0000

    [build] doc: Don't require MAINTAINER_MODE to build docs

commit 30683f56faa1e96797d5499fc46dd23feafecf2b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 11:22:40 2009 +0000

    [.gitignore] csbuild: Ignore csbuild

commit b9ff02b56271f1371426cb4c830c60d629a7892f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 00:44:32 2009 +0000

    [debian] Build-depend on doxygen and configure with --enable-doxygen

commit 2ab01e7fcb4cb0d3c9b22a6a5acc2416abaaf053
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 00:43:47 2009 +0000

    [po] Update translations

commit af496ba3646c49174d00adfe0e72dd8040544c5e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 28 00:43:14 2009 +0000

    [NEWS] Bump version to 1.3.0

commit 8c789094a53175d14bab6c684bc55d2701c6d237
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 26 20:36:39 2009 +0000

    [build] Add configure option to generate doxygen docs
    
    By default, do not build documentation unless --enable-doxygen is used.
    
    Do not distribute doxygen documentation.

commit b8d7b309a4736b5fc2dddc3f6744cac757d36195
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 26 20:31:32 2009 +0000

    [test] Fix test to use correct write size
    
    Also add extra assertions to make sure all pre and post
    test conditions are satisfied.
    
    Remove unused fd member from device lock test.

commit 52edb9ac4559869f2101139b77d5465f944d9c60
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 22 17:00:01 2009 +0000

    [debian] Close #520713

commit 7822f2e229cad78de237d41dd941f7f959fe3c8c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 22 16:55:07 2009 +0000

    [build] Compile and link with POSIX thread support
    
    This is not needed on most platforms, but on Alpha
    appears to be necessary in order to have a working
    std::tr1::shared_ptr.  Without this, it fails due
    to a failed internal glibc assertion while locking
    with a pthread mutex during shared_ptr construction.

commit 1d9703d11909b162a44f48ec1131c2b7b548a5ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 22 16:54:36 2009 +0000

    [build] Add checks for POSIX thread support

commit 18e487fe539ba47caf53c80b969316d67fa92b9b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 16:46:45 2009 +0000

    [setup] 05file: Use UNPACK_DIR and mount unpacked files
    
    In order to unify mounting/unmounting and session cleanup,
    05file unpacks into SCHROOT_UNPACK_DIR, which is then bind
    mounted onto SCHROOT_MOUNT_DIR.  This means it uses the same
    logic as all other chroot types, making the code simpler and
    more robust.

commit 18fbe891e3ab5c3ef6a33d0a389729e875b0bb2c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 17:15:22 2009 +0000

    [build] Install SCHROOT_UNPACK_DIR

commit ea5b633f2d3a0665a0c626fbbe86b6f1b0aac426
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 16:43:51 2009 +0000

    [sbuild-session] Export SCHROOT_UNPACK_DIR for setup scripts

commit b1430b886e30ecffc8f522a8c76140575feb26e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 16:45:33 2009 +0000

    [build] Install SCHROOT_UNPACK_DIR

commit 855c8b0aa9bd227a44e07a978865faeecce7f6f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 16:44:29 2009 +0000

    [sbuild-session] Export SCHROOT_SESSION_ID in user environment

commit 1ffc97439790aa74197c49a0cf44535069e6f289
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 16:32:32 2009 +0000

    [debian] rules: Split configure invocation onto multiple lines

commit 94c3ec5616fc169d7addd1044fa57faef1198cdc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 15:59:34 2009 +0000

    [debian] Configure and install bash completion

commit 99acda8f0ac0616aa69e84f6e6ba91c24a13732b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 15:58:02 2009 +0000

    [build] Add bash completion to build

commit 4aa2969c6059d9a668928774b59fcd1a42868855
Author: Tim Abbott <tabbott@mit.edu>
Date:   Sat Mar 21 15:57:19 2009 +0000

    [schroot] Add bash completion
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit ff542ca2b6d0ac0d986f18d12e31ee060c6fd3b8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 12:27:36 2009 +0000

    [debian] Close #496629
    
    Also clean up some whitespace issues.

commit ffae7b13223c8c5775c012615418fece145a6906
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 21 12:17:40 2009 +0000

    [sbuild-session] Export additional auth variables into setup environment
    
    Add the following auth PAM properties:
    
    AUTH_RUSER
    AUTH_RGROUP
    AUTH_UID
    AUTH_GID
    AUTH_RUID
    AUTH_RGID
    AUTH_HOME
    AUTH_SHELL
    
    The main new property needed here is the passwd home directory,
    needed by the 50sbuild setup script to create a home directory
    inside the chroot.

commit e22d7c6169a313238e03c4a6719dbcbf40b2325a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 23:36:08 2009 +0000

    [debian] control: Update to Standards Version 3.8.1

commit d2e7b1a3b7f8a12d65c9c870264ec4e160ee7183
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 23:20:38 2009 +0000

    [debian] Use debhelper v7 compatibility mode

commit b78ded303bbf6cbdbcef71b76b034fac5e16bd1c
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 23:18:37 2009 +0000

    [debian] control: Remove duplicated word in description

commit 84263b8ed4849f301c58fed3f636dd7e50a2e5f5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 23:15:31 2009 +0000

    [.gitignore] Ignore log and substvars files

commit bb5a98a5b26ed437164ed51f83fb3d438f9b3794
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 22:51:33 2009 +0000

    [debian] Close #513307

commit 173123d157ff23943244933dcddba57ff64d57ef
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 22:44:20 2009 +0000

    [sbuild] sbuild-chroot-config: Use is_valid_filename on directory load
    
    Check that filenames are valid when loading a directory to avoid
    loading backup files and old dpkg configuration files.

commit 5c9d4b6a9c8b1e1a1f007079659056bae7ba5190
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 22:42:28 2009 +0000

    [sbuild] sbuild-util: Add is_valid_filename
    
    is_valid_filename is a new function to check that a filename
    is valid to open (i.e. is not a backup file, a dpkg configuration
    file backup etc.) using the run-parts(8) matching rules.  This
    has been moved from sbuild::run_parts::check_filename.

commit f523755ef62c43fb8bf3565dba2181af78296e8b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 22:40:59 2009 +0000

    [sbuild] sbuild-run-parts: Explicitly close syslog fd
    
    While this is unnecessary (it's already closed by the child process
    in sbuild-session), this ensures we close the syslog fd when used
    in other situations.

commit b43004e87d68b6fa4b055786ef4e9b9e2dd7b249
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 19 22:35:22 2009 +0000

    [schroot] setup: Copy NSS databases using getent
    
    20nssdatabases, nssdatabases-defaults: New script to copy the
    databases listed in nssdatabases-defaults into the chroot.
    Databases from /etc are no longer copied with 20copyfiles (with
    the exception of gshadow, which does not appear to have NSS support).
    As a result, the host NSS setup will result in functional file-based
    database support inside the chroot.
    
    Installations with very large database files may wish to use
    other NSS configuration inside the chroot in order to avoid
    performance issues duplicating the databases on chroot setup,
    but for most users this setup will be sufficiently flexible.

commit 29f489587e184f2fa01981d9cd0b807f88628d3c
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 21:21:11 2009 +0000

    [debian] Close #517041
    
    schroot-script-config.5, schroot-setup.5: Fix typos.
    Thanks to Loc Minier.
    
    Closes: #517041

commit 5fc01ce7bfbe12d12039033c5fe870c62d25a1ca
Author: Loc Minier <lool@dooz.org>
Date:   Mon Mar 9 21:19:02 2009 +0000

    [man] Fix typos in schroot-script-config.5.in and schroot-setup.5.in
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit b94dfa8dd46242425b0b4d5186124ec130c51e0d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 21:14:38 2009 +0000

    [sbuild] Remove support for GCC < 3.4 __gnu_cxx::stdio_filebuf
    
    Require a version of GCC >= 3.4 with current construction
    semantics.  Old compiler versions < 3.4 are no longer supported
    in Debian, and can hence not be supported by schroot.

commit a60ff806cec2f1bca79e7ee458e8209fbe4f71d9
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 21:02:49 2009 +0000

    [debian] control: Build-Depend on Boost 1.37

commit ddc24070583534c222464164b43dff42c9f9b5ad
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 21:01:40 2009 +0000

    [build] Build against Boost version 1.37

commit adc135cad2707796358b485ef1408eab0c8ca008
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 20:45:37 2009 +0000

    [dchroot] Session code uses get_auth to get authentication data
    
    Since sbuild::session no longer inherits sbuild::auth, the
    dchroot and dchroot-dsa session code must use session::get_auth()
    to get a pointer to the auth data.

commit ae3c57a0d3684980ca145274d532a04744cc4ca7
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 20:44:56 2009 +0000

    [debian] Close #517223
    
    sbuild-session.cc: Fix potential memory leak in is_group_member().
    
    Closes: #517223

commit 4d4ce2b9afff11dbdf1d4cac0380079567759682
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 20:43:37 2009 +0000

    [sbuild::session] Fix memory leak in is_group_member
    
    If getgroups failed, memory allocated with new[] would be leaked.
    delete[] the memory before throwing an exception on failure.

commit cc22e2e4d3fc69579bb039c9b2d5230a0c31cc01
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 20:07:05 2009 +0000

    [debian] Close #516272
    
    schroot.conf: Use current distribution names (lenny and squeeze
    in place of sarge and etch.
    
    Closes: #516272.

commit fc0a3aa68f6d99d43e733fab6cf70d6c22ead8dc
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 9 20:06:31 2009 +0000

    [schroot.conf] Update distribution names for Squeeze.

commit 3a2b1c62c24ce5178365e3dfdd6ce065ef145b5e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 11 22:30:37 2009 +0000

    [csbuild] Correct variable name in doxygen comment

commit a1d9e58974fa51415558ef6e901dba02073c5c75
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 11 22:07:40 2009 +0000

    [sbuild::session] Access authstat via this pointer

commit 066053e98322e8dc349d55b7c214f7ff627dab6c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 11 21:59:47 2009 +0000

    [sbuild::session] Don't inherit from sbuild::auth
    
    * sbuild::auth:
      - Move run to sbuild::session (uses auth, but does not need to be
        part of it, since it's application-specific).
      - authenticate is passed status rather than calling get_auth_status;
        this avoids using signals/slots or derived classes.
      - get_auth_status: Remove.
      - is_initialised: New function to check initialisation status.
      - change_auth: Make static since it doesn't use member data.
    * sbuild::session:
      - Don't inherit from sbuild::auth.
      - Add authstatus member (as a shared_ptr to auth), with corresponding
        get_auth and set_auth member functions.
      - All auth methods are called via the authstat object.
    * schroot/schroot-main-base.cc: Use get_auth to set parameters.
    * bin/schroot/schroot-main.cc: Use get_auth to set parameters.

commit d5626e43eb7aaf7f0c1c548960eebaa0273b890c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 11 21:51:15 2009 +0000

    [scripts] .gitignore: Ignore po-notify

commit dbd9238a64aa0edffba16a3e13b4ec1746073fd5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 11 21:50:43 2009 +0000

    [scripts] Remove generated script po-notify

commit 5e105fd0ee05c23c275a8b0baa232c7bb5b8a5aa
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 21 13:56:37 2008 +0100

    [sbuild::auth_conv_tty] Add weak reference to the auth object
    
    Weak references are used in place of shared pointers to avoid circular
    references.
    The conversation handler can now access the auth object which called it.
    This is used to implement a custom prompt containing the username, in
    the same style as sudo.

commit 950361746bf21e9b36cd8ff8bcf24c044cce544d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 5 11:42:21 2008 +0100

    [debian] Correct lintian warnings
    
    Upgrade to Standards-Version 3.8.0.
    Don't Build-Depend upon -1 Debian revisions.

commit bea1730b8aae731365a71cabf03097a5c91b33f7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 5 10:57:04 2008 +0100

    Finalise version 1.2.1

commit dac2540a0b66e18c50feab193df6ca1ac0bd7e21
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 23:26:20 2008 +0100

    [debian] Document loopback chroot type
    
    Closes: #475515

commit 4aee5a3bb0e5688dd58d3d4193f51c13991616e7
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 23:21:12 2008 +0100

    [sbuild] Add "loopback" chroot type
    
    Split generic parts of chroot_block_device into chroot_mountable.
    Add chroot_loopback, which derives from chroot_mountable.
    Document mountable and loopback options.
    Update setup scripts to use new chroot type and alter mount options for
    loopback mounting.

commit 5a98dd544940a8f5b6096ecff2e41c7000a79ece
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:40:31 2008 +0100

    [sbuild] Remove redundant include

commit d484a5d786b00a0abd0098e57557a2dfdbe52859
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:38:44 2008 +0100

    [setup] Don't clear mount options for LVM snapshots
    
    Closes: #488726

commit c8b715b9506eb5970ca1faff5a51a4823d961eda
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:33:49 2008 +0100

    [sbuild] Don't fail if block device doesn't exist on SETUP_STOP

commit 7b72e8597c6d03a3dd75259e44ae1b9ad488686a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:19:50 2008 +0100

    [sbuild] Don't fail if LVM snapshot device doesn't exist on SETUP_STOP

commit 518cf0c5aedc5fa39654b43b2c6e351fdba5f4a8
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:18:10 2008 +0100

    [schroot] Don't fail if the LVM snapshot device does not exist

commit 8eb45ddc531be981dc3ce73a4ad2f8ebc8e0cda0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 1 22:16:07 2008 +0100

    [schroot] Document /etc/schroot/chroot.d
    
    Closes: #487588

commit 2ab6a0b16f7526df8574db7b0792989047baa70e
Author: Petr Salinger <Petr.Salinger@seznam.cz>
Date:   Sun Jun 29 16:43:37 2008 +0100

    [sbuild] Order of "struct flock" members is not assumed.
    
    sbuild/sbuild-lock.cc: Initialise struct members separately, for
    GNU/kFreeBSD portability.
    
    Thanks to Petr Salinger.
    Closes: #485637.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit bfb29a15f7512ea6b410ef1a02ce6e3906d630d8
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 19 23:32:17 2008 +0100

    [scripts] Don't ignore po-notify

commit 2ad3f5968fa21e8e6b44be2de45c38420bd30432
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 19 23:31:23 2008 +0100

    [scripts] Add po-notify script for translation updates

commit 1b17af90d05f2ce988180890aebdf63d9a658d03
Author: Ji ZhengYu <zhengyuji@gmail.com>
Date:   Mon May 19 23:28:04 2008 +0100

    [po] Update zh_CN translation
    
    Thanks to Ji ZhengYu <zhengyuji@gmail.com>.
    
    Signed-off-by: Roger Leigh <rleigh@debian.org>

commit abca7ba654d8593eded47a40f0cc341f8509043c
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 19 23:24:11 2008 +0100

    [po] Update translations

commit 361e9ba9755d1eab538dad98721f4d39d90da793
Author: Nicolas Franois <nicolas.francois@centraliens.net>
Date:   Mon May 19 23:15:40 2008 +0100

    [po] Encoding is UTF-8, not ISO-8859-1

commit dd9d7467af77f6747953eda518677582afd00524
Author: Nicolas Franois <nicolas.francois@centraliens.net>
Date:   Sat May 17 22:00:32 2008 +0100

    [po] Update fr translation
    
    Closes: #481648.
    Thanks to Nicolas Franois.

commit 196f23d7bcf88f4636fec514b82aa4e95c1e9dc8
Author: Pedro Ribeiro <p.m42.ribeiro@gmail.com>
Date:   Sun May 11 12:05:48 2008 +0100

    [po] Update pt translation
    
    Thanks to Pedro Ribeiro <p.m42.ribeiro@gmail.com>.
    Closes: #480640.

commit bcc991c92ecc451ea4667a7d0099fd3aa56db57d
Author: LI Daobing () <lidaobing@gmail.com>
Date:   Thu May 8 20:57:13 2008 +0100

    [po] Add zh_CN translation
    
    Closes: #480174.
    Thanks to LI Daobing ().

commit 0d5a03d7161caf596bee796adf0299e476ed5dbb
Author: Clytie Siddall <clytie@riverland.net.au>
Date:   Tue May 6 15:00:55 2008 +0100

    [po] Update vi translation
    
    Closes: #479750.
    Thanks to Clytie Siddall.

commit 54cffcd50125726dc72fd789d843b8a19b464c48
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 5 10:36:04 2008 +0100

    Bump version to 1.2.1

commit 71e3106927027aa137c0f9555999ac53c0017fbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 5 00:10:46 2008 +0100

    [debian] libsbuild-doc.doc-base: Use section Programming/C++

commit e7e6ab3eb0c6d5a23dc543e19b8ab9aec0e80ebd
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 5 00:09:13 2008 +0100

    [debian] control: Bump Standards-Version to 3.7.3

commit f70560fbc163510f444f0b4b8e694ec1677c0e71
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 23:02:15 2008 +0100

    [po] Update translations

commit 01ea4bb698163dcedc027a0eee6be01ede0b61bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 22:56:42 2008 +0100

    Update copyright and author contributions

commit 0de909951040e67d97da0fd25f922c17345d80a1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 22:33:09 2008 +0100

    [debian] Close #469038

commit d1921fbd248c0fba83070883927bf9c365a647ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 22:31:55 2008 +0100

    [debian] Build-Depend on libboost-filesystem-dev

commit 4f19bab2e6dd4452c2a0a7dce90bae45e0a48361
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 22:30:09 2008 +0100

    [build] Use MKDIR_P in place of MKINSTALLDIRS

commit c932f7b5ed266778bacbb607ea026b5316ee623f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 22:28:09 2008 +0100

    [man] NAME section uses ASCII hyphen, not em dash

commit 88cc44832923957a060e2564616321ef04260662
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 16:19:44 2008 +0100

    [debian] changelog: Close bugs for 1.2.0

commit b7ecfdd27db664a7a6714961f87120fe5bb03cb8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 16:19:16 2008 +0100

    [dchroot] dchroot.1.in: Remove short option for --preserve-environment
    
    Nonexistent short option removed.
    Thanks to Yann Dirson <ydirson@altern.org>.

commit ffbcc9d7822bb6bd0d55f86e31a25ea79a003570
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 16:17:48 2008 +0100

    [NEWS] Document changes for 1.2.0

commit 4126778ca072ef18c61a7f63b585ded5a8f80ed5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 4 16:16:39 2008 +0100

    [schroot-mount] schroot-mount-main: Create mountpoint if needed.
    
    Thanks to Kees Cook <kees@outflux.net> for this patch.

commit 0e42d9f93fb1d72bad3970298c65b9e9f5b4bae9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 27 22:25:24 2008 +0100

    [schroot] Remove setup/50sbuild
    
    50sbuild is now distributed with sbuild.

commit a94afca63c5987ec483cfca234459d8e08d54d49
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 27 22:24:19 2008 +0100

    [debian] Add GIT repository information to control file.

commit 49e2502b9bc4515edfb0fa26b38e35176a60a0c8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 27 22:23:53 2008 +0100

    [schroot] Read additional configuration from /etc/schroot/chroot.d.

commit c3929350bf00320470c3d63b08a9450960fce90b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 20 23:50:02 2008 +0100

    [sbuild] Add missing static_cast to stat::check_mode
    
    This fixes an FTBFS on GNU/kFreeBSD.  Thanks to Petr Salinger.

commit 71fa0d3ca29194eaf6dbe9e9e29df3beb9a0c57e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 20 23:31:16 2008 +0100

    [sbuild] chroot_config no longer uses O_NOFOLLOW
    
    O_NOFOLLOW does not give increased security and makes the package
    less usable.

commit 8c037c4a2b577ed83d944883a19457881073a063
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 20 23:21:30 2008 +0100

    [po] Add pt translation.
    
    Thanks to Miguel Figueiredo.

commit e5a65d7c848891c1554f0bb29f87cf15059f41d2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 20 22:59:39 2008 +0100

    [test] Add parentheses around ambiguous statements

commit d9da6266a246d07cb77386abb7d5c2475d815ebc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 20 22:58:52 2008 +0100

    Only generate ChangeLog if using git

commit c1eafb4f48a2985cf0e7c14554f53b1645745ad1
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 26 23:17:57 2008 +0000

    Update translated strings and translator comments.
    
    Remove technical jargon from user error messages, and add more
    descriptive translator comments.
    Update translations.

commit de37f5c376169b33d4ef259e9c535601ef01395b
Merge: 64846d7 326fb8e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 26 11:05:50 2008 +0000

    Merge branch 'master' of git+ssh://git.debian.org/git/buildd-tools/schroot

commit 326fb8e9178309a3551bcfabc1c939f62c7d9a9a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 25 22:43:36 2008 +0000

    [sbuild] Include missing <cstring>, needed by GCC 4.3.
    
    Thanks to Daniel Schepler.

commit 64846d7c686620887cd865c888cdf97428fe841d
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 21 00:01:37 2008 +0000

    [po] Update de translation.
    
    * po/de.po: Update de translation.  Thanks to Jens Seidel.

commit dda8ba15e153b411eb6b88834c714ea051cf9dd3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 27 22:15:19 2008 +0000

    Ignore ChangeLog.

commit 8077d68e03ff6bed7cc50970507e6c4e69a9db6b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 27 22:14:13 2008 +0000

    Generate ChangeLog automatically.
    
    * Makefile.am: Use "git log" to generate the ChangeLog at "make dist" time.
    * bootstrap: Create empty ChangeLog, to fix automake error.

commit 7fabc6cd312d9f4776d75b8df685d28f5f17a051
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 27 17:59:20 2008 +0000

    * bin/schroot/setup/*, bin/schroot/exec/*: All scripts check if
      $CHROOT_SCRIPT_CONFIG exists, and exit with an error if not (but
      only if status=ok, in order that the setup-stop task succeeds on
      failure).  Scripts using values from the $CHROOT_SCRIPT_CONFIG
      check that they are defined and valid before using them, and exit
      with an error if they are invalid.

commit d5ff3b6f2f9907f6d57fce77452c2b97157562b7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 26 19:01:52 2008 +0000

    * TODO: Add logging items.

commit 87e8c1911903791ebee7f5587cc7c8a2a535816e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 24 22:40:09 2008 +0000

    * debian/control: libsbuild-dev is in section libdevel.

commit 8db5396f9e3d484bf33320c5c521d6b7ef02d4d2
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 23 22:40:02 2008 +0000

    * configure.ac: Increase minimum gettext version to 0.16.

commit 663e96efe68acae26b57bebe4dcfe36d00b6c36a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 22 23:17:13 2008 +0000

    Add eu translation.

commit f913fcf205585d10c6b367d3965d02671fa7db21
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 21 00:56:06 2008 +0000

    * configure.ac: Change version to 1.3.0.
    * debian/changelog: Change version to 1.3.0.

commit 24525c6980c3a836061c341cbdc09e634a4da518
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 21 00:40:57 2008 +0000

    * Update translations.
    * Fix up gitignore for dchroot.

commit 888efb08de9bbd16d4513ebb5274ce8a75d5b76d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 21 00:13:00 2008 +0000

    * po/en.po: Update copyright year.

commit dfad96e25a27d124029047b077173605046eb025
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 21 00:10:43 2008 +0000

    * Update copyright on all files modified in 2008.

commit 5fdb47b373cb2f16e06fb2dcd60e91e46e15ce0a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 23:38:00 2008 +0000

    * configure.ac: Add back enableval defaults after option checks.

commit 4ef373af89c25ef9d48529b63cea01299b30fd82
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 23:08:04 2008 +0000

    * Version 1.1.6.

commit e84261685645bc9e4b1e383b277e0387b71c4e7e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 22:48:57 2008 +0000

    * test/sbuild-dirstream.cc (class test_dirstream): Remove
      special-case for building in SVN repository.

commit d9edc6c920480db26955ba7862b13f0752523d62
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 22:41:30 2008 +0000

    * po: Update translations.

commit b4a0327d02532a3d9f6adfcc6fe42b9ea110afde
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 22:41:04 2008 +0000

    * TODO: Remove completed item.

commit b28de816b84cc41a4b11143ad2a3c4a8424370c3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 22:37:39 2008 +0000

    * test/sbuild-chroot-directory.cc: Enable test_setup_env2 test.

commit c63a705d3b890a30ad6003573f25f04620b6b590
Merge: 2942f2b 5c75577
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 21:56:58 2008 +0000

    Merge branch 'master' of ssh://git.debian.org/git/buildd-tools/schroot
    
    Conflicts:
    
    	ChangeLog

commit 2942f2ba225e705916e6633e9f57c0ebe001cb89
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 21:52:54 2008 +0000

    * test/testmain.cc: Include config.h.

commit d3e0f60c710fadd1445ffeb25a422619f7b23590
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 21:51:24 2008 +0000

    * configure.ac: Remove hard-coded enableval defaults.  These
      appear to break with current autoconf.

commit 5c755771500b345d92268600980cc5a6450e7700
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 21:44:00 2008 +0000

    * test/sbuild-chroot-directory.cc: Ensure mount_location and
      CHROOT_MOUNT_LOCATION are set correctly.

commit cd170da606a7f7d2e475fa6591992b1c6c9495b4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 18:26:48 2008 +0000

    * test/sbuild-chroot-directory.cc: New file.  Tests for
      chroot_directory.  Note: one test is broken; probably a testsuite
      issue--it works fine in practice.

commit 03da156392ff298911661656db1f81ffae84dbcc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 17:37:09 2008 +0000

    * sbuild/sbuild-environment.cc
      (environment::add): Log debugging message on insert.

commit c3f0943cca53c7219ec04797949c8d4f6a01ed39
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 17:32:02 2008 +0000

    * debian/schroot.preinst: Use dpkg-old rather than dpkg-bak in echoed message.

commit ab9c25aa2f33b640674c751eb817eb6839ee1237
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 17:31:07 2008 +0000

    * bin/schroot-mount/schroot-mount-main.cc: Mount messages go to
      log_debug() rather than std::cout (which breaks session name
      output to stdout).

commit 3452d225d3f60c6350fb705fd948bb09fb8dba47
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:33:36 2008 +0000

    * bin/schroot/setup/05file: Use "true" rather than 1 in session
      flag tests, now correctly output as bool, not int.

commit b5ba5795735094496ea0da877c44e9eb392335f9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:31:11 2008 +0000

    * Update translations.

commit a12b6456472de9ea12b91a37f2a93f760ce03027
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:30:40 2008 +0000

    * TODO: Add extra chroot checks.

commit 9968fccfd338676b861b1c11ee399f47ba828387
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:30:04 2008 +0000

    * sbuild/sbuild-chroot.cc
      (chroot::setup_env): Cast session flag masks to bool.

commit 177037a21bdb18be35733926a878f464e0759e08
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:28:41 2008 +0000

    * test/test-sbuild-chroot.h: Print environment variable names on
      error.
    * test/sbuild-chroot*.cc: Update environment and session flags
      checks.

commit 5c61e3ddfa305ce93d0463c42c1b1bcd04c59264
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 20 02:26:10 2008 +0000

    * Fix typo.

commit df8dd389adfcff9ab6f0e37310b4b4616ead372a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 18:22:43 2008 +0000

    * debian/schroot.NEWS: Document conffile changes.
    * debian/schroot.preinst: Call rm_conffile, not rm_prep_conffile.

commit 9cf698ef0bd5c7c117d0fea6ff60eb57823d88db
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 18:20:48 2008 +0000

    * bin/schroot/setup/20copyfiles
      (copy_file): Add checks that source and destination both exist.
    * bin/schroot/Makefile.am
      (pkgsysconf_DATA): Add copyfiles-defaults.

commit 24280efd624d3a97c8cfa9dfb4190b3c9f9d31ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 16:37:16 2008 +0000

    * debian/schroot.preinst: Use .dpkg-old rather than .dpkg-bak, to work with run-parts.

commit d418fae39f2df178065af29ade8f46c6ce57d9aa
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 16:36:29 2008 +0000

    * NEWS: Update for 1.1.6.

commit 963a03a8448592838c1391b9f5485e43420a6cff
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 15:50:07 2008 +0000

    * bin/schroot/schroot-setup.5.in: Replace 20network and 30passwd
      with 20copyfiles.
    * bin/schroot/setup/Makefile.am
      (setup_SCRIPTS): Remove 20network and 30passwd, and add
      20copyfiles.
    * bin/schroot/setup/30passwd: Remove.
    * bin/schroot/setup/20copyfiles: Move from 20network.  Read
      COPYFILES file, and copy files into chroot.
    * bin/schroot/script-defaults: Add COPYFILES.
    * bin/schroot/copyfiles-defaults: New file.  Files to copy into
      the chroot.
    * debian/schroot.preinst: Add rm_conffile function to remove
      /etc/schroot/setup.d/20network and /etc/schroot/setup.d/30passwd for
      versions prior to this.  These are replaced by
      /etc/schroot/setup.d/20copyfiles.

commit bfb69ec483ef51a3295998a76476a7ed24bc1593
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 11:52:05 2008 +0000

    * bin/schroot-listmounts/schroot-listmounts-main.cc
      (main::action_listmounts): Output mounts in reverse mount order, i.e.
      order for unmounting.

commit 0a5f0be819654656b5a97ae7d85702d70b2313e5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 11:41:48 2008 +0000

    * Update Vietnamese translation (Closes: #461531).  Thanks to Clytie
      Siddall.

commit 8168cb62e1ef650ce229dc002a0932fe4493cc29
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 19 11:15:50 2008 +0000

    * po/vi.po: Update Vietnamese translation.  Thanks to Clytie
      Siddall.

commit b4d52ee2884877010237255d216158fb5ab2dafc
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 18 17:45:57 2008 +0000

    * configure.ac: Generate scripts/po-notify.
    * scripts/po-notify.in: New script to notify translators.

commit cb035fbc8e7db4813193d5cd97be6648bca64d90
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 18 00:33:58 2008 +0000

    * TODO: Add script merge item.

commit 139538c750329df1f130f89db79ba0b72286c760
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 18 00:33:43 2008 +0000

    * bin/schroot/setup/05file: Only purge if CHROOT_SESSION_PURGE is
      set, as an additional extra safety measure.

commit 5c8ddf0265498a8ac0e5943d97ae3b79a44d7593
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 18 00:24:04 2008 +0000

    * bin/schroot/setup/05file: Only purge if CHROOT_SESSION_PURGE is
      set, as an additional extra safety measure.

commit 6024fbc3b79d9ec85146d169cfffc71172ea706c
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 17 23:53:37 2008 +0000

    * Update translations.

commit cf1cd826a46e858b162e35f97140c176ad6f2ffe
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 17 23:52:06 2008 +0000

    * TODO: Remove completed item.
    * bin/schroot-mount/schroot-mount-main.cc: Ensure fstab fs_dir has
      a leading /.

commit afaca434329275eaef1634ee38e1297b70c1d995
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 17 23:50:03 2008 +0000

    * sbuild/sbuild-chroot.h: Add missing comma.

commit c548e6831adb07d28ca501bfc016a2a8c9137bd9
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 17 22:23:54 2008 +0000

    * bin/schroot/schroot-setup.5.in: Document SCHROOT_SESSION_CREATE,
      SCHROOT_SESSION_CLONE, and SCHROOT_SESSION_PURGE,
    * bin/schroot/setup/00check, bin/schroot/exec/00check: Print
      SCHROOT_SESSION_CREATE, SCHROOT_SESSION_CLONE,
      SCHROOT_SESSION_PURGE, FSTAB and SBUILD values.
    * sbuild/sbuild-chroot-block-device.cc,
      sbuild-chroot-directory.cc: Use SESSION_NOFLAGS.
    * sbuild/sbuild-chroot-source.cc:
      (chroot_source::chroot_source): Explicitly initialise all member.
      (chroot_source::clone_source_setup): Set is_source when cloning a
      source chroot.
      (chroot_source::get_session_flags): Set session flags
      appropriately for source chroots, active cloned chroots and
      inactive non-cloned chroots.
      (chroot_source::get_details): Only list extra source chroot
      configuration options for non-source chroots.
      (chroot_source::get_keyfile): Only get for non-source chroots.
      (chroot_source::set_keyfile): Only set for non-source chroots.
    * sbuild/sbuild-chroot-source.h: Add is_source member.
    * sbuild/sbuild-chroot.cc
      (chroot::setup_env): Add SCHROOT_SESSION_CREATE,
      SCHROOT_SESSION_CLONE, and SCHROOT_SESSION_PURGE to the
      environment.
      (chroot::get_details): Display SCHROOT_SESSION_CREATE,
      SCHROOT_SESSION_CLONE, and SCHROOT_SESSION_PURGE.
    * sbuild/sbuild-chroot.h: Add SESSION_NOFLAGS and SESSION_PURGE to
      session_flags.

commit d3885ddd13df1e987d7328d47c54a316620a6b42
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 16 00:24:14 2008 +0000

    * TODO: Remove mntstream porting; add mount checking.

commit 06004c56a6db3baf8ec3577527adc0dff144ee59
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 16 00:23:44 2008 +0000

    * NEWS: Update.

commit e3d0fc5100a1565404b5b0ff9080b484d9af86d0
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 16 00:23:08 2008 +0000

    * bin/schroot/script-defaults: Reorder variables.
    * bin/schroot/schroot.1.in, bin/schroot/schroot.conf.5.in,
      bin/schroot/schroot-setup.5.in: Update copyright, hyphenation and
      references.
    * doc/Makefile.am (PS_DEPS): Add schroot-script-config.5.
    * bin/schroot/Makefile.am (man_MANS): Add schroot-script-config.5.
    * configure.ac: Add bin/schroot/schroot-script-config.5
    * bin/schroot/schroot-script-config.5.in: New manual page to
      document file format of script-config option.

commit d24baa096c8e9244c88c587423539648460dcc70
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 16 00:22:48 2008 +0000

    * bin/schroot/script-defaults: Reorder variables.
    * bin/schroot/schroot.1.in, bin/schroot/schroot.conf.5.in,
      bin/schroot/schroot-setup.5.in: Update copyright, hyphenation and
      references.
    * doc/Makefile.am (PS_DEPS): Add schroot-script-config.5.
    * bin/schroot/Makefile.am (man_MANS): Add schroot-script-config.5.
    * configure.ac: Add bin/schroot/schroot-script-config.5
    * bin/schroot/schroot-script-config.5.in: New manual page to
      document file format of script-config option.

commit 4542151681d306b9c23b3eb2c50348193d71dbc1
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 15 23:23:55 2008 +0000

    * bin/schroot-listmounts/schroot-listmounts-main.cc
      (main::action_listmounts): Use sbuild::mntstream.
    * bin/schroot-listmounts/schroot-listmounts-main.h: Remove OPEN
      and CLOSE error codes.  Remove list_mounts helper function.

commit 9525c8be793640ae13949ff180078b942daa60ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 15 23:04:48 2008 +0000

    * debian/changelog:
      - If unknown keys are present in the configuration file, print a warning
        message to alert the user (Closes: #459658).
      - The filesystems to mount in the chroot may be customised by the system
        administrator through the use of an fstab file on a per-chroot basis,
        and a new helper utility, schroot-mount (Closes: #395062, #427047).
        Thanks for your patience while we took the time to implement this the
        right way.

commit 98c37439b65dc5bd5b9e0c4c8c6e245fc130e484
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 15 22:52:15 2008 +0000

    * Update translations.

commit 879afebea0c897d3746ced19a7007c038fbbee90
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 15 22:51:45 2008 +0000

    * All classes derived from sbuild::chroot updated to use new
      set_keyfile argument.
    * sbuild/sbuild-chroot.cc
      (set_keyfile): sets used_keys for each key used.
    * sbuild/sbuild-chroot.h
      (operator >>): Get list of used keys, and pass to
      keyfile::check_keys to find unused keys.
      (set_keyfile): Add used_keys parameter.
    * sbuild/sbuild-basic-keyfile.tcc
      (check_keys): Use set_difference to compare used and available
      keys, and print warnings about the differences.
    * sbuild/sbuild-basic-keyfile.h: Make user-visible types public.
      Add check_keys method to warn about unused keys.
    * sbuild/sbuild-keyfile-base.(cc|h): Add UNKNOWN_KEY error code
      and string.
    * sbuild/sbuild-types.h: Add string_set typedef.

commit cc287d69e3a12f4092430bbd85e2a439d7e2ad1c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 15 22:35:02 2008 +0000

    * TODO: Document string_list issue in basic-keyfile.

commit b91c7c723e885e5e5a85566d1ea7278bb3ab79d8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 13 23:46:08 2008 +0000

    * bin/schroot/setup/20network, bin/schroot/setup/30passwd: For files to
      copy, compare file device, inode and contents to avoid copying
      identical files (Closes: #428808).

commit 47cb697f744270a9ad681132a2a10b0843a2f54f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 13 23:45:42 2008 +0000

    * bin/schroot/exec/*: Use set -e to ensure abort on failure.
    * bin/schroot/setup/*: Use set -e to ensure abort on failure.
    * bin/schroot/setup/20network, bin/schroot/30passwd: Add copy_file
      shell function to copy files only if device or inode differ and
      contents differ.  This prevents cp failing if source and
      destination are the same inode on the same device.

commit e011a324dde329d770f418b8988e728e1ea0f78d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 16:21:05 2008 +0000

    * debian/control: Suggest lvm2 instead of lvm-common (Closes: #452263).

commit 4773f2817879f54352275ffad40b7749419886bc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 15:47:01 2008 +0000

    * .gitignore: Ignore generated files.

commit fece9b15513ca8b4da1eb09ee8bb7ee3c3eb756a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 15:46:06 2008 +0000

    * po: Update potfiles.

commit deb20feb8e8449ffbca423a4402d2044f83b1a2d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 15:45:34 2008 +0000

    * TODO: Add script item.

commit 964579ccfd5a58744d10a721808179dc1e80df07
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 15:45:02 2008 +0000

    * bin/schroot/script-defaults: Add FSTAB variable.
    * bin/schroot/setup/10mount: Use schroot-mount and mount-defaults
      in place of hardcoded mounts.

commit 3414a0173aedb4264194d073a307a455f788107f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 12:25:24 2008 +0000

    * bin/schroot/Makefile.am: Install and distribute mount-defaults.

commit eb776490d8b1f828a0444a760e79fa45f5c46d35
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 12 12:20:41 2008 +0000

    * bin/schroot/mount-defaults: Renamed from
      bin/schroot/mount.defaults.

commit b2a3de936b1c29b7b9280a7cd393022c3814681c
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 9 23:34:59 2008 +0000

    * bin/schroot/mount.defaults: New file.  Defaults for
      schroot-mount.  To be used in 10mounts and script-defaults.

commit ff92dcd5b726f8d7bed51d835be3841d01b01c86
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 9 23:33:21 2008 +0000

    * TODO: Add new items.

commit 8945a6a46b6a4efc737c455c446e4287854ae500
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 9 23:32:49 2008 +0000

    * bin/schroot-mount/schroot-mount-main.cc: Remove FIND, OPEN and
      CLOSE error code descriptions.  Replace with CHILD_FORK,
      CHILD_WAIT and EXEC descriptions.
      (main::main): Update program description.
      (main::action_mount): Use mntstream to parse fstab.  For each
      mount entry, prefix mountpoint to directory, and fork and exec
      /bin/mount to mount the filesystem.  Pass -v to mount if --verbose
      was specified.
      (main::run_child): New function, copied from
      sbuild/sbuild-run-parts.cc with minor modifications.
      (main::wait_for_child): New function, copied verbatim from
      sbuild/sbuild-run-parts.cc.
    * bin/schroot-mount/schroot-mount-main.h: Remove FIND, OPEN and
      CLOSE error code.  Replace with CHILD_FORK, CHILD_WAIT and EXEC.
    * bin/schroot-mount/schroot-mount-options.cc
      (options::options): Initialise dry_run and fstab.
      (options::add_options): Add --dry-run and --fstab options.
      (options::check_options): Set dry_run and normalise mountpoint
      path.
    * bin/schroot-mount/schroot-mount-options.h: Add dry_run and fstab
      member variables.

commit 4322a8f5b3b17e0c42af1f1306e16bb7cac4a31e
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 9 23:23:45 2008 +0000

    * po/POTFILES.in: Add sbuild/sbuild-mntstream.(cc|h).
    * sbuild/Makefile.am
      (sbuild_public_h_sources): Add sbuild-mntstream.h
      (sbuild_public_cc_sources): Add sbuild-mntstream.cc
    * sbuild/sbuild-mntstream.(cc|h): "Mount stream" interface to SUS
      mntent functions.

commit 7d496fcab9335d99863f5192ca99358805a9810c
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 9 23:23:03 2008 +0000

    * po/POTFILES.in: Add sbuild/sbuild-mntstream.(cc|h).
    * sbuild/Makefile.am
      (sbuild_public_h_sources): Add sbuild-mntstream.h
      (sbuild_public_cc_sources): Add sbuild-mntstream.cc
    * sbuild/sbuild-mntstream.(cc|h): "Mount stream" interface to SUS
      mntent functions.

commit d35b99a13ce4cf59e6a98569a52aad59e3a176f5
Merge: b392abd 937335a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 8 00:33:01 2008 +0000

    Merge branch 'master' of git+ssh://git.debian.org/git/buildd-tools/schroot
    
    Conflicts:
    
    	ChangeLog

commit b392abde652a13e379f77822ace47e61315bd31b
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 8 00:31:17 2008 +0000

    * bin/schroot/setup/20network: Copy /etc/hosts into chroot.

commit 950c4ac0ce3f630aae9215c7cdddd580fab3244a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 8 00:30:27 2008 +0000

    * doc/.gitignore: Ignore *.pdf and *.ps.

commit 736f6bb57af60320e656113ea593886336619435
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 8 00:29:34 2008 +0000

    * po/POTFILES.in: Add bin/schroot-mount sources.
    * configure.ac: Output bin/schroot-mount/Makefile
    * bin/Makefile.am (SUBDIRS): Add schroot-mount.
    * bin/schroot-mount: Copy schroot-listmounts and search and
      replace listmounts with mount.  This is the starting mount for the
      schroot-mount utility to parse fstab(5) format files for mounting
      filessystems inside chroots.

commit d30d7b89ea6fd5615783609d077ecabbbe6325b0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 8 00:25:43 2008 +0000

    * sbuild/sbuild-chroot-lvm-snapshot.cc
      (chroot_lvm_snapshot::get_session_flags): Add chroot-source flags.
    * sbuild/sbuild-chroot-file.cc
      (chroot_file::get_session_flags): Add chroot-source flags.
    * sbuild/sbuild-chroot-source.cc
      (chroot_source::get_session_flags): Set SESSION_CLONE.
    * sbuild/sbuild-chroot-source.h: Add get_session_flags virtual
      function.  Fix typos in comments.
    * sbuild/sbuild-chroot.h (sbuild): Add SESSION_CLONE session
      flag.  Add operator | and & operators for session_flags.  Fix
      typos in comments.

commit 937335a465dc0e036f023aab4292279e6da680b8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 22 13:26:09 2007 +0000

    * bin/schroot/setup/20network: Copy /etc/hosts into the chroot in
      addition to /etc/resolv.conf.  Done for compatibility with sbuild
      buildd.chroot chroot setup.

commit 1f6693bd494f4375083b980ffb7ebfbfc0217d38
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 30 22:14:03 2007 +0100

    * Update .gitignore for Debian builds.

commit 072c484e0fde52f29d8b45b769fb1d6e99b24353
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 30 22:13:39 2007 +0100

    * Update .gitignore for Debian builds.

commit 008d2435a9dadb10e8dd15082d8f2baa7236b875
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 30 21:59:22 2007 +0100

    * test/sbuild-chroot-config.cc
      (class test_config): Use sbuild::error_base in place of
      sbuild::chroot_config::error, because stat errors throw a
      less-specific exception type.
    * sbuild/sbuild-chroot-config.(cc|h)
      (chroot_config::add, chroot_config::add_config_directory,
      chroot_config::load_data): Use new stat class.
      Remove unused FILE_STAT error code.
    * sbuild/sbuild-session.cc
      (session::get_shell): Use new stat class.
    * sbuild/sbuild-chroot.(cc|h): Remove unused DEVICE_STAT and
      FILE_STAT error codes.
    * sbuild/sbuild-chroot-lvm-snapshot.cc
      (chroot_lvm_snapshot::setup_lock): Use new stat class.
    * sbuild/sbuild-chroot-file.cc
      (chroot_file::setup_lock): Use new stat class.
    * sbuild/sbuild-chroot-block-device.cc
      (chroot_block_device::setup_lock): Use new stat class.
    * sbuild/sbuild-util.cc (sbuild::basename): Use new stat class.
    * sbuild/sbuild-util.(cc|h): Add new stat class, to wrap stat(2).

commit d02a21e3d2442497ccdbc7bdded858e7b9bd6918
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 30 21:45:13 2007 +0100

    * test/run-parts.ex2/.gitignore: Add to force directory creation.
    * sbuild/sbuild-auth.cc: Fix typo in documentation.

commit 6250206fcea9077922dc5123382b1396b2a71ffb
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 27 23:07:51 2007 +0100

    * NEWS: Update for GPLv3 change.

commit 8a0d0df1ef9938ab018eee93c70ec3331d66a764
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Sep 26 21:10:44 2007 +0100

    * Add .gitignore files.

commit 7793072a017e140f4e8f9c25b15813c9a1c57791
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 16 01:42:56 2007 +0100

    Convert the entire project to GPLv3
    
    * The entire schroot project is now licensed under the GNU General
      Public Licence, version 3 or later.
    * COPYING: Update to GPLv3.
    * Update licence boilerplate on all files to GPLv3.

commit 9f6a5613b5363e50fc98336c651bc80d75d3cc8a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 15 23:55:18 2007 +0100

    debian/copyright: Update with new git repository location

commit 9ae54d024fa5262103eb657a0755fc5a1a1c4457
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Sep 7 00:01:53 2007 +0000

    * debian/changelog: Bump version to 1.1.6.
    * NEWS: Bump version to 1.1.6.
    * configure.ac: Bump version to 1.1.6.

commit 43774a81c5ea3e1c1155136ff5f546f8b20ae8ee
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 6 23:53:00 2007 +0000

    * debian/changelog: Changelog for NMU.
    * configure.ac: Use the new Boost library names.

commit 9b48f6316f62ec81d8d5d10724bea0c5adf0c439
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 20:01:51 2007 +0000

    * Version 1.1.5
    * debian/changelog: Finalise for 1.1.5.
    * bin/schroot/schroot.1.in: Add missing ^ to Environment Filter in
      examples.

commit 75f2fb06fdda2a2f961ace6c121676afc7d66b7b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 19:51:25 2007 +0000

    * Version 1.1.5
    * debian/changelog: Finalise for 1.1.5.

commit ee227e127d5b8e249210373bfe066f6957780504
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 18:35:43 2007 +0000

    * debian/control: Use ${binary:Version}.
    * debian/schroot.preinst: In prep_mv_conffile(), use dpkg-query in
      place of reading /var/lib/dpkg/status directly.

commit fed9ac4e3a2e488ac1a9903932fc7b132b68fa1b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 18:29:29 2007 +0000

    * bin/schroot/schroot.1.in: Add carriage returns on user input
      lines.

commit 7cd6a7f2fefb2420e9b6192ece62435a42c65379
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 18:22:56 2007 +0000

    * bin/schroot/schroot.1.in: Fix typo.

commit ad94d3b3c5153934d79851171897dd5606b49131
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 18:02:26 2007 +0000

    * bin/schroot/schroot.1.in: Add --force and --session-name options
      to the synopsis.

commit 4ad8317f56fce3742ef1dd636bc200b799f33273
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 17:55:53 2007 +0000

    * debian/changelog: Close #401158.
    * bin/schroot/schroot.1.in: Reorder options and group into
      subsections.  Split the examples section into subsections and add
      a "Sessions" subsection to explain how to use sessions.
    * bin/schroot/schroot.conf.5.in: Add \: breakpoints for a long
      regex.

commit d6319db94fa2fb9094ab2b76a911b40dcb058bca
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 14:11:57 2007 +0000

    * debian/changelog: Close #398679 and #401159.

commit c5fe492617bff1fa791569ba39d5461c2cbb1d60
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 14:10:54 2007 +0000

    * Update translations.

commit 458902e9ea7c9d18d43fd77d2e240f7b20e54a38
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 14:09:41 2007 +0000

    * bin/dchroot/dchroot-session-base.cc,
      bin/dchroot/dchroot-session.cc: Don't include unused uuid.h.

commit 85c6dc069d6e1de7a27b89214fba77f6b573a54e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 14:08:34 2007 +0000

    * test/sbuild-chroot-block-device.cc, test/sbuild-chroot.cc,
      test/sbuild-chroot-file.cc, test/sbuild-chroot-lvm-snapshot.cc,
      test/sbuild-chroot-plain.cc: Add CHROOT_SCRIPT_CONFIG to
      environment checks.

commit 8bce7cac70a646428b0684f9b6ca15db0dd6735e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 14:06:18 2007 +0000

    * NEWS: Document --session-name.

commit 2fd257b371a1ae7c8ecb0874de454961feabcbc2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 11:51:21 2007 +0000

    * TODO: Add permissions check items.

commit 8a3b622f49e8892556ecbbdffffe4a27b798b771
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 11:50:19 2007 +0000

    * sbuild/sbuild-session.cc: Initialise lock_status to true.
      (setup_chroot): Add debugging code to log state on call.  If
      lock_status is false, return without doing anything.  If initial
      lock acquistion or release fails, set lock_status to false.  This
      ensures that no setup script will run on or after lock failure.
    * sbuild/sbuild-session.h: Add lock_status member.

commit c00349b2f96d2c39bcaab75589509302b4c72b2b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 10:02:58 2007 +0000

    * bin/schroot/schroot-main-base.cc (run_impl): When no chroots
      were found and one of the --all options was used, do not treat as
      a fatal error.

commit d80e6e9a79dedd3020127e8784139d0492300e68
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:47:31 2007 +0000

    * bin/schroot/schroot-main-base.cc (run_impl): Call
      session::set_session_id with the session name specified in the
      user options.
    * bin/schroot/schroot-options.cc (add_options): Rename session to
      session_actions.  Add "--session-name" and "--force" options to
      session_options.
    * bin/schroot/schroot-options-base.cc (add_option_groups): Add
      separate session_actions and session_options groups in place of
      session.
    * bin/schroot/schroot-options-base.h (schroot): Add session_name
      member.  Split the session options_description into separate
      session_actions and session_options groups.

commit e318d4b01e1348f6cb69fe25f9d6deca1c5e966d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:32:35 2007 +0000

    * bin/schroot/setup/50chrootname: Strip ISO-8601 date and pid from
      chroot names.

commit b959d650dda429f04aaa8dcfc3f2f2d6e835f06e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:31:30 2007 +0000

    * sbuild/sbuild-session.cc: Add error message for SET_SESSION_ID
      error code.
      (run_impl): Log a warning message if a chroot does not support
      setting a session ID.  If the system does not support UUIDs, use
      the ISO-8601 date and PID instead.
    * sbuild/sbuild-session.h: Add a SET_SESSION_ID error code.
    * configure.ac: Add a HAVE_UUID macro.

commit 61abfe4119628e1775593037763a3b6850a2abac
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:30:36 2007 +0000

    * sbuild/sbuild-session.cc: Add error message for SET_SESSION_ID
      error code.
      (run_impl): Log a warning message if a chroot does not support
      setting a session ID.  If the system does not support UUIDs, use
      the ISO-8601 date and PID instead.
    * sbuild/sbuild-session.h: Add a SET_SESSION_ID error code.
    * configure.ac: Add a HAVE_UUID macro.

commit b42315b4affab67e0b52ed66044476fd58d3fa7a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:23:29 2007 +0000

    * sbuild/sbuild-lock.cc: Add error messages for UNLOCK and
      UNLOCK_TIMEOUT error codes.  Rename second DEVICE_UNLOCK error
      message to DEVICE_UNLOCK_TIMEOUT.  The lock types are now
      exception-safe.
      (~file_lock): If the file is locked, release the lock.  Log a
      warning on error.
      (file_lock::set_lock): Set the locked member.  On unlock error,
      throw UNLOCK or UNLOCK_TIMEOUT.
      (~device_lock): If the device is locked, release the lock.  Log a
      warning on error.
      (device_lock::set_lock): Set the locked member.
    * sbuild/sbuild-lock.h: Add UNLOCK and UNLOCK_TIMEOUT error codes.
      Add locked members to file_lock and device_lock.

commit 87a6ae5ae41ce03f22574c75c05d1bb4d3e121de
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 8 09:16:57 2007 +0000

    * sbuild/sbuild-types.cc
      (isodate::get_date_format): New method to format an ISO-8601 date.
    * sbuild/sbuild-types.h: All destructors are virtual.
      get_date_format is a virtual function overridable in derived
      classes.  Added a new isodate class to format ISO-8601 dates.

commit 23627d5a91fc6c15f2bb6dff8bd1b2d7c8b90a9b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 7 23:08:35 2007 +0000

    * NEWS: Document "script-config".
    * bin/schroot/setup/05file, bin/schroot/setup/05lvm,
      bin/schroot/setup/10mount, bin/schroot/setup/15killprocs,
      bin/schroot/setup/20network, bin/schroot/setup/30passwd,
      bin/schroot/setup/50chrootname, bin/schroot/setup/50sbuild: Source
      $CHROOT_SCRIPT_CONFIG.  50sbuild only runs if SBUILD=true.
    * bin/schroot/setup/00check, bin/schroot/exec/00check: Source
      $CHROOT_SCRIPT_CONFIG.  Print config file name and settings if
      verbose.
    * bin/schroot/schroot.conf.5.in: Document "script-config".
    * bin/schroot/Makefile.am
      (pkgsysconf_DATA): Add script-defaults.
    * bin/schroot/script-defaults: New file.  Default script
      configuration.
    * sbuild/sbuild-chroot.cc
      (chroot): Set script_config default to "script-defaults".
      (get|set_script_config): New methods to get and set script_config.
      (setup_env): Set CHROOT_SCRIPT_CONFIG.
      (get_details): Output "Script Configuration".
      (get_keyfile): Set "script-config".
      (set_keyfile): Get "script-config".
    * sbuild/sbuild-chroot.h: Add script_config member.
    * configure.ac: Fix the definition of PACKAGE_DATA_DIR.  Define
      PACKAGE_SYSCONF_DIR.

commit 977aff2f7923e0c9eaa0927e04275fca7692ef22
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 7 21:11:19 2007 +0000

    * NEWS: Document "script-config".
    * bin/schroot/setup/05file, bin/schroot/setup/05lvm,
      bin/schroot/setup/10mount, bin/schroot/setup/15killprocs,
      bin/schroot/setup/20network, bin/schroot/setup/30passwd,
      bin/schroot/setup/50chrootname, bin/schroot/setup/50sbuild: Source
      $CHROOT_SCRIPT_CONFIG.  50sbuild only runs if SBUILD=true.
    * bin/schroot/setup/00check, bin/schroot/exec/00check: Source
      $CHROOT_SCRIPT_CONFIG.  Print config file name and settings if
      verbose.
    * bin/schroot/schroot.conf.5.in: Document "script-config".
    * bin/schroot/Makefile.am
      (pkgsysconf_DATA): Add script-defaults.
    * bin/schroot/script-defaults: New file.  Default script
      configuration.
    * sbuild/sbuild-chroot.cc
      (chroot): Set script_config default to "script-defaults".
      (get|set_script_config): New methods to get and set script_config.
      (setup_env): Set CHROOT_SCRIPT_CONFIG.
      (get_details): Output "Script Configuration".
      (get_keyfile): Set "script-config".
      (set_keyfile): Get "script-config".
    * sbuild/sbuild-chroot.h: Add script_config member.
    * configure.ac: Fix the definition of PACKAGE_DATA_DIR.  Define
      PACKAGE_SYSCONF_DIR.

commit f0eb3209f26f0580b3b5b60dd9f82904b4e73537
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 26 22:23:18 2007 +0000

    * THANKS: Add Raphal Hertzog.
    * debian/changelog: Close #428805.
    * bin/schroot/schroot.conf.5.in: Document use of --bind and
      --rbind for plain and directory chroots.
    * bin/schroot/setup/10mount: Use --bind rather than --rbind for
      directory chroots.

commit 887d4f76938e862721eab1755ed701dce83aea8b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 21:34:37 2007 +0000

    * debian/changelog: Bump version to 1.1.5.
    * NEWS: Bump version to 1.1.5.
    * configure.ac: Bump version to 1.1.5.  Update AC_COPYRIGHT.
    * THANKS: Add Lucas Nussbaum.

commit 899746d0b92a18f959da920fb339dd13aa81fb7d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 21:18:56 2007 +0000

    * Version 1.1.4.
    * NEWS: Document process killing.
    * debian/changelog: Close #426416.  Finalise for 1.1.4.

commit 6c9a70b783a5b2068d880e9fede7b14d26f9ffb1
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 20:48:54 2007 +0000

    * HACKING: Document tests for process termination.

commit e5420be40ae6c0a16f030eb3bb150407cf024d61
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 13:51:21 2007 +0000

    * bin/schroot/setup/15killprocs: Only run readlink on
      /proc/pid/exe if doing verbose logging.  Thanks to Kees Cook.

commit 74d18b52aa138385d12a0d0a06d4a2fcb84a90eb
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 13:49:56 2007 +0000

    * sbuild/sbuild-run-parts.cc (check_filename): Remove debugging
      messages added to find a problem with regex match failure.

commit f523b9381dedd7647851cc8f2320d1c2b677084f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 13:28:58 2007 +0000

    * Build-Depend on the latest version of Boost, due to the change of
      library symlinks.

commit 7f9338025a2b2601c7e26287c29baa2a6b49fed4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 13:14:55 2007 +0000

    * debian/control:
      - Update package descriptions.
        + Add schroot boilerplate description to schroot-common,
          libsbuild-dev and libsbuild-doc (Closes: #425964).  Thanks to
          Craig Sanders.
        + Update schroot boilerplate.
        + Add a list of reasons not to use dchroot and dchroot-dsa instead
          of schroot.

commit c05ffa61596ab52b44cab611ea8e22e2e2180b40
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 12:20:20 2007 +0000

    * bin/schroot/setup/*: Add a copyright notice and GPL boilerplate
      to all shell scripts.

commit eae72fac788bfb135d0a837ce0a536ae7ed1a18a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 28 12:09:21 2007 +0000

    * debian/changelog: Close #391319.
    * AUTHORS: Add Kees Cook.
    * bin/schroot/setup/15killprocs: New file.  Kill processes in the
      chroot before unmounting any filesystems.  Many thanks to Kees
      Cook for implementing this.
    * bin/schroot/setup/Makefile.am
      (setup_SCRIPTS): Add 15killprocs

commit f12bd4fb59c1a6870965139801b1934cd1b8db51
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 22 22:00:41 2007 +0000

    * bin/schroot/setup/10mount
      (do_umount_all): Cope with the case schroot-listmounts returns
      nothing, so that "" is not unmounted.

commit 2a3e9f62fe4371fc3bb838977bf691dbe6c87910
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 22 21:58:43 2007 +0000

    * debian/control: Change section of libsbuild-doc to "doc".

commit 0992a2e14d6e0a1fea81b15818ea20bbc0326e4e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 22 21:57:48 2007 +0000

    * debian/changelog: Bump version to 1.1.4.  Merge changelog
      entries from schroot-1.0 branch.
    * NEWS: Bump version to 1.1.4.  Merge NEWS entries from
      schroot-1.0 branch.
    * configure.ac: Bump version to 1.1.4.

commit f168a8ede2e0f6241949a2dc0be311e966a6897f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 20 16:34:02 2007 +0000

    * Version 1.1.3.
    * debian/changelog: Finalise for 1.1.3.

commit a64bea756871af6d5d393284c5ccc7e53a015621
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 20 16:32:55 2007 +0000

    * Commit changes for previously committed files.

commit 5852fa7a04d070e1b0b509ec7ad88fa6e7044199
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 20 16:31:55 2007 +0000

    * po/*: Updated translations.

commit ef3c005c1001cc5606a1c4388d3a631fbe0c6089
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 20 15:36:38 2007 +0000

    * NEWS: Bump version to 1.1.3.

commit 144d1057b577cc2b57407a39ecbd93f56ac40cc0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 19 17:25:46 2007 +0000

    * bin/schroot-base/schroot-base-run.h
      (run): Catch a runtime_error thrown while setting the locale, and
      fall back to the C locale.
    * sbuild/sbuild-basic-keyfile.tcc
      (get_locale_string): Catch a runtime_error thrown while setting
      the locale, and fall back to the C locale.
    * debian/changelog: Close Debian bug #425117.

commit e69b6d30e4a2f5c37f3094f29d298a4036fafa9a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 19 17:20:28 2007 +0000

    * debian/changelog: Bump version to 1.1.3.
    * NEWS: Bump version to 1.1.3.
    * configure.ac: Bump version to 1.1.3.  Checks for Boost libraries
      add an -st suffix to use the single-threaded version of the
      library.

commit 1f728f10cb543f87de604f4ee3a396e7ecfd1c40
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu May 10 21:55:04 2007 +0000

    * Version 1.1.2.
    * debian/changelog: Finalise for 1.1.2.

commit 180208bd52d48492429abde992de72920157e4c3
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu May 10 21:08:28 2007 +0000

    * po/POTFILES.in: Remove sbuild/sbuild-keyfile.cc, and add
      sbuild/sbuild-keyfile-base.cc

commit 8b0d6515469661e16545e1e72e9b3410c0236a3d
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu May 10 21:04:53 2007 +0000

    * debian/changelog: Fix typo.

commit 9bfe254c4ee6f5ec0acea0e033b710deb6099570
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu May 10 20:40:02 2007 +0000

    * debian/changelog: Document fixing of 10mount.
    * bin/schroot/setup/10mount (do_umount_all): Don't exec
      schroot-listmounts in a subshell.  This prevents an error (such as
      a bad exit status) from being noticed by the script, and as a
      result failure to umount filesystems may result in severe dataloss
      when stop scripts then "rm -rf" the chroot.

commit 1b4b7677c95ebe4761b32e0c6cb60b815f2e0fa7
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu May 10 20:19:58 2007 +0000

    * sbuild/sbuild-ctty.cc (cttybuf_fd): Don't call log_debug,
      because this is called from a static initialiser, and std::cerr
      isn't yet initialised.  If there is no controlling tty, this will
      result in a segmentation fault.

commit 61d17597253513347944be92a107d7d5a1688bbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed May 9 16:47:57 2007 +0000

    * debian/changelog: schroot-common Replaces schroot (<< 1.1.1).

commit 5d5c2aff8cefc6ee956b453e55630bcc76d60252
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 7 12:29:37 2007 +0000

    * test/sbuild-keyfile.cc: Document where warnings are triggered.
    * sbuild/sbuild-keyfile.h: Add a keyfile_parser class template
      derived from basic_keyfile_parser.  Most of the logic from the
      basic_keyfile operator << method is moved here.
    * sbuild/sbuild-basic-keyfile.tcc: Add new template parameter.
    * sbuild/sbuild-basic-keyfile.h: Add a basic_keyfile_parser class
      template.  The parser is specified by a second template parameter
      in basic_keyfile.  This is used in the operator << method.

commit dfb822b1c187fe70a623be090f17d3fd8eff891d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 6 12:02:50 2007 +0000

    * sbuild/sbuild-keyfile.h: Remove comments about GKeyFile, and
      remove unneeded namespace qualifier.

commit 335b6f9c1f8a5143ee8d3c2a82f5a676fd723728
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 6 11:09:52 2007 +0000

    * sbuild/sbuild-basic-keyfile.tcc: Remove using keywords from
      global scope, because this is included by sbuild-basic-keyfile.h.
      All type names now use explicit namespace qualifiers.

commit b11931b8ab9deaa31b4be36021c3ea215e29e7cb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 5 23:09:30 2007 +0000

    * sbuild/sbuild-keyfile.h: Remove keyfile class.  Replace with a
      simple traits structure, keyfile_traits, and a keyfile typedef to
      specialise basic_keyfile.
    * sbuild/sbuild-basic-keyfile.(h|tcc): Copy of
      sbuild-keyfile.(h|cc), converted into a templated class with
      traits.
    * sbuild/sbuild-keyfile-base.(cc|h): Copy of
      sbuild-keyfile.(h|cc), with all but error codes and priority enum
      removed.

commit ec6807d418fff22379ea36ef017acc64e9758bfd
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 5 23:03:19 2007 +0000

    * sbuild/sbuild-keyfile.h: Remove keyfile class.  Replace with a
      simple traits structure, keyfile_traits, and a keyfile typedef to
      specialise basic_keyfile.
    * sbuild/sbuild-basic-keyfile.(h|tcc): Copy of
      sbuild-keyfile.(h|cc), converted into a templated class with
      traits.
    * sbuild/sbuild-keyfile-base.(cc|h): Copy of
      sbuild-keyfile.(h|cc), with all but error codes and priority enum
      removed.

commit 173508fb4d2e5c1cf9a3623e4fa59d025388cb53
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 5 20:11:03 2007 +0000

    * sbuild/sbuild-keyfile.(cc|h): Remove code moved into
      sbuild_keyfile_base, and inherit from sbuild_keyfile_base.
    * sbuild/Makefile.am (sbuild_public_cc_sources,
      (sbuild_public_h_sources): Include sbuild/sbuild-keyfile.(cc|h).

commit 121531f2956863ba9fabd1c4a7189c448d8aa6e3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 5 18:19:05 2007 +0000

    * sbuild/sbuild-keyfile.(cc|h): Add typedefs for key, group and comment types.

commit f5d1981963d92f363d67e4296c25aa8d46f1bbca
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 4 23:31:40 2007 +0000

    * debian/changelog: debian/rules: Split arch-dependendent and
      arch-independent packages into seprate rules.  Remove .map and
      .md5 files from the Doxygen docs.

commit 4ffbe1c8f55fe9867a09ffefb69759ccfab20f73
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 4 22:17:03 2007 +0000

    * Update svn:ignore properties.

commit 6a0d0c0699428130004e618a39bdbeacb075a8b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 4 22:12:24 2007 +0000

    * debian/changelog: Add new package, libsbuild-doc.

commit 62482ba8af1db63fd95d8fcc7c380da57c71ffb0
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 4 22:08:00 2007 +0000

    * configure.ac: Generate doc/sbuild.dox.
    * doc/Makefile.am: Generate sbuild documentation.  Fix PS_DEPS for
      new manual page locations.
    * doc/schroot.dox.in: Remove sbuild input files, and use sbuild
      tag file.
    * doc/sbuild.dox.in: Split libsbuild API reference from
      schroot.dox.in.

commit 1801b4a13375b9d70517b474df0d4f0f20012289
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri May 4 18:53:33 2007 +0000

    * debian/changelog: Fix issues in debian/control.

commit 09f5a68e79a3b64a6243026ac8cabe45335bda59
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed May 2 21:53:07 2007 +0000

    * debian/changelog: Remove libsbuild1 dependency from
      libsbuild-dev.

commit ace9bf4709e40214d1b64208b99ca495677bb778
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed May 2 21:50:58 2007 +0000

    * debian/changelog: Bump version to 1.1.2.
    * NEWS: Bump version to 1.1.2.
    * configure.ac: Bump version to 1.1.2.

commit 585acc2e2e62cdb47df21f8665d627c7e8b4021b
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed May 2 19:41:32 2007 +0000

    * Version 1.1.1.
    * debian/changelog: Update for 1.1.1.
    * NEWS: Document new environment variables set inside the chroot.
    * TODO: Remove completed SCHROOT_USER item.

commit 30913e65eb2c5402d3c256abc35610481b715852
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 1 21:28:56 2007 +0000

    * debian/changelog: Document packaging of only a static library.

commit 3dd6d1ad6f1abacba0015e08c82421b2c6adef68
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 1 20:24:40 2007 +0000

    * Update translations with new strings (require translation).

commit 504c1ae7ed9c8a195d078d88d785c3d3b72bd19c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue May 1 20:06:42 2007 +0000

    * sbuild/sbuild-environment.cc
      (add): Replace regex_match with regex_search, to avoid missing
      partial matches.
    * sbuild/sbuild-run-parts.cc
      (check_filename): Replace regex_match with regex_search, to avoid
      missing partial matches.

commit ae59c221e633bcb9e05c5bae9d137a45dfa49f9a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 26 21:17:16 2007 +0000

    * test/Makefile.am (LOCAL_CXXFLAGS): Use $(top_srcdir) rather than
      $(top_builddir).

commit 098869d7b89afd84224dbc4cd53b0178450208ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 26 21:15:34 2007 +0000

    * sbuild/sbuild-run-parts.cc
      (run_parts): Don't consider at "." or "..".
    * sbuild/sbuild-chroot-config.cc
      (add_config_directory): Don't consider at "." or "..".

commit 8c9858cedbb8441d66874652f04c52665b4c156a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 26 21:06:49 2007 +0000

    * bin/schroot/schroot-options-base.cc
      (check_actions): Re-add ACTION_SESSION_END.

commit 4a4c1289dbea69c11e580ea893dd3526aa640e12
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 25 20:42:37 2007 +0000

    * NEWS: Document the environment-filter key.
    * bin/schroot/schroot.conf.5.in: Document the environment-filter
      key.
    * bin/schroot/schroot.1.in (list): Document environment variables
      being set, and configuration of environment filtering.
    * sbuild/sbuild-session.cc (run_child): Set SCHROOT_COMMAND,
      SCHROOT_USER, SCHROOT_GROUP, SCHROOT_UID and SCHROOT_GID
      environment variables, equivalent to SUDO_* variables of the same
      name (except for SUDO_GROUP, which does not exist).
    * sbuild/sbuild-auth.cc
      (auth): Initialise rgid and rgroup members from group database.
      (get_rgid): New member function to get rgid.
      (get_rgroup): New member function to get rgroup.
    * sbuild/sbuild-auth.h: Add GROUP error_code and rgid and
      rgroup class members.

commit 9edeb95926e04de6470d632d967e8f425677a07b
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 25 20:28:25 2007 +0000

    * NEWS: Document the environment-filter key.
    * bin/schroot/schroot.conf.5.in: Document the environment-filter
      key.
    * bin/schroot/schroot.1.in (list): Document environment variables
      being set, and configuration of environment filtering.
    * sbuild/sbuild-session.cc (run_child): Set SCHROOT_COMMAND,
      SCHROOT_USER, SCHROOT_GROUP, SCHROOT_UID and SCHROOT_GID
      environment variables, equivalent to SUDO_* variables of the same
      name (except for SUDO_GROUP, which does not exist).
    * sbuild/sbuild-auth.cc
      (auth): Initialise rgid and rgroup members from group database.
      (get_rgid): New member function to get rgid.
    * sbuild/sbuild-auth.h: Add GROUP error_code and rgid and
      rgroup class members.

commit ae0037a4b49c0f7aecb97e0a3617d51f7e3bba11
Author: Luk Claes <luk@debian.org>
Date:   Thu Apr 19 21:18:39 2007 +0000

    Fix some whitespaces, document bugnumber for po/fr.po in debian/changelog

commit 9deff26eb11d7ac7f69ba1c42ad1afb645b09cc6
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 6 15:58:27 2007 +0000

    * po/POTFILES.in: Updated with new file locations.
    * Move bin/schroot/schroot-listmounts* to
      bin/schroot-listmounts.
    * Move bin/schroot/schroot-releaselock* to
      bin/schroot-releaselock.

commit e07f1b5d4a1e077f0066498cb5f47ea901a2b80f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 6 14:31:38 2007 +0000

    * bin/csbuild/csbuild-debian-changes.h: Indent method arguments,
      and tidy.
    * bin/csbuild/csbuild-debian-changes.cc (get_value): New methods,
      specialising the generic template for value_type.

commit d48b933504e5d82462a47ce3be83c61e36c5e13f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 6 14:01:54 2007 +0000

    * bin/csbuild/csbuild-debian-changes.(cc|h): New class, base class
      for parsing .changes and .dsc files, based on sbuild::keyfile.
    * bin/csbuild/Makefile.am
      (csbuild_SOURCES): Add csbuild-debian-changes.(cc|h).

commit 83f57d2213df1874e3dc5e1a70eb23f98327f82f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 21:14:04 2007 +0000

    * bin/schroot-base/schroot-base-options.h: Added actions options
      group.
    * bin/schroot-base/schroot-base-options.cc (add_option_groups):
      Add actions group to the visible and global options groups.
    * Updated all options code to use the actions group instead of the
      general group.  Added default actions to schroot and csbuild.

commit d376c8fdee5ab7bba587c7c4a714b3cc162123ec
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 20:32:45 2007 +0000

    * bin/schroot/setup/50sbuild: Fix syntax error in test.

commit b4cab4666403b17eb1e43169dbfd8c186fa85a71
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 20:28:47 2007 +0000

    * Replace all files in bin/csbuild with schroot-releaselock
      sources, and customise for csbuild.  The standard options are
      taken from the existing sbuild implementation.

commit 59e47766211ac9747b6da0a265dd134b6560cf5b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 17:03:01 2007 +0000

    * po/POTFILES.in: Updated with new file locations.
    * Update copyright headers on files for 2007.

commit 1bc595a3e40b077130f5b0404b250389734be3de
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 14:52:05 2007 +0000

    * test/schroot-base-option-action.cc: New file, unit test for
      schroot_base::option_action.

commit dc5ccc9cc95e0fad592838a9ddf00d8b6707651a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Apr 5 14:19:11 2007 +0000

    * bin/schroot-base/schroot-base-option-action.h: Replace
      std::string with action_type typedef.  Add inline operator ==, !=,
      and = methods.
    * bin/schroot-base/schroot-base-option-action.cc: Replace
      std::string with action_type typedef.
      (set): If the action is set more than once, throw a
      validation_error exception.
    * bin/schroot-base/schroot-base-options.h: Add action_type typedef
      for option_action::action_type.  Add action_type constants for
      help and version.  Add action member (an option_action).
    * bin/schroot-base/schroot-base-options.cc
      (add_options): Add help and version actions.
      (check_options): Check and set help and version actions.
    * bin/schroot-base/schroot-base-main.cc (run): Remove logic_error
      checks, since boost program_options errors are also derived from
      logic_error.
    * bin/schroot/schroot-options-base.h: Replace action_type enum
      with separate constants.  Remove action member.
    * bin/schroot/schroot-options-base.cc
      (add_options): Add actions and set default action.
      (check_options): Remove help and version checks.  Update sanity
      check.
      (check_actions): Chain up to base class method.  Replace switch
      with set of if-else blocks.
      (set_action): Remove.
    * bin/schroot/schroot-options.cc
      (check_options): Replace set_action with simple assignment.
    * bin/schroot/schroot-listmounts-options.h: Replace action_type
      enum with separate constants.  Remove action member.
    * bin/schroot/schroot-listmounts-options.cc
      (add_options): Add action and set default action.
      (check_options): Remove help and version checks.  Update sanity
      check.
      (set_action): Remove.
    * bin/schroot/schroot-releaselock-options.h: Replace action_type
      enum with separate constants.  Remove action member.
    * bin/schroot/schroot-releaselock-options.cc
      (add_options): Add action and set default action.
      (check_options): Remove help and version checks.  Update sanity
    check.
      (set_action): Remove.
    * bin/csbuild/csbuild-options.cc
      (check_options): Replace set_action with simple assignment.
    * bin/dchroot/dchroot-options.cc
      (check_options): Replace set_action with simple assignment.
    * bin/dchroot-dsa/dchroot-dsa-options.cc
      (check_options): Replace set_action with simple assignment.

commit 16fdb82fcd2c1c5f569f5c5b196983e31eba4609
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 4 08:22:24 2007 +0000

    * Update all classes derived from schroot_base::main to specify
      the use_syslog parameter.
    * bin/schroot-base/schroot-base-main.cc (run): If use_syslog is
      true, call openlog and closelog with the program name as the
      identity.
    * bin/schroot-base/schroot-base-main.h: Add use_syslog as
      constructor argument and member variable.

commit 91523e12ea961cf112e206c79ac893785de4b4c0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Apr 3 21:14:05 2007 +0000

    * bin/schroot-base/schroot-base-main.h: Add TODO item.
    * bin/schroot-base/schroot-base-main.cc (run): Add additional
      information output for caught logic_error exceptions.

commit c4cc4f1bfe22b94e15372de37424ccca4426e0fe
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Apr 3 21:10:12 2007 +0000

    * bin/schroot-base/Makefile.am (libschroot_base_la_SOURCES): Add
      schroot-base-option-action.(cc|h).

commit d4e48672dc7bc4f773b33c0612eb5494c754e331
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Apr 3 21:08:41 2007 +0000

    * bin/schroot-base/schroot-base-option-action.(cc|h): New class to
      manage actions specified by command-line options.

commit f57dc24962994768ccb4288cf998dc69b8d91a6c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Apr 3 13:04:19 2007 +0000

    * bin/schroot-base/Makefile.am: New file, based on
      bin/schroot/Makefile.am.
    * configure.ac: Add bin/schroot-base/Makefile.
    * Move bin/schroot/schroot-base-* to bin/schroot-base.  Update all
      dependent files to use the new path.

commit a01780a09b5a120893b6a527daecfc128f592e6e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Apr 3 11:05:32 2007 +0000

    * Remove schroot, dchroot, dchroot-dsa and csbuild directories,
      now they have been moved to /bin.

commit d13976e9e6a9dbb23e59b493f562ef874bb5eb86
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Apr 2 09:45:35 2007 +0000

    * AUTHORS: Add Federico Di Gregorio.
    * debian/changelog: Update init script to use a default file.

commit 58187d2accabcaeba61a36eb7d5243e752856ac4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 1 21:45:32 2007 +0000

    * Move schroot, dchroot, dchroot and csbuild to a new
      subdirectory, bin.
    * bin/*/Makefile.am (LOCAL_CXXFLAGS): Add -I$(top_srcdir)/bin.
    * bin/Makefile.am: New file.
      (SUBDIRS): schroot dchroot dchroot-dsa csbuild
    * configure.ac: Use new file locations.
    * doc/schroot.dox.in: Use new source locations.  Disable call
      graph.

commit 04462fcccc7a5537a6a7c7f9407b48a2ac1167de
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 1 20:44:11 2007 +0000

    * debian/changelog: Create new packages sbuild-common, libsbuild1
      and libsbuild1-dev.
    * sbuild/Makefile.am (lib_LTLIBRARIES): Install libsbuild in
      $(libdir).
      (pkgincludedir): New variable, header location.
      (pkginclude_HEADERS): Headers to install.
      (pkgconfigdatadir): New variable, pkg-config data location.
      (pkgconfigdata_DATA): pkg-config data to install.
      (libsbuild_version): New variable, libsbuld versioning.
      (libsbuild_la_LDFLAGS): libsbuild libtool flags.
    * sbuild/sbuild.pc.in: New file.  pkg-config template for
      libsbuild.
    * configure.ac: Add shared library versioning logic (from
      Gutenprint configure script).  AM_INIT_AUTOMAKE: Distribute a
      POSIX PAX tape archive.  Create shared libraries rather than
      static.  Create a pkg-config .pc file for libsbuild.

commit 1de9f4943dcd5e5e9c878ff18eebf8d7f8b96bc7
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Mar 16 23:02:51 2007 +0000

    * schroot/setup/50sbuild: Create user home directory if it doesn't
      exist in the chroot and ensure it has the correct permissions.

commit c11a8c54ca0e4ee6435412aee4fe2066934c0a73
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Mar 16 22:58:27 2007 +0000

    * doc/schroot.dox.in: Add csbuild.
    * Makefile.am: Add csbuild to SUBDIRS.
    * configure.ac: Add enable check and support for csbuild.
    * csbuild/csbuild-session-base.cc, csbuild/csbuild-options.cc,
      csbuild/csbuild-main-base.cc, csbuild/csbuild-options.h,
      csbuild/csbuild-session-base.h, csbuild/csbuild-main-base.h,
      csbuild/csbuild.1.in, csbuild/Makefile.am, csbuild/csbuild.cc,
      csbuild/csbuild-main.cc, csbuild/csbuild-main.h: New files.
      Initial C++ implementation of sbuild; infrastructure classes
      copied from dchroot.

commit 898d07168356c9cc70958d5bd5ee5aa41c4a47a1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 11 21:55:06 2007 +0000

    * Merge from schroot-1.0 branch.
    * po/fr.po: Add French translation.  Many thanks to Nicolas
      Franois <nicolas.francois@centraliens.net>.

commit 24dcb6cf42f07dd9905fbbede6b9858a2ff4a2df
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 11 11:40:02 2007 +0000

    * sbuild/sbuild-i18n.h: Remove commented-out macro.

commit 524fa442f406d0775acc220bf97517bcc7d7fc0e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 27 13:26:07 2007 +0000

    * schroot/schroot-listmounts-main.cc (list_mounts): Ensure path
      returned by realpath(3) is not null.
    * schroot/schroot-listmounts-main.h: Add FIND error code.

commit cb19a95ff5832201cade0364010e8c185ed89960
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 27 13:25:45 2007 +0000

    * schroot/schroot-listmounts-main.cc (list_mounts): Ensure path
      returned by realpath(3) is not null.
    * schroot/schroot-listmounts-main.h: Add FIND error code.

commit a037672e6bb6c08b521022ded624aea870c2afaf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 23 11:36:53 2006 +0000

    * schroot/schroot-listmounts-main.cc
      (list_mounts): Use realpath(3) to ensure the correct mountpoint it
      checked.  This prevents severe dataloss if the user has placed a
      symbolic link in the SCHROOT_MOUNT_DIR path.
    * NEWS: Document realpath fix.

commit 93caf61903fd327962d0f36e127aab7ff6a3c63b
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Nov 3 00:52:15 2006 +0000

    * debian/schroot.init: Add LSB init info and use LSB init
      functions.
    * debian/changelog: Update.

commit a927845bd9c6cce8e9c16b7daa65701b205a91e5
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 18 19:54:22 2006 +0000

    * schroot/schroot.1.in: Fix a number of minor typos.  Thanks to Jens Seidel.

commit e41a97497ca40d6b43e67f2f9f83bd3be0d5bb62
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 18 19:51:42 2006 +0000

    * dchroot/dchroot-main-base.cc: Add translator comment.

commit a5d1aec7510e4c21e633bf18a25055567a8ce721
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 18 19:49:04 2006 +0000

    * README, schroot/schroot-setup.5.in, schroot/schroot.conf.5.in:
      Fix a number of minor typos.  Thanks to Jens Seidel.

commit 0f4f4ab3266cc1cef7c7b58f289a8e0654036f57
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 18 19:41:37 2006 +0000

    * po/de.po: Update German translation.  Thanks to Jens Seidel.

commit a82827d6c635c9421ead4e060a81dd39da2a91ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Oct 14 14:15:57 2006 +0000

    * po/de.po: Updated German translation.  Thanks to Helge
      Kreutzmann.

commit 8af7c97f6bf5b3ef3d55d3b67b337a588ad36f07
Author: Luk Claes <luk@debian.org>
Date:   Wed Oct 4 18:50:34 2006 +0000

    Updated po/cs.po

commit f35b91916736b7ae453f73bd6abe3069edff7dd9
Author: Luk Claes <luk@debian.org>
Date:   Wed Oct 4 18:23:05 2006 +0000

    Updated po/vi.po

commit 63fb7d4b4bd1bceb172b98b1f3ce0da2da15e39f
Author: Luk Claes <luk@debian.org>
Date:   Wed Oct 4 06:44:14 2006 +0000

    Updated po/sv.po for schroot

commit d16eae349d2dbce051ff3d412ca5f345d409b255
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 2 22:43:45 2006 +0000

    * Translation updates.

commit 6d5100c773f5d8090b0848eb1d228e541c5539a4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 2 22:02:37 2006 +0000

    * NEWS: Document changed syslog behaviour.
    * dchroot/dchroot-session.cc, dchroot-dsa/dchroot-dsa-session.cc
      (get_user_command): syslog logging of the command or shell being
      run in the chroot now only occurs when running as root or
      switching to another user.

commit 97058f3c3827c6978aeb4413bf4c26bff231d98d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 2 22:00:23 2006 +0000

    * debian/changelog: Bump version to 1.1.1.
    * NEWS: Bump version to 1.1.1.
    * configure.ac: Bump version to 1.1.1.

commit 7661d392bddae1f3c8aa190871b5d0eb219c8086
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 25 19:43:00 2006 +0000

    * Version 1.1.0
    * debian/changelog: Update for 1.1.0
    * TODO: Remove completed item.

commit b4814c0e5b7b089bf0a926f1e84c70d4b997bd48
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 25 17:27:05 2006 +0000

    * po/schroot.pot: Add.

commit d98dc6d205ca134a8a26fb50e37e96ade1195bf6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 19 20:37:54 2006 +0000

    * NEWS: Document --directory.

commit d91a9b9fc9fbd413313dd41bad0df4f9aff95800
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 19 20:34:04 2006 +0000

    * schroot/schroot.1.in, dchroot/dchroot.1.in,
      dchroot-dsa/dchroot-dsa.1.in: Document directory option.

commit cfb0da61c2443149dddd017da5605ace1d2bd5c4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 19 20:23:22 2006 +0000

    * HACKING: Document additional directory fallback checks.
    * schroot/schroot.1.in, dchroot/dchroot.1.in,
      dchroot-dsa/dchroot-dsa.1.in: Document directory option.
    * schroot/schroot-main-base.cc
      (run_impl): If a directory option was specified, set the auth wd
      member.
    * schroot/schroot-options.cc, dchroot/dchroot-options.cc,
      dchroot-dsa/dchroot-dsa-options.cc:
      (add_options): Add directory option.
    * schroot/schroot-options-base.h: Add directory member, used to
      specify the directory inside the chroot.

commit e5e53478a126fda7f071cbcb65bed459fb271954
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 19 20:14:00 2006 +0000

    * sbuild/sbuild-auth.cc (get_wd, set_wd): New methods.  Get and
      set the working directory.
    * sbuild/sbuild-auth.h: Add wd member variable to store the
      working directory to use.

commit 37d2250d95c6367c112ac45ee569b48ddb80d1ee
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 19 20:09:06 2006 +0000

    * sbuild/sbuild-auth.cc (get_wd, set_wd): New methods.  Get and
      set the working directory.
    * sbuild/sbuild-auth.h: Add wd member variable to store the
      working directory to use.

commit 24b5a992959a81e2b4f3951f8bbe9f2f1ec43f0e
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 18 21:38:01 2006 +0000

    * schroot/schroot-base-options.cc,
      schroot/schroot-options-base.cc,
      schroot/schroot-listmounts-options.cc,
      schroot/schroot-releaselock-options.cc
      (add_option_groups): Add workaround for boost if
      BOOST_PROGRAM_OPTIONS_DESCRIPTION_OLD is defined.
    * configure.ac: Add check for
      boost::program_options::options_description::options(), which does
      not exist in older versions of boost.

commit 8c48ef5765fa442dc4f6a5442ade8793250b5880
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 18 16:51:47 2006 +0000

    * sbuild/sbuild-ctty.cc: Include <config.h>, to prevent a build
      failure with GCC 3.3.

commit bed1a4057efdc08a4ec61f36600f257d76547a5a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Aug 7 15:10:36 2006 +0000

    * sbuild/sbuild-session.cc
      (get_auth_status): Fix TODO comment markup.
    * Merge from schroot-1.0 branch.
    * NEWS: Document changed syslog behaviour.
    * sbuild/sbuild-session.cc
      (get_login_command, get_user_command): syslog logging of the
      command or shell being run in the chroot now only occurs when
      running as root or switching to another user.

commit ee690c345e8295f2fa01d01790a235421afc42ec
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 6 10:46:04 2006 +0000

    * NEWS: Document CTTY changes to authentication.

commit 4f3d9409a342217fc9621ad3441c79493b60c9ee
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 22:50:07 2006 +0000

    * sbuild/sbuild-session.cc
      (save_termios, restore_termios): Use CTTY_FILENO instead of
      opening and closing /dev/tty.
    * sbuild/sbuild-auth-conv-tty.cc
      (read_string): Use CTTY_FILENO in place of STDIN_FILENO, and cctty
      in place of std::cerr.  Unlike std::cerr, cctty doesn't autoflush,
      so flush by hand.  Use log_ctty_exception_warning in place of
      log_exception_warning.
      (conversation): Use log_ctty_info and log_ctty_error in place of
      log_info and log_error.
    * sbuild/sbuild-auth-conv-tty.h: Add CTTY error code.

commit fde3f289f4f85fd9aa0952eddfaaa6ebd611ce95
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 22:33:11 2006 +0000

    * sbuild/sbuild-log.cc
      (log_ctty_info): New function.  The same as log_info, but log to
      cctty instead of std::cerr.
      (log_ctty_warning): New function.  The same as log_warning, but
      log to cctty instead of std::cerr.
      (log_ctty_error): New function.  The same as log_error, but log to
      cctty instead of std::cerr.
      (log_ctty_exception_warning): New function.  The same as
      log_exception_warning, but log to cctty instead of std::cerr.
      (log_ctty_exception_error): New function.  The same as
      log_exception_error, but log to cctty instead of std::cerr.

commit e88603a850c08a4be501f2e2062a9dc5c4d68cbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 22:30:24 2006 +0000

    * po/POTFILES.in: Add sbuild/sbuild-ctty.cc.
    * sbuild/Makefile.am: Add sbuild/sbuild-ctty.(cc|h).
    * sbuild/sbuild-ctty.(cc|h): New files.  These implement
      Controlling TTY (CTTY) file descriptor and iostream functionality.

commit 02799d38f453dc5d088bf63bbc3ce55ce713bb5e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 22:29:33 2006 +0000

    * po/POTFILES.in: Add sbuild/sbuild-ctty.cc.
    * sbuild/Makefile.am: Add sbuild/sbuild-ctty.(cc|h).
    * sbuild/sbuild-ctty.(cc|h): New files.  These implement
    Controlling TTY (CTTY) file descriptor and iostream functionality.

commit 043e0d550e6a7ccc99993bb73448f41dd777b01a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 13:06:30 2006 +0000

    * schroot/schroot-releaselock-main.h
      (schroot_releaselock): Remove completed TODO item (PID
      capitalisation).

commit c05ccf1027e621b52062aa8833abfffa73cd656d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Aug 5 13:04:20 2006 +0000

    * schroot/schroot-main.cc, schroot/schroot-listmounts-main.cc,
      schroot/schroot-releaselock-main.cc, dchroot/dchroot-main.cc,
      dchroot-dsa/dchroot-dsa-main.cc: Translate program usage message
      in place.
    * schroot/schroot-base-main.cc
      (action_help): Don't translate the program usage message.  The
      usage text provided should already be translated.

commit e2fb4ad4fdcd480eba05fbbc9a3ad731f44751b3
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 4 18:54:46 2006 +0000

    * All Makefile.am
      (DEFS): Don't use -DGETTEXT_PACKAGE.
    * All sources not using the sbuild namespace import sbuild::_ and
      sbuild::N_ where needed.
    * schroot/schroot-base-run.h): Use SBUILD_MESSAGE_CATALOGUE in
      place of GETTEXT_PACKAGE.  Use sbuild::log_unknown_exception_error
      instead of calling log_error directly.
    * sbuild/sbuild-i18n.h
      (gettext, _, gettext_noop, N_): These are all inline functions in
      the sbuild namespace instead of global macros.  gettext uses
      dgettext with SBUILD_MESSAGE_CATALOGUE.
      Remove completed TODO item.
    * sbuild/sbuild-config.h.in
      (SBUILD_MESSAGE_CATALOGUE): New macro, defining the message
      catalogue name.
    * sbuild/sbuild-log.cc
      (log_unknown_exception_error): New function to log an error
      message for unknown exceptions.

commit 22b545de9e383b803e04d8b157d2df86997f7d3a
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 4 16:00:20 2006 +0000

    * schroot/schroot-releaselock-main.cc
      (action_releaselock): Capitalise PID.

commit b7118117a7505305bfedf4ec6b8595644a07a459
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Aug 4 15:57:30 2006 +0000

    * sbuild/sbuild-chroot-config.h (error_code): Remove unused
      DIR_OPEN enum.
    * sbuild/sbuild-chroot-config.cc (add_config_directory): Use
      sbuild::dirstream in place of opendir/readdir/closedir.

commit 223f8b858214fac9454f171d40fec4c733f5b3e5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 3 11:33:50 2006 +0000

    * sbuild/sbuild-run-parts.h, sbuild/sbuild-session.h: Remove
      completed TODO items.
    * sbuild/sbuild-session.cc (wait_for_child): Use waitpid in place
      of wait.
    * sbuild/sbuild-run-parts.cc (wait_for_child): Use waitpid in
      place of wait.

commit b38a098db5a297980f6d13e52efd625625f843a5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 3 10:21:16 2006 +0000

    * sbuild/sbuild-chroot.cc
      (set_location): Be less strict when validating the location;
      strict validation is already performed in derived chroot types.
      This prevents errors when reading the session configuration.

commit 3f2bed2535a9f0d0d2935639debbd4fab01738df
Author: Luk Claes <luk@debian.org>
Date:   Wed Aug 2 17:14:45 2006 +0000

    Updated po/sv.po

commit 7f3034497a8c9dad4fc4ebed8925c175f4836241
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 20:07:48 2006 +0000

    * sbuild/sbuild-auth.h (sbuild): Document that the environment
      sanitisation is no longer performed, and this is the caller's
      responsibility.
    * sbuild/sbuild-auth.cc (setupenv): Remove environment
      sanitisation logic, now this is handled in the session code, using
      the chroot and environment filter logic.

commit 4a83d772fdc891447c2aae9fa2b70821084e066f
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 20:04:47 2006 +0000

    * sbuild/sbuild-session.cc (run_child): Use the chroot
      environment_filter when setting the chroot execution environment.

commit 890b120c557fe2fa0a01fd8fd7b8e4609b4366f4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 20:02:51 2006 +0000

    * test/sbuild-chroot.cc: Add environment_filter test.
    * sbuild/sbuild-chroot.cc
      (get_environment_filter): New method.  Get the environment filter
      regex.
      (set_environment_filter): New method.  Set the environment filter
      regex.
      (get_details): Add "Environment Filter" line.
      (get_keyfile): Set "environment-filter" key.
      (set_keyfile): Get "environment-filter" key.
    * sbuild/sbuild-chroot.h: Add environment_filter member, a regular
      expression to filter the environment inside the chroot.

commit 599379c35b112f587f062e9a1428a398b56cb39f
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 19:43:49 2006 +0000

    * test/sbuild-environment.cc: Add regex filter tests.
    * sbuild/sbuild-environment.cc
      (set_filter): Set filter regex.
      (get_filter): Get filter regex.
      (add): Check environment variable name does not match the regex
      before adding it.
    * sbuild/sbuild-environment.h: Add filter member, a regular
      expression to filter the environment.  All operators take a const
      reference as the right-hand side argument.

commit 0048f5058f1de5b653cc41923ecb8a9dfb070296
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 19:20:02 2006 +0000

    * sbuild/sbuild-run-parts.cc
      (check_filename): Use sbuild::regex in place of boost::regex.

commit d9ca90f9debfeaccc9f9ac5bb861021d719b2777
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Aug 1 19:18:37 2006 +0000

    * test/Makefile.am (TESTS): Add sbuild-regex.
    * test/sbuild-regex.cc: New file.  sbuild::regex unit tests.
    * sbuild/Makefile.am
      (sbuild_public_h_sources): Add sbuild-regex.h.
    * sbuild/sbuild-regex.h: New file.  POSIX extended regular
      expression class, based on boost::regex.  It supports input and
      output from streams.

commit ec9d8a759aada29cff3fb62d60c48ef938981cca
Author: Luk Claes <luk@debian.org>
Date:   Tue Aug 1 17:08:28 2006 +0000

    Update po/cs.po.

commit d351fc79b4f1270ad61361a33833a7764ae4c321
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 31 17:59:11 2006 +0000

    * sbuild/sbuild-chroot-config.cc: Use "by", rather than "with"
      when referring to chroot name.

commit fbf8a4f0a012c63b7b556aeff7a6512cfad9491c
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 31 10:47:52 2006 +0000

    * schroot/schroot.1.in, dchroot/dchroot.1.in: Document mips and
      mipsel personality bug.

commit 3820d2ae8986a41d5b7c3c6a17c5b9aa08a73305
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 31 10:13:51 2006 +0000

    * schroot/setup/50chrootname: Name in log message always matches
      debian_chroot chrootname.

commit c9497e2b40361320ac8e89c7ec99293963124936
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 30 22:10:07 2006 +0000

    * Update translator comments.

commit ab11567deb8a31e849f525473058aca235bdc3bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 30 22:09:00 2006 +0000

    * Merge from schroot-1.0 branch.
    * Update translator comments.
    * Add sbuild/sbuild-types.cc.

commit f2109763047e8a26384cf6bb100e0886145e5206
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 30 21:38:35 2006 +0000

    * po/LINGUAS: Add cs.

commit 992fbbb95c19f7e0e100b7fef116ef3c1252c65f
Author: Luk Claes <luk@debian.org>
Date:   Sun Jul 30 16:18:37 2006 +0000

    Add po/cs.po

commit 9bfbba1c0cdbf0e1b398aff872ccfa3261023b72
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 30 11:20:36 2006 +0000

    * Merge translations from schroot-1.0 branch.

commit 3357af4ea32bae2ed92b9bb6b95c6b260004febf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 30 10:41:12 2006 +0000

    * Merge from schroot-1.0 branch.
    * configure.ac: Fix --enable-dchroot-dsa help string.  Thanks to
      Jens Seidel <jensseidel@users.sf.net> for reporting this.
    * schroot/schroot-options-base.cc
      (check_actions): Clarify error message when starting a session,
      and the number of chroots specified is not 1.  Thanks to Jens
      Seidel <jensseidel@users.sf.net> for reporting this.
    * schroot/schroot-base-main.cc
      (action_version): Fix translator comment.  Thanks to Jens Seidel
      <jensseidel@users.sf.net> for reporting this.
    * sbuild/Makefile.am
      (sbuild_public_cc_sources): Add sbuild-types.cc.
    * sbuild/sbuild-types.cc: New file.
      (get_date_format): Get a localised strftime format string.
    * sbuild/sbuild-types.h (operator <<): Allow localisation of the
      std::time_put format string.

commit 20d587bfdbe8c5e7f84d80c927d9f842467e1398
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 29 20:22:25 2006 +0000

    * New development series on the main trunk.
    * debian/changelog: Bump version to 1.1.0.
    * NEWS: Bump version to 1.1.0.
    * configure.ac: Bump version to 1.1.0.

commit 03b706057b04f84cb5859b0779974f0fee343b22
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 29 20:12:01 2006 +0000

    * Update translations.

commit fd7482fd61a93aa2e37ebea7d4a14c4b7b69ec0d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 29 19:34:57 2006 +0000

    * TODO: Add future items.
    * All catch blocks catch const references.
    * sbuild/sbuild-run-parts.cc
      (run_child): Handle exceptions thrown in child.
    * sbuild/sbuild-session.cc
      (setup_chroot): Handle exceptions thrown in child.
    * Replace all uses std::locale("C") with std::locale::classic().
    * Replace all uses of NULL with 0.
    * sbuild/sbuild-auth.cc
      (auth): Remove redundant auth_conv_tty dynamic_cast.
      (~auth): Log an error if an exception is caught.
      (set_user): Default uid and gid to current uid and gid, rather
      than 0, for extra safety when an error occurs.
      (run, start): Use reinterpret_cast instead of static_cast when
      casting void *.
      (authenticate): Don't leak hostname array if an exception is
      thrown.

commit 1b3b7511596ea3cd5212ad61bc48ca884fd1d088
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 29 17:29:37 2006 +0000

    * Update manual pages.
    * sbuild/sbuild-lock.h: Add missing virtual specifier from virtual
      methods in derived lock classes.
    * sbuild/sbuild-session.cc: Remove use of excess braces when
      throwing exceptions.
      (get_shell): Use log_exception_warning.
    * Remove incorrect and misplaced comments.
    * Update translator comments.
    * Update API reference to document all missing and incomplete
      documentation.

commit 262b335161988f529328a748e5fe8072b24fb324
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 18:46:52 2006 +0000

    * NEWS: Update for 1.0.0.

commit c17da1709895833a8ed37377a8e201038892c7a6
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 17:59:30 2006 +0000

    * schroot/Makefile.am
      (libschroot_base_la_SOURCES): Distribute schroot-base-run.h.

commit b71328f38ab29b5d96f250fcfe8c231bfe736e33
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 17:12:49 2006 +0000

    * po/LINGUAS: Rename en_GB to en.
    * po/en.po: Rename from en_GB.po.

commit a1a94de910fb9bf40c35dae32d649542f875e7fe
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 17:11:09 2006 +0000

    * po/en_GB.po: Add en- and em-dashes.

commit b3442ba7506f75ba5419fe69de3c36aabba33cff
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 17:02:42 2006 +0000

    * schroot/schroot-listmounts-main.(cc|h),
      schroot/schroot-releaselock-main.(cc|h): Use opts rather than
      options as the member name for the options smartpointer; this
      doesn't conflict with the options class in the same namespace, and
      fixes a compile error with GCC 3.3.

commit 15a0899dbea9ad1555d83c75acf92cfa8c87ab31
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 15:55:38 2006 +0000

    * sbuild/sbuild-chroot-config.cc (load_data): Fix comment.

commit 92f061b9c5545a12d9258c17d2bfd88fa5149538
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 15:54:41 2006 +0000

    * sbuild/sbuild-session.cc
      (save_termios, restore_termios): Close CTTY fd to prevent fd leak.

commit e387ad82174f81447f5b5e6af94772fb7666226b
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 15:51:52 2006 +0000

    * schroot/schroot.cc, schroot/schroot-listmounts.cc,
      schroot/schroot-releaselock.cc, dchroot/dchroot.cc,
      dchroot-dsa/dchroot-dsa.cc: Use schroot_base::run<>.
    * schroot/schroot-base-run.h: New file.  Implement a generic
      templated main routine.

commit 3a33295cb447de3dc1657a29a6537cc87025e6c2
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 28 15:05:44 2006 +0000

    * schroot/schroot-base-main.cc
      (run): Remove locale and gettext setup.
    * schroot/schroot.cc, schroot/schroot-listmounts.cc,
      schroot/schroot-releaselock.cc, dchroot/dchroot.cc,
      dchroot-dsa/dchroot-dsa.cc: Set up locale and gettext message
      catalogue.

commit cecc1282c4622f04c395da7d9c8d778a1de16a91
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 21:11:51 2006 +0000

    * sbuild/sbuild-auth-conv.h: Update API documentation.

commit 9ab12357eec12b566d2e1dfc455ec3d8f76ecefa
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 20:09:27 2006 +0000

    * sbuild/sbuild-auth.cc
      (authenticate): Split string definition and appending of
      additional parts into multiple statements, for GCC 3.3
      compatibility.
    * sbuild/sbuild-tr1types.h: If using boost::shared_ptr, import
      static_pointer_cast, const_pointer_cast and dynamic_pointer_cast
      into the std::tr1 namespace for GCC 3.3 and 3.4 compatibility.

commit 686f8e95080ed64e760810b552d401eda7c9dee5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 20:04:40 2006 +0000

    * po/de.po: Update German translation.

commit 94f509c3077af615879bff2e76b2908dbccc3c41
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 19:52:28 2006 +0000

    * schroot/schroot-releaselock.cc, schroot/schroot.cc,
      schroot/schroot-listmounts.cc, sbuild/sbuild-parse-error.h,
      sbuild/sbuild-auth.cc, sbuild/sbuild-auth.h, dchroot/dchroot.cc,
      dchroot-dsa/dchroot-dsa.cc: Fix typo (occured).  Thanks to Jens
      Seidel <jensseidel@users.sf.net> for reporting this.

commit 358b9342c624fa67506fc153e0a52e3fb845062c
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 10:36:45 2006 +0000

    * po/LINGUAS: Add de.
    * po/de.po: New file.  German translation from Jens Seidel.

commit 0020b5d34f31dbf3d73a072e75fb05ec581af1fc
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 10:34:53 2006 +0000

    * po/LINGUAS: Add de.
    * po/de.po: New file.  German translation from Jens Seidel.

commit e469738b30cc42a4f38770201290082bc38cc933
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 27 10:05:27 2006 +0000

    * schroot/schroot-listmounts-main.cc
      (action_listmounts): mounts is const, to fix a GCC 4.0 compiler bug.

commit cb3a49e6ae1def77135d35b74c64be5ec47ee7e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 18:12:17 2006 +0000

    * debian/changelog: Add missing Debian-specific revisions.

commit 0204dcc57a4093177de35c89f53f40c802fa14b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 18:06:39 2006 +0000

    * debian/changelog: debian/copyright updates.

commit e8ef56771f11a035ebdb7e4228f0f71b18de7309
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 17:47:44 2006 +0000

    * po/LINGUAS: Add vi.

commit 2177c65c9f51f5bf1a5f416351d98d7f5d8bde1e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 17:32:41 2006 +0000

    * debian/changelog: Bump version to 1.0.0.
    * NEWS: Bump version to 1.0.0.
    * configure.ac: Bump version to 1.0.0.

commit afa491b7713f690f74be399b0e9fa1ba29764331
Author: Luk Claes <luk@debian.org>
Date:   Thu Jul 20 16:24:56 2006 +0000

    Updated po/vi.po

commit f6bc6370741e40c659dff4e541260cab7c2dfc56
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 15:09:14 2006 +0000

    * Version 0.99.4
    * debian/changelog: Update for 0.99.4

commit 536157997cdb785635c75c9b9ee22f321f65417b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 15:02:06 2006 +0000

    * po/en_GB.po: Update translation.

commit 81432a1d57986ce4082a9a5c2ade838cf2212945
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 14:59:11 2006 +0000

    * TODO: Remove completed item (duplictes in conffiles should be an
      error).

commit a0d89283ec3d3d0552144a0bf06e691caa72af7d
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 14:42:35 2006 +0000

    * sbuild/sbuild-auth.h: Remove incorrect comment.

commit dd0f05d44e07c1d3fb628811e237b70bc1c50045
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 14:41:36 2006 +0000

    * sbuild/sbuild-session.cc
      (run_impl): Make sure setup_chroot (for EXEC_STOP and SETUP_STOP),
      clear_sigterm_handler, and clear sighup_handler are always called,
      and always called once only.
    * sbuild/sbuild-auth.cc
      (run): Make sure cred_delete and stop are always called, and
      always called once only.

commit f1b871be896e5f087a891345a419b1d30d5937bd
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 14:39:21 2006 +0000

    * sbuild/sbuild-run-parts.cc (run_child): Add child exit status
      debugging output.

commit a0e3ca3c1f72ddfbf15ada80ad95f966050ecd33
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 14:00:38 2006 +0000

    * Don't translate program usage messages before the locale and
      gettext have been initialised.

commit aa6aaf52d5153e59f13e2d3d39afd5ffde2f72a3
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 12:42:05 2006 +0000

    * Sync translations.

commit d64002d068ccf55e56e3509536d81e15cf4a1b88
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 11:53:45 2006 +0000

    * NEWS: Document SIGTERM behaviour.
    * sbuild/sbuild-session.cc
      (set_signal_handler): New method for use by set_sighup_handler and
      set_sigterm_handler.
      (clear_signal_handler): New method for use by clear_sighup_handler
      and clear_sigterm_handler.
      (set_sighup_handler): Use set_signal_handler.
      (clear_sighup_handler): Use clear_signal_handler.
      (set_sigterm_handler): New method.
      (clear_sigterm_handler): New method.
    * sbuild/sbuild-session.h: Rename saved_signals member to
      saved_sighup_signal, and add a saved_sigterm_signal member.

commit ff39eafffaf259f1c9231fa8c3122e6ce6e8421f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 10:44:55 2006 +0000

    * sbuild/sbuild-auth-conv-tty.cc (conversation): Log using
      standard log functions rather than using std::cerr.

commit a6bb854a0e5c6cac10d1fb686631b68981d865a3
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 10:40:24 2006 +0000

    * sbuild/sbuild-log.cc: Add translator comments, and mark up log
      abbreviations for translation.

commit 3f50e414d7e7b2830a6d8a033467ae397fe1af34
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 20 10:34:37 2006 +0000

    * TODO: Remove completed item.
    * Added a number of debugging messages to important codepaths.

commit 229e04da679958e9bdde7c4fad747b20ed7a0cc6
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 21:55:52 2006 +0000

    * po/vi.po: Restore unmaintained translation, but leave out of
      LINGUAS.

commit 817d495d4d364c5663cfe1f79b65a1fb31452789
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 21:51:37 2006 +0000

    * po/sv.po: Update Swedish translation.

commit 05364eed81e7b10d6b3b1bb3fe6cea900ea14e7d
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 21:41:18 2006 +0000

    * po/en_GB.po: Update.
    * Add translator comments for ellipsis (...) in translatable
      strings.

commit f04801392a6f5b04cac74f90292d1a059f246440
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 21:15:34 2006 +0000

    * debian/changelog: Close #378469.

commit a84e759aa9bf28a50a18499a998febada23c174f
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 21:12:55 2006 +0000

    * NEWS: Document terminal state save and restore behaviour.
    * sbuild/sbuild-session.cc
      (save_termios): New method.  Save terminal state.
      (restore_termios): New method.  Restore terminal state.
      (run_impl): Save and restore terminal state between opening and
      closing the session.
    * sbuild/sbuild-session.h: Add saved_termios and termios_ok
      members.
    * schroot/schroot-base-main.cc (run): Remove termios save and
      restore.

commit 37088c75ea49f7468381c2387f310a01d65e5337
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 19 15:15:33 2006 +0000

    * po/LINGUAS: Remove vi.
    * po/vi.po: Remove currently unmaintained translation.
    * po/en_GB.po: Update
    * Add translation comments documenting all format string arguments
      before all translatable strings with %n% format modifers.

commit 5194c80dc80fbd2a6d059d59c96667c478c5fb81
Author: Luk Claes <luk@debian.org>
Date:   Tue Jul 18 13:54:02 2006 +0000

    Updated Swedish translation

commit fd1cf0a27a7cc10e7c22965ba8524d38bd932dc6
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 20:30:23 2006 +0000

    * dchroot/dchroot.1.in, dchroot-dsa/dchroot-dsa.1.in: Remove
      accidentally committed SVN conflict markers.

commit f232526591ee9239f99445d287bf8082703ffde1
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 19:10:47 2006 +0000

    * Update translation.

commit 2ebb9a2780187a8338167ef8dd8ab90b58c51fea
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 19:10:20 2006 +0000

    * sbuild/sbuild-auth-conv-tty.cc
      (get_delay): Fix incorrectly named function call.

commit 73d2e7bfd85c344942f1b7a607767a848111847a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 18:15:05 2006 +0000

    * TODO: Remove completed item.
    * po/en_GB.po: Update translation.

commit 65b83de7ff0ad77b4c78da2450a5b7abca6187c6
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 18:07:10 2006 +0000

    * Use log_exception_error and log_exception_error in place of
      log_error and log_warning.

commit 5bb5c33a7e5d82f12cb04ec94e97cc7b807b9ff3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 18:00:58 2006 +0000

    * NEWS: Document stricter duplicate checking, and improved error
      reporting.
    * dchroot/dchroot-chroot-config.cc,
      dchroot-dsa/dchroot-dsa-chroot-config.cc: Duplicate chroot names
      are treated as an error.
    * sbuild/sbuild-keyfile.h: Use log_exception_warning in place of
      log_warning.
      (operator >>): Duplicate groups and keys within groups are an
      error.
    * dchroot/dchroot-session-base.cc
      (run_impl): Use arguments with USER_SWITCH.
    * sbuild/sbuild-session.cc: Add format arguments to USER_SWITCH
      error code.
    * sbuild/sbuild-custom-error.h: Add two additional constructors
      with two context arguments.

commit 530a5f192ffefbd165f58dda9243266abe707b08
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 15:39:00 2006 +0000

    * schroot/schroot-main-base.cc: Add error code enum and string
      map.
      (run_impl): Throw custom exception using new error codes.
    * configure.ac (PACKAGE_LOCALSTATE_DIR): Remove trailing /.

commit 298eed07a5fbb58ba70d37a3221ef3a72d3fd230
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 14:16:13 2006 +0000

    * schroot/schroot-listmounts-main.cc: Add error code enum and
      string map.
      (list_mounts): Throw custom exception using new error codes.

commit a9eecf5063ba316caa29b7d475c424aa58e4b4da
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 14:15:23 2006 +0000

    * schroot/schroot-listmounts-main.cc: Add error code enum and
      string map.
      (list_mounts): Throw custom exception using new error codes.

commit 18585eeec60c161e2e7890255695cc2870276ee4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 14:01:39 2006 +0000

    * test/sbuild-personality.cc: Add tests for stream operators.

commit 7b5831f90bae08d55c118e5df519d4cbb3c4c887
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 13:04:22 2006 +0000

    * sbuild/sbuild-lock.cc: Rename _RELEASE error codes to _UNLOCK
      and reword error messages to be uniform with chroot error
      messages.
    * sbuild/sbuild-chroot-config.cc: Rename CHROOT error to
      CHROOT_NOTFOUND, to reduce ambiguity.

commit 92dc204c1524ade6271f248861adcdf8daac0e81
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 12:49:04 2006 +0000

    * sbuild/sbuild-log.cc
      (log_exception_error): Rename from log_exception.

commit 09f45df46518ed734d3ef2070e3ede2cba9b8898
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 12:37:27 2006 +0000

    * Remove redundant emacs local variables use in C++ sources.

commit 0fa4df9a5b530b397a44de704cf3672466da431f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 12:31:35 2006 +0000

    * TODO: Remove completed item.
    * sbuild/sbuild-chroot.cc
      (set_persona): Remove method overloaded for a string.
      (get_keyfile): Use keyfile::set_object_value for the personality.
      (set_keyfile): Use keyfile::get_object_value for the personality.
    * sbuild/sbuild-personality.cc: Add a BAD error code for when the
      personality name is invalid.
      (get_personalities): Renamed from print_personalities.  Create a
      string, rather than printing to an ostream.
    * sbuild/sbuild-personality.h: Add stream input operator, to set
      the personality from a stream.
    * sbuild/sbuild-keyfile.h: Move all logic in get_object_value into
      the try block, to catch and report parse errors in T parsing.

commit 71037d2c588b65c7c79faf9fd4383afce03ef82a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 11:40:55 2006 +0000

    * dchroot/dchroot.1.in, dchroot-dsa/dchroot-dsa.1.in: Use "users"
      instead of "user list", so that the user list name matches the
      keyfile key name used in error messages.
    * dchroot/dchroot-chroot-config.cc,
      dchroot-dsa/dchroot-dsa-chroot-config.cc (parse_data): A missing
      location is no longer an error (it gets reported with greater
      detail when adding the keyfile).
    * sbuild/sbuild-keyfile.cc: Add additional error code for missing
      required key with no line information.
      (check_priority): Report line information for missing required key
      (when available).

commit 4b4089bd07ff11dfada9ebcfb05855fdda3a8cd2
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 10:43:28 2006 +0000

    * sbuild/sbuild-chroot-config.cc
      (add): Clean up error handling, and report config file line
      number, group and key details.  A keyfile is passed as an
      argument, to provide context for error details.
      (load_keyfile): Pass keyfile as context when calling add.
    * sbuild/sbuild-auth.cc
      (authenticate): Authorisation failure information is set as an
      exception reason.
    * sbuild/sbuild-keyfile.cc: Add additional error codes for
      passthrough, and deprecated and obsolete key warnings.
      (check_priority): Use error codes and exception reasons rather
      than hand-formatted error messages.
    * sbuild/sbuild-session.cc
      (wait_for_child): Tidy termination message.
    * sbuild/sbuild-log.cc
      (log_exception_warning): New method.  This behaves exactly the
      same as log_exception, but uses log_warning rather than log_error.

commit 955eb60194ef14951ce655904bb3ae9b598c2770
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 17 09:59:28 2006 +0000

    * dchroot/dchroot-chroot-config.cc,
      dchroot-dsa/dchroot-dsa-chroot-config.cc
      (parse_data): Instead of creating a chroot and adding it, create a
      keyfile and load it.  This will allow accurate parse errors,
      including line numbers.
    * sbuild/sbuild-chroot-config.cc
      (load_keyfile): New method, split from parse_data.  This allows
      keyfile loaded in derived classes.
    * sbuild/sbuild-keyfile.h: Methods to set values with line numbers
      are now public, for use in dchroot.  Added method to set a list
      value with a line number.

commit ba465d3e9debccade3670948ab4615fd7f3c735b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 16 20:53:24 2006 +0000

    * schroot/schroot.1.in: Use -p rather than -d in the description,
      and remove incorrect directory fallback description.  Thanks to
      Matthew Foulkes for reporting this.

commit d2baa3be8ab80f6102aa905530e962dc24d29d39
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 16 20:46:22 2006 +0000

    * TODO: Remove completed items.
    * All code logging exceptions with log_error() and e.what() use
      log_exception.
    * sbuild/sbuild-auth.cc (auth_conv_hook): In the PAM conversation
      hook, catch and handle any exception thrown by a conversation
      handler.
    * sbuild/sbuild-auth-conv-tty.cc (conversation): Rather than
      returning false on error, throw an exception.  Remove exception
      catching logic; it's now handled in sbuild::auth.
    * sbuild/sbuild-auth-conv.h (conversation): Rather than returning
      false on error, throw an exception.
    * sbuild/sbuild-log.(cc|h) (log_exception): New function.  This
      helper function outputs an exception using log_error(), and
      exception reasons using log_info().
    * sbuild/sbuild-parse-error.h: All constructors add a call for
      format_reason in addition to format_detail.  All detail arguments
      are templated rather than strings (to allow use of exceptions as
      detail).
    * sbuild/sbuild-custom-error.h: All constructors add a call for
      format_reason in addition to format_detail.
    * sbuild/sbuild-error.h, sbuild/sbuild-error.tcc: Add error_base
      class.  This contains a reason string with a why() method in
      addition to the what() method provided by std::exception.  error<>
      derives from error_base, and provides a format_reason helper with
      similar behaviour to format_detail.  Both format_detail and
      format_reason contain templated helper classes to allow conversion
      of exceptions of any type, and the transfer of their reason (if
      any).
    * configure.ac: Add check for boost/type_traits.hpp.

commit 88512922f86f8381b5fdeec0e10497653371d042
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 16 11:48:41 2006 +0000

    * schroot/schroot.1.in, dchroot/dchroot.1.in,
      dchroot-dsa/dchroot-dsa.1.in: Add all options to the synopsis
      section.

commit 37a558001bb5d2857883ca93effb4a7b2fdb722e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 15 11:49:03 2006 +0000

    * debian/changelog, debian/rules: Fix problem in config.status rule.

commit ed7fdb3b137519ac7f483bf5567e51effa5b04b4
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 20:09:52 2006 +0000

    * debian/changelog: Bump version to 0.99.4.
    * NEWS: Bump version to 0.99.4.
    * configure.ac: Bump version to 0.99.4.

commit e15a9b14e94d066f8d142dd8c2532cb438acb140
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 18:28:47 2006 +0000

    * Version 0.99.3
    * debian/changelog: Finalise for 0.99.3.
    * schroot/schroot-releaselock-main.cc: Fix typo.

commit 43e00716d98f586a8b46e76a6704c8ad5bb368c7
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 17:22:13 2006 +0000

    * HACKING: Document manual chroot fallback testing.

commit 1cf66ca699e02a1ed1cd148fa765be27f4c3d438
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 17:05:35 2006 +0000

    * TODO: Add remaining items for 1.0.

commit 825c9256919da8bc348341becbab2e0de865208e
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 16:59:32 2006 +0000

    * sbuild/sbuild-null.h: Remove completed TODO item.

commit 5e62a5f1de8cbb48938635d6257e181c8d558a61
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 16:53:56 2006 +0000

    * TODO: Remove completed item.
    * schroot/schroot.conf.5.in: Add undocumented features.
    * schroot/schroot.conf: Add undocumented features.

commit a5fd05b39af3f01405b70d5d2893f11d14882c50
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 16:36:03 2006 +0000

    * TODO: Remove completed item.
    * THANKS: Add Simon Richter.
    * sbuild/sbuild-session.cc
      (run_impl): Move session opening and closing here.  The session is
      opened and closed outside the chroot as root.

commit aef1db086cd26ea06e3860500f1e15d51d45be5f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 15:25:10 2006 +0000

    * TODO: Remove completed item.
    * Update doxygen API reference.

commit ea58dc0f8c331bbbe4a05e7a7bc09e11c0a65191
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 14:15:59 2006 +0000

    * schroot/schroot-base-main.cc
      (run): Return rather than calling exit.

commit 54bf7cc5b43debfe753d8c9a81cdb81395102fdc
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 13:45:17 2006 +0000

    * debian/changelog: Close #378152.
    * Having a single exit point now means terminal settings are
      always restored correctly.
    * sbuild/sbuild-run-parts.cc: Use _exit rather than exit when
      terminating a child process when execve has failed.
    * sbuild/sbuild-session.cc: Use _exit rather than exit when
      terminating a child process when execve has failed.
    * schroot/schroot-releaselock-main.(cc|h): Add error_code enum and
      error typedef for sbuild::custom_error.  Throw error in place of
      exiting with EXIT_FAILURE.
    * schroot/schroot-main-base.(cc|h): Add error_code enum and error
      typedef for sbuild::custom_error.  Throw error in place of exiting
      with EXIT_FAILURE.  Don't ever exit successfully; return a success
      status.
    * schroot/schroot-base-main.cc (run): Don't catch "..."; it's
      handled by the main() stubs.

commit 0d2ce8337be58ec29bc1e826292b4b34b55a4114
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 11:43:46 2006 +0000

    * sbuild/sbuild-chroot-directory.cc (setup_env): Remove.
      CHROOT_LOCATION is already set in the parent class.

commit 4aa7580b2788e5ecb8ea1f1cf617e8ed77cdb2ec
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 11:19:20 2006 +0000

    * schroot/schroot.conf.5.in: Minor whitespace cleanup.
    * TODO: Remove completed item.
    * Updated British English translation.
    * Apply quoting style to all sources.
    * HACKING: Document quoting style for format strings.

commit 9d12a82009f5cf8df99a2d6fbc32a5b4dc5fd84f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 10:06:46 2006 +0000

    * HACKING: Document how to build the printed documentation.
    * Makefile.am: Add ps and pdf phony targets.
    * doc/Makefile.am: Add rules to make PS and PDF manuals.

commit 76a889257ca229921c5e0e567a2cf935066d8976
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 14 09:54:28 2006 +0000

    * Update all documentation to use the style guidelines.
    * Makefile.am: Distribute HACKING.
    * HACKING: New file.  Document manual page style guidelines.

commit e94905fe0d5873a95a04050080ef4536588f2806
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 20:42:08 2006 +0000

    * Update sources to use new header.
    * sbuild/Makefile.am: Add sbuild-null.(cc|h).
    * sbuild/sbuild-null.(cc|h): New file.  Split out null class from
      sbuild/sbuild-error.h

commit 0c9747705eb6a43a5a8c7d9bb5a4eb3f771d3063
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 19:07:16 2006 +0000

    * TODO: Remove completed error string markup item.
    * Add boost::format markup to error strings.
    * sbuild/sbuild-custom-error.h: All constructor detail arguments
      are now templated.  Add additional constructors for multiple detail
      arguments.

commit b4aff3546d8e3f93d8595382e1736ec0fabc55ce
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 17:26:40 2006 +0000

    * sbuild/sbuild-chroot.h: API documentation corrections.
    * sbuild/sbuild-chroot.cc
      (set_persona): New overloaded function to set the personality by
      name.
      (set_keyfile): Set the personality using
      keyfile::get_object_value.

commit 8a8431f22e9bba8ca4edb9a48b66f6fa3c482010
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 16:46:32 2006 +0000

    * All sources use error<> in place of custom_error_base<>, and
      std::runtime_error in place of runtime_error.
    * sbuild/sbuild-error.tcc: Renamed from sbuild-custom-error.tcc.
    * sbuild/sbuild-error.h: Remove runtime_error.  Move
      custom_error_base from sbuild/custom-error.h and rename to error.

commit 312e971288ebb23542fdb4c6d859b3152aa043bb
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 15:47:02 2006 +0000

    * test/sbuild-parse-value.cc: Use sbuild::parse_value_error in
      place of sbuild::parse_error.
    * dchroot/dchroot-chroot-config.cc,
      dchroot-dsa/dchroot-dsa-chroot-config.cc: Use
      sbuild::keyfile::error in place of sbuild::parse_error.
    * sbuild/sbuild-environment.cc: Use parse_value_error in place of
      parse_error.
    * sbuild/sbuild-keyfile.cc: Add error strings.  Use error in place
      of parse_error.
    * sbuild/sbuild-keyfile.h: Add error_code enum and error typedef
      specialisation of parse_error<>.  Use error and parse_value_error
      in place of parse_error.  Include line numbers in all exceptions
      where a line number is available.
    * sbuild/sbuild-parse-value.cc: Add parse_value_error error
      strings.  Use parse_value_error in place of parse_error.
    * sbuild/sbuild-parse-value.h: Add parse_value_error_code enum and
      parse_value_error typedef specialisation of parse_error<>.  Use
      parse_value_error in place of parse_error.
    * sbuild/sbuild-custom-error.tcc: format_error methods are inline.
    * sbuild/sbuild-custom-error.h: format_error methods are static.
      Remove commented-out typedef.
    * sbuild/sbuild-parse-error.cc: Remove.
    * sbuild/sbuild-parse-error.h: parse_error is now a templated
      class, derived from custom_error_base<>.
      custom_error_base<>::format_error is used for all formatting.
      Methods for passing through exceptions of different types have
      been added.

commit cf64068434ab44739d15ad4e667266e27b737ca5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 13 12:30:10 2006 +0000

    * debian/changelog: Close #378028.
    * dchroot/dchroot.1.in: Document command option syntax.
    * NEWS: Document dchroot command option syntax.
    * dchroot/dchroot-session.cc
      (get_user_command): Concatenate all command options into a single
      command, separated by spaces.
    * dchroot/dchroot-options.cc
      (check_options): Allow any number of command options.

commit aeaed4f931873981202e00f979f3204409eb3c04
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 12 21:58:30 2006 +0000

    * All sources defining a custom_error<>::error_strings map define
      a custom_error_base<>::error_strings map instead.
    * sbuild/sbuild-custom-error.h: Split custom_error formatting
      functions, typedefs and static members into a custom_error_base
      class.

commit f0e7e789c843172b6a922ae8d3d0a04cfe12405f
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 12 17:35:51 2006 +0000

    * sbuild/sbuild-custom-error.tcc
      (format_error): Add a third context argument, for use with keyfile
      errors.

commit b5829904d3702382dc61b6ac0e7a7c8cfa164647
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 12 16:36:32 2006 +0000

    * sbuild/sbuild-custom-error.tcc
      (format_error): Never pass more arguments than the format string
      specifies.

commit 0cd0dfc91aceacc4a7ffe4518064ba43dbffa4b1
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 12 15:28:01 2006 +0000

    * sbuild/sbuild-chroot-config.cc
      (load_data): Use new error contructor.
    * sbuild/sbuild-session.cc
      (wait_for_child): Use new error contructor.
    * sbuild/sbuild-custom-error.tcc
      (format_error): Replace all overloaded functions with two
      variants, one for an error_type enum, one for an exception (for
      rethrowing an exception of a different type).
    * sbuild/sbuild-custom-error.h: Add new custom_error<>::null
      class, used to represent an absent context or detail item in an
      error.  Add two new constructors for rethrowing exceptions.

commit cf6ce41a8d79ac7d0e867dd23302bc38cd3415ee
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jul 12 12:44:23 2006 +0000

    * All sources use strerror(errno) in place of errno when creating
      a custom_error<>.
    * sbuild/sbuild-custom-error.h: Remove all constructors with
      integer errno arguments.

commit 4d0205895746a2f91f5958b68efda89f2807db0e
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 17:23:47 2006 +0000

    * debian/rules: Build in debian/build using VPATH.
    * debian/changelog: Add VPATH build.

commit 33b3407a8acbe703ee83fa2c14d7c75e3498a7eb
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 16:58:47 2006 +0000

    * All Makefile.ams: include global.mk.
    * scripts/global.mk: New file.  Global Makefile options.

commit 2c7c2100392428855b003f8c002a5896665623cb
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 16:58:27 2006 +0000

    * All Makefile.ams: include global.mk.
    * scripts/global.mk: New file.  Global Makefile options.

commit 1828e5c4d831d24377315e64e8ee7a016700e8a2
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 13:09:09 2006 +0000

    * Don't include <syslog.h> in sources not using syslog.

commit 11a805ae5703fba095e8588c502a3584da4ea474
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 13:00:29 2006 +0000

    * schroot/schroot-main-base.cc (run_impl): Remove code duplicated
      in schroot_base::main::run (termios saving and restoring, and
      exception handling).

commit 09bbf4e36ba644f4004162754c164d79229bf587
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 11:21:28 2006 +0000

    * debian/rules: Install upstream changelog.

commit 264c05b99a656344fd3f63efc03750dc9ae5a595
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 10 10:47:51 2006 +0000

    * debian/schroot.docs: Add the contents of debian/docs.
    * debian/docs: Remove.
    * debian/rules: The /usr/share/doc directories for dchroot and
      dchroot-dsa are symlinks to schroot.
    * debian/dchroot.preinst: New file.  Remove /usr/share/doc/dchroot.
    * debian/dchroot-dsa.preinst: New file.  Remove /usr/share/doc/dchroot-dsa.
    * debian/changelog: Update.

commit cffa08d3863fe8cac865188806f6fa6429401103
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 9 19:46:48 2006 +0000

    * NEWS: Document the new "directory" chroot type.
    * schroot/schroot.conf.5.in, schroot/schroot-setup.5.in: Document
      new "directory" chroot type.
    * schroot/setup/00check, schroot/setup/10mount,
      schroot/setup/00check: Add logic for "directory" CHROOT_TYPE.  The
      "directory" type will mount the chroot location with --rbind, like
      "plain", but will additionally mount filesystems like all other
      chroot types.
    * sbuild/Makefile.am: Add sbuild-chroot-directory.(cc|h).
    * sbuild/sbuild-chroot.cc (create): Add support for the
      "directory" chroot type.
    * sbuild/sbuild-chroot-plain.(cc|h): chroot_plain derives from
      chroot_directory.  It is exactly the same as directory except for
      the chroot name.
    * sbuild/sbuild-chroot-directory.(cc|h): New files.  The directory
      class is based upon the "plain" chroot type.

commit 8dd0e8dbe44811c0a846a802b8fc75feff110ec2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 8 23:39:29 2006 +0000

    * sbuild/sbuild-dirstream.h: The dirstream extraction operator is
      declared outside the class, in addition to the friend declaration.
      This fixes a compilation error with GCC 4.2.  Thanks to Martin
      Michlmayr for reporting this.
    * debian/changelog: Close #377433.

commit 945fc8bb74493210a63bc7023b1d5e0b042c8681
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 7 18:56:19 2006 +0000

    * test/sbuild-personality.cc: Update test to cope with Linux
      systems building with a personality other than PER_LINUX.

commit c4c53a9ef63c36befd86a2fbdf185c8faeca9c2a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 18:08:40 2006 +0000

    * debian/changelog: Bump version to 0.99.3.
    * NEWS: Bump version to 0.99.3.
    * configure.ac: Bump version to 0.99.3.

commit 8cc55eccfa4926d797e5d6e8395950557890af03
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 17:03:05 2006 +0000

    * Version 0.99.2
    * debian/changelog: Finalise for 0.99.2.

commit 69fda6636c5152398b6f2efced547987ae1d5e2f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 12:41:30 2006 +0000

    * README: Update build dependencies.

commit f8abe8362cfd667d6f641e2a8720dea79f508f02
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 10:10:57 2006 +0000

    * Update translations.

commit 06696c440b07d1bd57715f5def3083e7255172df
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 09:58:02 2006 +0000

    * NEWS: Document new features.

commit bbf57e1e63fb3ee035cdcc5d42bfd02713192542
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 6 09:48:06 2006 +0000

    * test/*.cc: Replace SRCDIR with TESTDATADIR.
    * test/Makefile.am
      (AM_CXXFLAGS): Replace SRCDIR with TESTDATADIR.
      (TESTS): Run setup-test-data and cleanup-test-data at the start
      and end of testing, respectively.
      (EXTRA_DIST): Distribute setup-test-data and cleanup-test-data.
      (clean-local): Run cleanup-test-data.
    * test/cleanup-test-data: New file.  Remove testdata directory.
    * test/setup-test-data: New file.  Copy test data to testdata
      directory and change the ownership to root.

commit ca536ebf73cd63402960465a331b9492e47ee2d0
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 3 22:22:13 2006 +0000

    * debian/changelog: Update build dependencies.

commit 4141ffdf51377b4aacf39fe7e2db34450f179395
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 3 22:21:38 2006 +0000

    * README: Document new Boost build dependency.
    * TODO: Remove completed item.
    * sbuild/sbuild-session.cc
      (setup_chroot): Use sbuild::run_parts in place of run-parts(8).
    * configure.ac: Remove run-parts(8) checks.

commit c82fad09d69d975d0e22a6da088e7a1f0f2e1765
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 3 22:13:32 2006 +0000

    * test/sbuild-run-parts.cc: Add run-parts tests.
    * test/run-parts.ex?: Add run-parts test scripts.
    * configure.ac: Add check for libboost_regex.
    * sbuild/Makefile.am: Add sbuild-run-parts sources.
    * sbuild/sbuild-run-parts.(cc|h): New files.  This class
      reproduces the functionality of run-parts(8).
    * sbuild/sbuild-util.cc (exec): Add (moved from sbuild-session).
    * sbuild/sbuild-session.cc (exec): Remove.

commit 0f0dc432a076db4f74eafb432b6029875227a2f9
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 3 19:46:34 2006 +0000

    * test/sbuild-personality.cc: Sync tests with current personality
      behaviour.
    * test/sbuild-dirstream.cc: Remove unused environment members, and
      an unused header.
    * test/Makefile.am (sbuild_personality_SOURCES): Correct sources.

commit cbb0f1abf6028f8525c4160490bb226bea83dd86
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 1 17:05:38 2006 +0000

    * test/sbuild-dirstream.cc: New file.  Tests for
      sbuild::dirstream.
    * sbuild/sbuild-dirstream.(cc.h): New files.  This class provides
      a "directory stream" interface to the SUS directory functions.

commit 13b7fc6d73facc5d8834967f7b33a875d4053759
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 29 22:35:13 2006 +0000

    * TODO: Remove completed item.
    * sbuild/sbuild-chroot-config.cc
      (parse_data): Remove exception wrapper, now that sbuild::keyfile
      throws exceptions containing more detailed information.
    * sbuild/sbuild-chroot-file.cc
      (get_file_repack, set_file_repack): New methods to get and set
      file repack status.
    * All chroot get_keyfile and set_keyfile methods are implemented
      in terms of the new keyfile::[gs]et_object_(list_)value methods.
    * sbuild/sbuild-keyfile.h: Add templated static methods for
      getting and setting key values and list values using pointers to
      methods of other objects.

commit 4e5a65e7fedf3c0c7651ae00d8a7cabc87c0642f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 29 10:32:22 2006 +0000

    * test/sbuild-keyfile.cc: Add test for getting line numbers.
    * sbuild/sbuild-keyfile.h:
      (item_type, group_type): Add line number to both tuples.
      (set_value): Add overloaded private method which adds a line
      number to its arguments.
      (operator >>): Set line numbers when deserialising.
    * sbuild/sbuild-keyfile.cc
      (get_line): New methods for getting the line numbers of groups and
      keys.
      (set_group): Add overloaded private method which adds a line
      number to its arguments.

commit e8039d25fe67af2f5d6dcdadaf981a78feea9074
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 29 09:52:25 2006 +0000

    * test/sbuild-keyfile.cc: Add test for getting line numbers.
    * sbuild/sbuild-keyfile.h:
      (item_type, group_type): Add line number to both tuples.
      (set_value): Add overloaded private method which adds a line
      number to its arguments.
      (operator >>): Set line numbers when deserialising.
    * sbuild/sbuild-keyfile.cc
      (get_line): New methods for getting the line numbers of groups and
      keys.
      (set_group): Add overloaded private method which adds a line
      number to its arguments.

commit 40050e1152d6767f59a37272f077ce473b544319
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 21:56:35 2006 +0000

    * TODO: Remove completed item.
    * sbuild/sbuild-util.cc (narrow_string, widen_string): Throw a
      runtime_error on conversion failure.

commit d184abf9a17453fd599ed3eab834a8b87ed5326f
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 21:08:28 2006 +0000

    * sbuild/sbuild-auth.cc: Fix switched authentication and
      authorisation messages.

commit 65364a84afa83c15b70b9ca03da171b50e95e719
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 20:57:21 2006 +0000

    * Clean up locale and exception handling in all main stub
      routines.

commit 5e709bb5c9936644e5bf3138b0d418381ba369d0
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 20:55:42 2006 +0000

    * schroot/schroot.1.in, dchroot/dchroot.1.in,
      dchroot-dsa/dchroot-dsa.1.in: Document debug levels.
    * schroot/schroot-base-options.(cc|h)
      (check_options): Check the debug level given with --debug.

commit bec104ffc9ac3fbda9a542a91ec2b4f863f0c3e6
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 20:38:21 2006 +0000

    * Clean up locale and exception handling in all main stub
      routines.

commit a61551c5967e048e6e26ece39e3d266a413483f7
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 20:30:50 2006 +0000

    * TODO: Remove completed items.
    * schroot/schroot-base-main.cc
      (run): This method takes argc and argv arguments, and calls the
      option class parse method.  It also catches and handles parse
      exceptions.
    * schroot/schroot-base-option.cc
      (parse): Renamed from parse_options, this method now takes argc
      and argv as arguments and calls all the other class virtual
      methods to set up and process the options.
      (add_option_group): New virtual method.  The addition of option
      groups is split out from the parse method.
    * All option parsing classes have removed the argc and argv
      arguments from their constructors.  The constructors now no longer
      call any of the virtual methods.

commit 3e84a64f4ba569045edb29f7f4150c5cbbbcc537
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 16:10:33 2006 +0000

    * schroot/schroot-listmounts-options.cc: Add set_action method to
      ensure only one action is specified.
    * schroot/schroot-releaselock-options.cc: Add set_action method to
      ensure only one action is specified.

commit 13511922b743413d774227da2ccb5aaccc2977a0
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 28 13:48:23 2006 +0000

    * dchroot-dsa/dchroot-dsa-main.cc: Use new constructor argmuments,
      and chain up to the new parent class.
    * dchroot-dsa/dchroot-dsa-options.cc: Remove help check, which is
      handled in the base class.  Handle help action in sanity checks.
    * dchroot/dchroot-main.cc: Use new constructor argmuments, and
      chain up to the new parent class.
    * dchroot/dchroot-main-base.(cc|h): Derive from
      schroot::main_base.
    * dchroot/dchroot-options.cc: Remove help check, which is handled
      in the base class.
    * schroot/schroot-main.(cc|h): Derive from main_base.  Remove
      functionality moved to the base class.
    * schroot/schroot-options-base.(cc|h): Derive from
      schroot_base::options.  Remove functionality moved to the base
      class.  Add help action.
    * schroot/schroot-options.cc: Remove help check, which is handled
      in the base class.
    * schroot/schroot-listmounts.cc: Move functionality into
      schroot_listmounts::main.
    * schroot/schroot-listmounts-options.(cc|h): Derive from
      schroot_base::options and implement actions.
    * schroot/schroot-releaselock.cc: Move functionality into
      schroot_releaselock::main.
    * schroot/schroot-releaselock-options.(cc.h): Derive from
      schroot_base::options and implement actions.
    * schroot/Makefile.am: Add schroot_base::main and
      schroot_base::options to a new libschroot-base.la library.
      libschroot and the helper binaries use this base library.
    * schroot/schroot-main-base.(cc|h): New files.  This class
      contains functionality common to all schroot programs (schroot,
      dchroot, dchroot-dsa), split out from schroot/schroot-main.cc.  It
      is derived from schroot_base::main.
    * schroot/schroot-listmounts-main.(cc|h): New files.  This class
      implements the frontend for schroot-listmounts.  It contains logic
      moved from schroot/schroot-listmounts.cc.  It is derived from
      schroot_base::main.
    * schroot/schroot-releaselock-main.(cc|h): New files.  This class
      implements the frontend for schroot-releaselock.  It contains
      logic moved from schroot/schroot-releaselock.cc.  It is derived
      from schroot_base::main.
    * schroot/schroot-base-options.(cc|h): New files.  This class
      implements the functionality common to all options parsing
      classes.
    * schroot/schroot-base-main.(cc|h): New files.  Frontend base for
      schroot programs.  This class is used to "run" schroot programs.
      It contains functionality common to all * programs, such as help
      and version output.

commit 934673faadba1318e191658041656a921e38cf3c
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 21:37:06 2006 +0000

    * sbuild/sbuild-session.cc (is_group_member): Rather than exiting
      with failure status, warn and return false, or throw an exception.

commit c7a6a4a3cdc2bc6fe75a9290c9282e3e6955d5ab
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 21:15:17 2006 +0000

    * debian/schroot.docs: Add.  Include THANKS.

commit e8f864e4103bbc88fde5370d80c5c91fc6aaa015
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 21:13:41 2006 +0000

    * scripts/setperms: New file.  Helper to set binaries setuid root
      for testing.

commit 74c35e06df4fcd4df45193efeb214affc2de3464
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 21:12:16 2006 +0000

    * debian/changelog: Bump version to 0.99.2.
    * NEWS: Bump version to 0.99.2.
    * configure.ac: Bump version to 0.99.2.

commit f11452bf4d2fe977efe2e5cb656a015d5fff498f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 21:10:09 2006 +0000

    * TODO: Add TODO items for 1.0.
    * test/sbuild-keyfile.cc: Update testcases.
    * test/sbuild-parse-value.cc: Update testcases.
    * sbuild/sbuild-environment.h: Use new parse_value syntax.
    * sbuild/sbuild-keyfile.h: Use new parse_value syntax.
      get_list_value now correctly reports parse errors in list values.
    * sbuild/sbuild-parse-value.(cc|h): Convert from a class back into
      separate functions.  This gets rid of annoying uninitialised value
      errors.

commit 8f8ba147677681fa2924de44f5e5f7fc469f4d8a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 11:37:15 2006 +0000

    * Version 0.99.1
    * debian/changelog: Finalise for 0.99.1.
    * sbuild/sbuild-session.cc: Document CHDIR_FB.
    * dchroot-dsa/dchroot-dsa.1.in: Document original dchroot-dsa
      authors.

commit 1a5e36d6450f5fdcca8e1709997ccd578eb4943a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 09:09:15 2006 +0000

    * dchroot-dsa/dchroot-dsa-options.cc
      (check_options): Add check to ensure a chroot must be specified,
      to prevent use of the "default" fallback.

commit a8a77a75a5d07d9d8af363959c8f6b25bfc67115
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 26 08:58:35 2006 +0000

    * dchroot-dsa/dchroot-dsa-options.cc
      (check_options): Add check to ensure a chroot must be specified,
      to prevent use of the "default" fallback.

commit fb12ebaf3221719442e14d066ee5e306cddf7ce5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 21:00:58 2006 +0000

    * Update API reference, fixing a few undocumented members and
      updating the doxygen config file.

commit 59236b1d36e27728e5cea071351effc2c2ceca00
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 18:24:21 2006 +0000

    * debian/changelog: Close #373943.

commit 839589f16faf352ca0de5d935da1365a3c7b5cbf
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 18:13:30 2006 +0000

    * schroot/schroot.cc, dchroot/dchroot.cc,
      dchroot-dsa/dchroot-dsa.cc: On an options parsing error, recommend
      the user use --help.

commit 020c9b388ab0c19d67bdfa50dc1e3b4c22b1c7a7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 17:40:59 2006 +0000

    * All headers using tr1::shared_ptr or tr1::tuple include
      sbuild-tr1types.h.
    * sbuild/sbuild-tr1types.h: New header.  Include tr1 or boost
      shared_ptr and tuple headers into the tr1 namespace.

commit 95ad4b1c53727d58caf4f09d83586544a90af48d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 17:29:08 2006 +0000

    * sbuild/sbuild-session.cc
      (wait_for_child): pid is a pid_t, not int.

commit 6bc0a4b574c0e3a835c3753085c36609cdef1037
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 17:26:28 2006 +0000

    * schroot/schroot-releaselock.cc (print_version): Use gmdate.
    * schroot/schroot-listmounts.cc (print_version): Use gmdate.
    * dchroot/dchroot-main-base.cc
      (action_config): Add current date to header comment.  Print help
      comments only if using dchroot.conf.
    * schroot/schroot-main.cc
      (action_version): Use gmdate.
      (action_config): Add current date to header comment.
    * sbuild/sbuild-types.h (sbuild): Split date into gmdate and date
      clases for UTC and local dates respectively, with a date_base
      class to handle common formatting.

commit d9659b3bbc0a7a7685ea961cbb82c97ea2a89375
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 16:59:11 2006 +0000

    * Remove redundant includes from all headers.

commit 3643cb1b3645e3dd5f239dd273fd264498bf1e29
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 16:50:07 2006 +0000

    * THANKS: Add adeodato, aeb, tbm and vorlon.

commit 8d88b0b0b4665f66587e16db6193e0c0e4b0c350
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 15:31:58 2006 +0000

    * README: Document non-standard configure options.

commit 25935eee413a15dfc6dff1549f47e58ae90d5bad
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 15:28:21 2006 +0000

    * sbuild/sbuild-chroot-lvm-snapshot.cc
      (get_keyfile): Don't save the "lvm-snapshot-device" attribute
      unless the chroot is active.
    * sbuild/sbuild-chroot-file.cc
      (get_keyfile): Don't save the "file-repack" attribute unless the
      chroot is active.

commit d1c0451255bf2713d8014964b5bcc12e9ce6d91b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 14:34:32 2006 +0000

    * sbuild/sbuild-chroot-block-device.cc
      (get_location): Restore
      (set_location): Restore
      (get_keyfile): Restore "location".
      (set_keyfile): Restore "location".  "location" (if specified) must
      be absolute.
    * sbuild/sbuild-chroot-config.cc (print_chroot_config): Don't
      output generated chroots.
    * sbuild/sbuild-chroot-source.cc (clone_source_setup): Set the
      chroot originality to false when cloning.
    * sbuild/sbuild-chroot.(cc|h): Add "original" member, plus getter
      and setter.  This records if the chroot was automatically
      generated or not.  Don't check of "mount-device" is absolute if
      it's empty, since this is optional.

commit f6129f4635829f96a77f2f746dbe7734a7402b68
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jun 25 12:55:50 2006 +0000

    * NEWS: Document strict absolute path checks.
    * sbuild/sbuild-chroot-config.cc
      (parse_data): Catch and report chroot deserialisation errors.
    * sbuild/sbuild-chroot-plain.cc
      (set_keyfile): "location" must be absolute.
    * sbuild/sbuild-chroot-file.cc
      (set_keyfile): "file" must be absolute.
    * sbuild/sbuild-chroot.cc
      (set_keyfile): "mount-device" and "mount-location" must be
      absolute.
    * sbuild/sbuild-chroot-lvm-snapshot.cc
      (set_keyfile): "lvm-snapshot-device" must be absolute.
    * sbuild/sbuild-chroot-block-device.cc
      (get_location): Remove unused function
      (set_location): Remove unused function
      (get_keyfile): Remove "location".
      (set_keyfile): Obsolete "location".  "device" must be absolute.
    * sbuild/sbuild-chroot.h (sbuild): Add DEVICE_ABS, FILE_ABS and
      LOCATION_ABS error codes.
    * sbuild/sbuild-keyfile.cc (check_priority): Add missing break in
      switch.
    * dchroot-dsa/dchroot-dsa-session.cc (get_user_command): Throw a
      COMMAND_ABS error if the command is not absolute.
    * sbuild/sbuild-session.(cc|h): Add a COMMAND_ABS error code.
    * dchroot-dsa/dchroot-dsa-options.cc (check_options): Throw an
      error if the command is not an absolute path.  This optimisation
      means a session is not set up if it is already known it will fail.
    * sbuild/sbuild-util.cc (is_absname): New function.  This checks
      if a path is absolute.

commit 0646350794d79022afe1251d655ea17546392df7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 23:33:25 2006 +0000

    * All derived chroot types: Replace print_details with
      get_details.
    * sbuild/sbuild-chroot.cc
      (get_details): New method to insert the chroot details into a
      format_detail object.
      (print_details): Create, fill and output a format_detail object.
    * sbuild/sbuild-format-detail.(cc|h): Change the class from a
      simple formatting wrapper into a container of key-value pairs for
      formatting.  This uses wide stringstreams to align the output for
      translated UTF-8 text.

commit b1099c144f03beabf92085fd28245885c84068e2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 19:26:02 2006 +0000

    * sbuild/sbuild-util.cc (widen_string, narrow_string): Fix bug in
      conditional which could cause an infinite loop in the C locale.

commit e62d95e0dc28f5218f1993096091af367a6bdab8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 18:23:24 2006 +0000

    * sbuild/sbuild-format-detail.h: Use a wide string to get
      consistent alignment when using a UTF-8 locale.
    * sbuild/sbuild-util.cc
      (widen_string): New function.  Convert a narrow string to a wide
      string.
      (narrow_string): New function.  Convert a wide string to a narrow
      string.

commit 89bae29a6d45262a08f4e6cf5e97c040aba18297
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 14:11:54 2006 +0000

    * README: Add dchroot and dchroot-dsa.
    * schroot/schroot.1.in: Add troubleshooting section.
    * dchroot/dchroot.1.in: Add troubleshooting section.
    * dchroot-dsa/dchroot-dsa.1.in: Add troubleshooting section.

commit ec537b271b56fb913e9d1f0c4b695f27fa3ce6b3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 13:53:55 2006 +0000

    * debian/changelog: Close #374713 and #374887.

commit 5f8b73f710f51016230e44c8d28bb5d9122a12b9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 12:59:13 2006 +0000

    * sbuild/sbuild-session.cc
      (run_chroot): Log error and exit with failure status if run_child
      throws an exception.
      (run_child): Throw exception on failure, rather than exiting,
      which simplifies the error handling.

commit b97cc998631ff98a9a63d5de7adae3623390fbd2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 11:59:57 2006 +0000

    * dchroot/Makefile.am (libdchroot_la_SOURCES): Add
      dchroot-main-base.(cc|h).
    * dchroot-dsa/dchroot-dsa-main.(cc|h): Derive from
      dchroot::main_base, and remove functionality shared with dchroot
      contained in main_base.
    * dchroot/dchroot-main.(cc|h):  Derive from main_base, and remove
      functionality shared with dchroot-dsa contained in main_base.
    * dchroot/dchroot-main-base.(cc|h): New files.  A class containing
      functionality common to the main class of dchroot and dchroot-dsa.

commit a25983a6a7473b3ccd1ec1d90afc40031667ef2c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 11:56:00 2006 +0000

    * sbuild/sbuild-chroot-config.(cc|h): Fix typos.

commit 6dc86f4b33df0b28b13e864b463f3d3d5997016c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 24 11:14:37 2006 +0000

    * sbuild/sbuild-session.(cc|h): Use error codes for logging in
      addition to thrown exceptions.
    * sbuild/sbuild-chroot-config.(cc|h): Use error codes for logging
      in addition to thrown exceptions.

commit 9e983c05f35058ca013ae590455b6d21a11e6760
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 23:39:58 2006 +0000

    * Move sbuild sources into an sbuild subdirectory, dchroot sources
      into a dchroot subdirectory and dchroot-dsa sources into a
      dchroot-dsa subdirectory.

commit 3f95005f6aeb64704634d2bb0a5f33cc0633cfd0
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 22:18:06 2006 +0000

    * The include order of all includes has been reviewed.  Local
      headers are included first to detect missing includes.  C++
      headers are used instead of C headers.
    * All sources include only the headers they need, rather than
      using sbuild.h.
    * schroot/sbuild.h: Remove.
    * schroot/sbuild-types.h: date operator << uses "%b" rather than
      "%B" in the date format string.

commit 9110669386f6146d8d35d62349325c618406f9d5
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 21:01:29 2006 +0000

    * NEWS: Document dchroot compatibility fixes.

commit 66e914423fbe85112045bbdf2ac3efd5cad38fd7
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 20:46:01 2006 +0000

    * schroot/schroot-main.cc, schroot/schroot-listmounts.cc,
      schroot/schroot-releaselock.cc: Add date to version output.
    * schroot/sbuild-types.h: Define a date class to format dates for
      output.
    * bootstrap: Generate m4/schroot_release.m4 with a unix time.
    * scripts/schroot_release.m4.in: Define RELEASE_DATE as a unix
      time.
    * debian/changelog: Update rules.

commit 049b17ab33aeaf512de8a6687a85cdb160f082ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 18:07:43 2006 +0000

    * debian/changelog: Update rules.

commit 3cd0de7c074eb56f34cd42778301dce6011eb17e
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 18:05:10 2006 +0000

    * test/Makefile.am
      (TESTS): Remove sbuild-lock, because it can fail randomly on slow
      or heavily loaded systems due to timing constraints.
    * bootstrap: Create m4 directory if it doesn't exist.
    * Makefile.am
      (dist-hook): Remove junk from distdir such as temorary files.
      (EXTRA_DIST): Distribute bootstrap and m4 macros and templates.
    * configure.ac: Add checks for find and xargs.

commit 9c2042fc4e906e2b578171ead4225fdf51c2afa0
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 15:19:43 2006 +0000

    * API documentation additions.
    * Add @RELEASE_DATE@ in place of hard-coded date in all manual
      pages.
    * configure.ac: Use SCHROOT_RELEASE_DATE.
    * bootstrap: Generate autoconf macro with embedded release date.
    * scripts/schroot_release.m4.in: New file.  Autoconf macro
      template to define release date.

commit 8057c099d470499bf1a6ce7c96d4c6feb8725de9
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 14:42:57 2006 +0000

    * schroot/Makefile.am: Add new files.  Additionally, build
      schroot.la and dchroot.la static libraries to ease linking.
    * schroot/dchroot-options.cc, schroot/dchroot-dsa-options.cc,
      schroot/schroot-options.cc: Remove compatibility setup.
    * schroot/schroot-options-base.(cc|h): Remove compatibility_type
      and compat member.
    * schroot/dchroot-main.(cc|h), schroot/dchroot-dsa-main.(cc|h):
      New files.  These two classes derive from schroot::main, and
      override its virtual methods to customise it for dchroot and
      dchroot-dsa respectively.
    * schroot/schroot-main.(cc|h): New files.  This new class contains
      all the functionality of schroot.cc, but is separated into
      separate methods, which may be overridden in other
      implementations.
    * dchroot.cc, dchroot-dsa.cc, schroot.cc: These files (two new)
      are stubs to instantiate an appropriate main object and run it.
    * schroot.cc: Move all functionality into schroot-main.cc.
    * schroot/schroot.cc, schroot/schroot-listmounts.cc,
      schroot/schroot-releaselock.cc (main): Don't disable debugging
      messages if debugging is disabled.  It defaults to disabled
      anyway, and this prevents --debug from working.

commit c9927df9800f869f94949cb7da1cb39cc7662a04
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 10:31:34 2006 +0000

    * schroot/schroot.cc (main): When running dchroot-dsa, use
      dchroot_dsa::chroot_config instead or dchroot::chroot_config.
    * schroot/dchroot-chroot-config.(cc|h): New class.  Remove
      dchroot-dsa specific parts.
    * schroot/dchroot-dsa-chroot-config.(cc|h): New class.  Split
      dchroot-dsa specific parts from dchroot::chroot_config.

commit bf1828cd734db6806dd4a4e640e6fcd5581de9b3
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 23 09:59:00 2006 +0000

    * schroot/Makefile.am: Build with new headers.
    * schroot/dchroot-session.h: Update API documentation.
    * schroot/schroot.cc: Include the new options headers.  The
      options object is now a tr1::shared_ptr to the base_options
      options base class.
    * schroot/dchroot-dsa-options.(cc|h): dchroot-dsa-specific options
      and parsing logic.
    * schroot/dchroot-options.(cc|h): dchroot-specific options and
      parsing logic.
    * schroot/schroot-options.(cc|h): schroot-specific options and
      parsing logic.
    * schroot/schroot-options-base.(cc|h): New files.  Base class
      containing generic options parsing functionality and common
      options.

commit 185fec4bd6f8f1399af64ecd170f6c6e1dd1b1e5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 22 20:02:01 2006 +0000

    * Update API reference.

commit 2004c42541e12a6accaccc03b6690ec5ea059302
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 22 19:13:44 2006 +0000

    * schroot/schroot.1.in, schroot/dchroot.1.in,
      schroot/dchroot-dsa.1.in: Document differences in command
      arguments and chdir behaviour.

commit 9e93a37f5481a30af0b9482d3b13a022b3ae93dc
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 22 18:48:14 2006 +0000

    * schroot/schroot-options.cc: Add a --debug option to enable
      debugging messages.
    * schroot/Makefile.am
      (dchroot_SOURCES): Add dchroot-session-base.(cc|h).
      (dchroot_dsa_SOURCES): Add dchroot-session-base.(cc|h).  Use
      dchroot-dsa-session.(cc|h) instead of dchroot-session.(cc|h).
    * schroot/dchroot-dsa-session.(cc|h): New class, based upon
      dchroot::session and derived from dchroot::session_base.  Remove
      specialisations for dchroot.
    * schroot/dchroot-session.(cc|h): Derive from
      dchroot::session_base.  Remove specialisations for dchroot-dsa.
    * schroot/dchroot-session-base.(cc|h): New class, split from
      dchroot::session.  It includes functionality common to dchroot and
      dchroot-dsa sessions, as well as recording a compatibility state
      which influences session behaviour depending on whether
      dchroot.conf or schroot.conf are used.
    * schroot/schroot.cc: When building for dchroot-dsa, include the
      dchroot-dsa-session.h header.
      (main): When building for dchroot-dsa, create a
      dchroot_dsa::session session.  dchroot-dsa and dchroot sessions
      include a compatibility mode as a fifth argument.
    * schroot/sbuild-session.cc
      (get_login_command, get_user_command): Split the two parts of
      get_command into separate protected virtual methods, so that they
      may be independently overridden and chained up to by derived
      session types.
      (run_child): When reporting an exec error, use filename rather
      than argv[0], which may differ for login shells.

commit 8f50f68a93848f347a95ea734640edb1d63c9e98
Author: Luk Claes <luk@debian.org>
Date:   Thu Jun 22 16:58:11 2006 +0000

    updated po/vi.po

commit 243dc71cf5f0af37dbf2b4e87b98d9f9f50083f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 22 16:20:08 2006 +0000

    * schroot/schroot-options.cc: dchroot and dchroot-dsa only permit
      a single command option.
    * schroot/dchroot-session.cc
      (get_login_directories): New virtual method.  For dchroot, use the
      home directory and then / if not preserving the environment,
      otherwise use the current working directory and /.  For
      dchroot-dsa, always use the home directory and then /.
      (get_command_directories): New virtual method.  This simply wraps
      get_login_directories; dchroot and dchroot-dsa do not distinguish
      between these two use cases.
      (get_command): When running a login shell, this behaves similarly
      to sbuild::session::get_command.  When running a command, dchroot
      runs "sh -c command", and dchroot-dsa runs "command".
    * schroot/sbuild-session.cc
      (getcwd): New utility function, split out from run_child.
      (get_login_directories): New protected virtual method.  Get a list
      of directories to use (including fallbacks) when running a login
      shell.  Use the current working directory, $HOME, passwd pw_dir
      and / in that order.
      (get_command_directories): New protected virtual method.  Get a
      list of directories to use (including fallbacks) when running a
      command.  This is currently only the current working directory;
      there are no fallbacks.
      (get_shell): New protected virtual method.  Get the program to run
      as a shell, falling back to /bin/sh if unavailable.
      (get_command): New protected virtual method.  Get the parameters
      for calling exec with (file and argv).
      (run_child): Use the new functions and methods getcwd,
      get_login_directories, get_command_directories, get_shell and
      get_command.  Handle directory fallbacks when changing directory
      inside the chroot.
      (run_chroot): If debugging is enabled, automatically set the debug
      level to DEBUG_NOTICE.
    * schroot/sbuild-session.h (sbuild): New protected member cwd, to
      hold the current directory before entering the chroot.

commit 49dd197c284311215c202ce3be9b3d6130acaebc
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 20:06:44 2006 +0000

    * schroot/sbuild-chroot-file.h: Remove dangerous TODO item.
    * schroot/sbuild-keyfile.h: Remove completed TODO item.
    * NEWS: Document dchroot-dsa and new user access controls.

commit 230ff00d087705dac64ecba802ec3a7dc6b13e10
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 19:57:54 2006 +0000

    * schroot/schroot.cc (program_name): For safety, return a string
      if the enum is invalid.
    * schroot/sbuild-chroot-config.cc, schroot/sbuild-parse-error.cc:
      Reindent and capitalise translatable error strings.
    * schroot/sbuild-chroot.cc, schroot/sbuild-chroot-source.cc,
      schroot/schroot-options.cc, schroot/schroot-listmounts-options.cc
      schroot/schroot-releaselock-options.cc: Remove whitespace from
      translatable strings.
    * schroot/sbuild-format-detail.h: Ensure that some whitespace
      always separates name and value, even when the name is over 21
      characters.

commit 5a338318a349900945a2e7612b7d789c730f7780
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 18:15:06 2006 +0000

    * schroot/schroot.1.in: Document users and root-users.
    * schroot/schroot.conf.5.in: Document "users", "root-users",
      "source-users" and "source-root-users" keys.
    * schroot/schroot.cc (main): Fix generated schroot.conf header to
      document users and root-users.
    * schroot/dchroot-session.cc (get_chroot_auth_status): New method
      to replace get_auth_status.  This overrides the sbuild::session
      implementation to provide the correct authorisation checks for
      dchroot and dchroot-dsa.
    * schroot/dchroot-chroot-config.cc (parse_data): Set users rather
      than groups for dchroot-dsa allowed user list.
    * schroot/sbuild-chroot-source.cc: Save and restore source-users
      and source-root-users keyfile keys.
    * schroot/sbuild-chroot-source.h: Add source_users and
      source_root_users members and methods.
    * schroot/sbuild-chroot.cc: Save and restore source-users
      and source-root-users keyfile keys.
    * schroot/sbuild-chroot.h: Add users and root_users members and
      methods.
    * schroot/sbuild-session.cc (get_chroot_auth_status): New
      protected virtual function.  The chroot authorisation checks have
      been split out from get_auth_status for reuse in derived classes.

commit 329598588b361ee1422c36cee66341274959761c
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 15:14:37 2006 +0000

    * debian/rules: Enable dchroot-dsa when running configure.
    * debian/dchroot-dsa.lintian-overrides: Use correct package name.

commit 11d4a2a6f84ff1b896458a00d09c1374763f1ff2
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 12:47:04 2006 +0000

    * schroot/Makefile.am: Install dchroot-dsa setuid root.

commit 683b7e29285461aae052575e4d8215b4bfcdf9f8
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 12:46:11 2006 +0000

    * debian/changelog: Add dchroot-dsa package.

commit 0ae83ca04b9cad527746f6cece6dffb7cc856e89
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 21 12:36:01 2006 +0000

    * configure.ac: Define and substiture DCHROOT_CONF.  Generate
      dchroot-dsa man page.
    * schroot/Makefile.am: Add dchroot-dsa man page.
    * schroot/dchroot-dsa.1.in: New file.  Document dchroot-dsa.
    * schroot/dchroot.1.in: Update documentation now dchroot is the
      official dchroot package, and fix up minor formatting errors.
      Document the --chroot option.  Use @DCHROOT_CONF@ in place of
      /etc/dchroot.conf.
    * schroot/schroot.cc: Don't hard-code DCHROOT_CONF.
      (program_name): New function to get program name.
      (print_version): Use program_name.
      (main): Use new options::compat.  Add support for dchroot-dsa.
    * schroot/dchroot-chroot-config.cc
      (parse_data): When used by dchroot-dsa, extend the available
      whitespace characters to " \t:;,", parse the third field as a user
      list, and add to the chroot group list.  dchroot-dsa chroots don't
      set the "default" chroot alias.
    * schroot/dchroot-session.cc
      (get_auth_status): Add user checks for dchroot-dsa.
    * schroot/schroot-options.cc: Use compat to adapt to selected
      compatibility mode, in place of dchroot_compat.  Add
      specialisations for dchroot-dsa.
    * schroot/schroot-options.h: Add compatibility_type enum
      (for schroot, dchroot and dchroot-dsa).  Add compat member to
      store current compatibility mode, in place of dchroot_compat.
    * schroot/sbuild-session.h: get_config returns a const reference.
    * test/sbuild-util.cc: Update test for split_string.
    * schroot/sbuild-keyfile.h: Use new split_string argument type.
    * schroot/sbuild-util.h: split_string uses a string as a list of
      separators, instead of a single character.

commit 55350242f5d8c712140284183ab82abd442a70e0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 20:30:31 2006 +0000

    * schroot/Makefile.am: Add rules for dchroot-dsa.
    * configure.ac: Add enable option for dchroot-dsa.

commit dd3f40694c5b757c50db2697a40bf406a7561ce8
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 20:05:15 2006 +0000

    * Update translations.

commit 1d775b978b91c1b7c22bef6d3c05a4fcf16dadbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 19:59:55 2006 +0000

    * schroot/sbuild-error.h: Remove runtime_error_custom.
    * schroot/sbuild-custom-error.h: Add virtual destructor.

commit 6f0d263f7af404850b94ea75d15f0f73aab841fb
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 19:58:38 2006 +0000

    * schroot/sbuild-auth-conv.h: Remove error typedef.
    * schroot/sbuild-auth-conv-tty.(cc|h): Use the custom_error
      exception class.

commit 3cd0b7d86f62af6921c15550814df83d2162ce29
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 18:15:13 2006 +0000

    * schroot/sbuild-custom-error.tcc (format_error): detail and error
      arguments were used in the wrong order in the two argument case.
    * schroot/dchroot-chroot-config.cc (parse_data): Use the
      parse_error class.
    * schroot/sbuild-chroot-config.(cc|h): Use the custom_error
      exception class.  Merge check_security with load_data.
      (load_data): Report filename when throwing a parse error.

commit de239f9f3be67a65df577f1d26ab0264b3763a51
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 15:37:59 2006 +0000

    * schroot/sbuild-personality.(cc|h): Use the custom_error
      exception class.

commit 8e9e60284386b4a7f79a58dc813cafd7be9a92e4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 20 15:20:41 2006 +0000

    * schroot/sbuild-session.h: Reindent error codes.
    * schroot/sbuild-lock.(cc|h):Use the custom_error
      exception class.

commit 4d00ff12e62fe154d7051608e8bc492a1b97621f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 19 22:55:01 2006 +0000

    * schroot/sbuild-chroot.(cc|h), schroot/sbuild-chroot-file.cc,
      schroot/sbuild-chroot-block-device.cc,
      schroot/sbuild-chroot-lvm-snapshot.cc: Use the custom_error
      exception class.

commit 3daa1b8089e6c49207a7d974c033f27f67748722
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 19 20:11:13 2006 +0000

    * schroot/sbuild-auth.(cc|h), schroot/sbuild-session.(cc|h),
      schroot/dchroot-session.cc (run_impl): Use new templated exception
      type.
    * schroot/sbuild-session-error.(cc|h): Remove.
    * schroot/sbuild-auth-error.(cc|h): Remove.
    * schroot/sbuild-custom-error.(cc|h): New files, providing an
      exception class templated on an error code enum.  It replaces the
      auth_error and session_error exception classes.

commit fd1d8e8168849b470940f2bd70244ba02263624a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 19 17:07:03 2006 +0000

    * schroot/dchroot-session.cc (run_impl): Throw a session_error in
      place of a runtime_error_custom.
    * schroot/sbuild-session.cc: Throw a session_error in place of a
      runtime_error_custom.  Correct capitalisation of error messages.
      Don't throw an exception when a child exits with a nonzero exit
      status.
    * schroot/sbuild-session.h: Use session_error as the error type.
    * schroot/sbuild-auth.cc: Throw an auth_error in place of a
      runtime_error_custom.
      (pam_strerror): New private method to get a PAM error message.
    * schroot/sbuild-auth.h: Use auth_error as the error type.
    * schroot/Makefile.am: Add sbuild-auth-error.(cc|h) and
      sbuild-session-error.(cc|h).
    * schroot/sbuild-session-error.(cc|h): New files, providing an
      exception class for reporting session errors.
    * schroot/sbuild-auth-error.(cc|h): New files, providing an
      exception class for reporting authentication errors.

commit 976ef05bc9747f1db79669d68026e971fc9d17f0
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 19 16:41:05 2006 +0000

    * schroot/setup/00check: Make sanity check errors more
      descriptive.  Fix check for using / as a chroot location.

commit 7131598e32f0a81915fdd5494f9fceaf47a0f504
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 19 16:34:52 2006 +0000

    * schroot/setup/10mount: Only remove the mount location if it
      exists (to quell a warning).

commit 267001679508f53b3eaf6668d6dffa03b6691bc0
Author: Luk Claes <luk@debian.org>
Date:   Sun Jun 18 15:03:19 2006 +0000

    Updated Swedish translation

commit fbc2ff2b89a4cf4b5eb16283125af6eccf14a872
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 19:36:33 2006 +0000

    * debian/changelog: Bump version to 0.99.1.
    * NEWS: Bump version to 0.99.1.
    * configure.ac: Bump version to 0.99.1.

commit beecc10a5af73f5be0c918dc5f8e826cbb2d89c2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 19:35:56 2006 +0000

    * debian/changelog: Bump version to 0.99.1.
    * NEWS: Bump version to 0.99.1.
    * configure.ac: Bump version to 0.99.1.

commit 947ba6b3af3908102c7d32a6a4b0cf249591db8d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 13:24:52 2006 +0000

    * Version 0.99.0.
    * debian/changelog: Finalise for 0.99.0.
    * NEWS: Document init script changes.

commit 6ec7dcfb9f996cc86dfaa7a8f2bbb0bb58c70662
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 13:14:18 2006 +0000

    * debian/changelog: Tidy up changes for release.
    * debian/schroot.postinst: If upgrading from a version less than
      0.99.0-1, remove the rc.d symlinks, because rcS is used instead of
      the normal runlevels

commit aec9c72d2146a37ec70f1d84f407055c675d4310
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 13:03:53 2006 +0000

    * Update translations.

commit c15ff251bbfe3762134649e157995a3e2a4b6313
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 12:59:48 2006 +0000

    * debian/control: Add Luk Claes as a co-maintainer.

commit 6c7861770228e998d132fc660740922a3ed1bbf1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 17 11:24:00 2006 +0000

    * debian/schroot.README.Debian: Move from debian/README.Debian.
      Remove outdated dchroot bits.
    * debian/schroot.NEWS: New file.  Document the splitting out of
      dchroot.

commit 37bb65a2eb2843e6f6bf7c4ea868720d81efba08
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 16 22:52:09 2006 +0000

    * schroot/schroot.conf.5.in: Remove command-prefix example of
      using linux32, now that the personality option is the recommended
      method of changing personality.

commit 6953a816a6ed7167da702176cd62e416c15c7025
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 15 18:47:16 2006 +0000

    * ChangeLog: Fix two typos.

commit 6b770d2be75663ec92f76e4de5841bd5a35d2ccc
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 15 18:45:22 2006 +0000

    * po/en_GB.po: Update British English translation.

commit 22bbe1109af9fab483fb9887f3a2432299381f4a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 15 18:34:29 2006 +0000

    * po/POTFILES.in: Update list of source files.  Remove all
      headers.

commit 97c411bd2b686200e9aabe53b178a66207014863
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 15 18:32:12 2006 +0000

    * TODO: Remove completed items (translatable strings removed from
      headers, and root no longer needs to be in groups or root groups).
    * schroot/Makefile.am: Add sbuild-format-detail.cc.
    * schroot/sbuild-format-detail.h: Remove ostream operator <<
      format_detail<bool> specialisation.
    * schroot/sbuild-format-detail.cc: New file.  Move ostream
      operator << format_detail<bool> specialisation from the headers,
      so translatable strings are not used in the header.

commit d7f6379eddeabd1b81fb4e17747064a4685ed26b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 15 17:41:43 2006 +0000

    * schroot/Makefile.am" Add sbuild-parse-error.(cc|h).
    * schroot/sbuild-keyfile.cc (keyfile, check_priority) Use
      parse_error instead of runtime_error_custom for throwing on parse
      failures.
    * schroot/sbuild-keyfile.h: Use parse_error instead of
      runtime_error_custom for throwing on parse failures, and also for
      logging warnings.  Additionally, be stricter when parsing by
      throwing a parse error when an empty group is specified, or a key
      before a group definition.
    * schroot/sbuild-parse-value.h: Throw a parse_error when parsing
      fails.
    * schroot/sbuild-parse-error.(cc|h): New files, providing an
      exception class for reporting parse errors.

commit fc8c2c2b2e3c7a4bf6e7a64f370583bdfd66bc48
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 13:09:46 2006 +0000

    * schroot/sbuild-personality.cc
      (personality): On Linux, default to initialising with the current
      process' personality, otherwise initialise to "undefined".
      (get_name): New method.  Return the current personality.
    * schroot/sbuild-personality.h: Document constructors fully, and
      add a get method to get the personality type.

commit 4c6321982d1dc00b5ebd9e8874a48b8cb401efc8
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 13:06:22 2006 +0000

    * debian/changelog: dchroot doesn't need to Replace schroot.

commit 9b88d74aafb76f9413ce32d250bd7993a9592fe6
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 12:56:36 2006 +0000

    * schroot/dchroot.1.in: Document incompatibilities with DSA
      dchroot, and a few minor cleanups.

commit 96207e97a54a2332fbdb0a198ad402c4ef6ff0ee
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 10:14:58 2006 +0000

    Update en_GB strings.

commit c8e917915a762c043a6816927973add5ed02e450
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 10:03:07 2006 +0000

    * Update translations.

commit ff93e912e6fe1db8cc4e89a828bbe5b6f59dc8e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 09:29:42 2006 +0000

    * debian/changelog: Split dchroot into a separate package.

commit 75799342be4273f099444c07951d8ad03b74d49f
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jun 14 08:59:40 2006 +0000

    * schroot/schroot.cc (main): Output configuration file with a help
      message in comments, to help migrating dchroot.conf.

commit 82f37558b80ee36b060b91e49819df0e7d9428ff
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 22:47:18 2006 +0000

    * schroot/Makefile.am
      (install-data-hook): Don't create $(SCHROOT_LOCK_DIR).
    * configure.ac: Remove SCHROOT_LOCK_DIR, which is no longer used
      now we use lockdev and fcntl locking.

commit 45b3518ab8ad1bb44fd72caa9e1cd17dec1fa067
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 20:16:31 2006 +0000

    * debian/changelog: Close #372874.
    * NEWS: Document dchroot.conf change.
    * schroot/dchroot.1.in: Document the new personality field in
      dchroot.conf.
    * schroot/dchroot-chroot-config.cc (parse_data): Parse a third
      optional "personality" field, and if present, set the chroot
      personality.

commit 2dd9e1a4fed75fa825875dbaf596f5d532294d56
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 20:06:18 2006 +0000

    Back out accidentally committed changes.

commit dd435671b5e7183ea86a81042d4c8eecae4cd33d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 20:00:27 2006 +0000

    * debian/changelog: Close #372569.
    * NEWS: Document changed authorisation behaviour.
    * schroot/sbuild-session.cc
      (get_auth_status): If no groups are specified, root can still gain
      access (but still requires authentication).

commit 7efec2a7eca55521682b36fea9ed157ebcd3c712
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 17:22:20 2006 +0000

    * debian/changelog: Close #354344.
    * schroot/setup/10mount: Mount plain chroots with --rbind rather
      than --bind.  This is safe now schroot-listmounts is used to
      unmount all filesystems in the chroot.

commit 87394ce3d72f40beefc608b66c4917c1bb5465f0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 16:33:27 2006 +0000

    * THANKS: New file.  Add Ben Hutchings.

commit c5bee4624cd614bc141aaafcd21108fa10d318ef
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 13 16:32:28 2006 +0000

    * NEWS: Document new "personality" option.
    * po/POTFILES.in: Add schroot/sbuild-personality.(cc|h).
    * test/Makefile.am: Add sbuild-personality.cc.
    * test/sbuild-personality.cc: Tests for sbuild::personality.
    * schroot/schroot.conf.5.in: Document new "personality" key.
    * schroot/Makefile.am: Add sbuild-personality.(cc|h).
    * schroot/sbuild.h: Include sbuild-personality.h.
    * schroot/sbuild-session.cc (run_child): Set the personality
      before chrooting.
    * schroot/sbuild-chroot.cc:
      (chroot) When constructing a chroot, the persona defaults to
      "linux" on Linux systems, and "undefined" on all other systems.
      (get_persona): New method to get the persona.
      (set_persona): New method to set the persona.
      (print_details): Print the persona.
      (get_keyfile): Set "personality" key.
      (set_keyfile): Get "personality" key.
    * schroot/sbuild-chroot.h: Include personality as a persona
      member, and provide a getter and setter for it.
    * schroot/sbuild-personality.(cc|h): New files.  This is a class
      wrapping the functionality of personality(2) for changing the
      process execution domain.  It includes a mapping from names to
      personality enumarations, to allow user specification of
      personalities.

commit 312b98504ec9a9c2ac477dd5820b52299851dde8
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jun 12 10:14:20 2006 +0000

    * debian/changelog: Bump version to 0.99.0.
    * NEWS: Bump version to 0.99.0.
    * configure.ac: Bump version to 0.99.0.

commit 60b92fcbd4fe76af1d032e18f0e537128ab412ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 10 08:52:39 2006 +0000

    * Version 0.2.11.
    * debian/changelog: Update for 0.2.11.

commit c69b6db758efd77993e020a117d6851c046b60e6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 10 08:26:12 2006 +0000

    * schroot/schroot-listmounts-options.h (schroot_listmounts): Fix typo.

commit f2fb2dbdc571d756cd714954c5e15de89b0748f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 10 08:25:16 2006 +0000

    * debian/changelog: Don't package libsbuild.la.
    
    	* schroot/Makefile.am (noinst_LTLIBRARIES): Do not install
    		libsbuild.la.

commit aa3de7de535506af6868732ba663cf1c76d43454
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 10 07:50:53 2006 +0000

    * NEWS: Document that scripts may now fail.
    * schroot/schroot-setup.5.in: Document that scripts must be
      idempotent.

commit ee4484d198f37a94c0904a101703b6b48cfd7cff
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jun 9 21:10:03 2006 +0000

    * po/en_GB.po: Update translation.
    * po/POTFILES.in: Add schroot-listmounts sources.
    * debian/changelog: Close #369626.
    * NEWS: Document 05file and 10mount changes.
    * schroot/setup/05file: Use schroot-listmounts to check if there
      are any mounted filesystems before purging the chroot.
    * schroot/setup/10mount: Use schroot-listmounts to unmount all
      filesystems in a chroot.  Exit with an error if unmounting fails.
    * test/sbuild-chroot.cc: Implement the new form of
      sbuild::chroot::setup_lock().
    * schroot/schroot-listmounts-options.(cc|h): New files.  These are
      the command-line option parser for schroot-listmounts.
    * schroot/schroot-listmounts.cc: New file.  This is a program to
      list all of the mounts under a given mountpoint.
    * schroot/sbuild-session.cc (setup_chroot): Use the chroot lock
      and unlock methods, in place of setup_lock.
    * schroot/sbuild-chroot-plain.cc, schroot/sbuild-chroot-file.cc,
      schroot/sbuild-chroot-block-device.cc,
      schroot/sbuild-chroot-lvm-snapshot.cc: setup_lock only removes the
      session (using setup_session_info) if the setup scripts succeeded.
    * schroot/sbuild-chroot-plain.h, schroot/sbuild-chroot-file.h,
      schroot/sbuild-chroot-block-device.h,
      schroot/sbuild-chroot-lvm-snapshot.h: setup_lock is protected and
      has an additional status argument.
    * schroot/sbuild-chroot.cc
      (lock): New function; calls setup_lock.
      (unlock): New function; calls setup_lock.
    * schroot/sbuild-chroot.h: Replace setup_lock with lock and unlock
      methods.  Unlock takes a status argument which indicates if the
      setup scripts failed or not.  setup_lock is now a protected
      virtual method used by lock and unlock.

commit 4d338d8e7c21d00241287cf41e2a8f21e2efe7e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jun 8 22:04:27 2006 +0000

    * debian/changelog: Close #369633.
    * AUTHORS: Add Andreas Bombe.
    * schroot/schroot.conf.5.in: Correct typo.
    * schroot/schroot.1.in: Correct ambiguity and mistakes in the
      documentation relating to specifying session IDs.

commit 795c0859ce4fd08f55d7eca2b10488ec328e511a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 27 17:04:34 2006 +0000

    * debian/changelog: Update.
    * debian/control (Standards-Version): Update to 3.7.2.

commit b47d0659e5100ef48a9b421482ba2c23185875b3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 27 17:02:00 2006 +0000

    * debian/changelog: Bump version to 0.2.11.
    * NEWS: Bump version to 0.2.11.
    * configure.ac: Bump version to 0.2.11.

commit a6cc0d1a76a53b4a6fd27d2784e58d84a0317f2f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 27 14:08:17 2006 +0000

    * Version 0.2.10.
    * debian/changelog: Update for 0.2.10.

commit 6a2b633f2217a9eaab064d080ee3ea88439644db
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat May 27 12:05:41 2006 +0000

    * schroot/setup/50chrootname: Strip session UUID when writing
      /etc/debian_chroot.

commit 757a2dcc15b80ad477519f72f8bed72dc1a654d0
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon May 15 08:42:42 2006 +0000

    * po/sv.po: Updated translated from the Free Translation Project.

commit 86d34cccff833287aeed32bd51dc64c0e5a116e8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun May 14 21:01:41 2006 +0000

    * schroot/sbuild-chroot-config.cc (add): If a chroot alias is the
      same as the chroot name, don't warn about it, because the effect
      is still unambiguous.

commit 7834a45038201e1d3449918a0a252847e0422ad8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 18:05:25 2006 +0000

    Ignore stamp-h2 and sbuild-config.h.

commit 60f3f3328523c07b1cbe57da897584a450b72d72
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 17:57:45 2006 +0000

    * Remove unused .cvsignore files.

commit 750afceb129a87508b9622189f08fda2db99b0f4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 17:53:48 2006 +0000

    * schroot/schroot.cc: Update documentation.
    * schroot/schroot-releaselock.cc: Update documentation.

commit f4a76e13e1276bd28c1fc5c21406087047d8989d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 14:44:25 2006 +0000

    * debian/control (Standards-Version): Upgrade to 3.7.0.

commit 421a280132c61a0c074625d9d2db1dca9ee7e692
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 14:42:37 2006 +0000

    * configure.ac: Bump version to 0.2.10.
    * NEWS: Bump version to 0.2.10.
    * debian/changelog: Bump version to 0.2.10-1.

commit cc5cc299b93e94dcd1e45a058b4e4b71fa4a49e9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 14:38:30 2006 +0000

    * Makefile.am (dist-hook): Don't distribute .svn directories.

commit 574df56372a8c179f58c7cb1a054cfca674612cd
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 12:53:42 2006 +0000

    * Version 0.2.9.
    * debian/changelog: Update for 0.2.9.
    * po/en_GB.po: Updated British English translation.
    * README: Document new compiler requirements.

commit c4a14fab0b6a0c0ec1b50d9c8db41329f23d7de0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 11:46:10 2006 +0000

    * NEWS: Document directory behaviour.
    * schroot/sbuild-session.cc (run_child): If the current working
      directory does not exist inside the chroot, change to the home
      directory (for login shells), or fail with an error (for commands)
      where the behaviour must be deterministic.

commit 58313671f09e8b9505ca4834bffaa7d3932a0997
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Apr 30 11:40:02 2006 +0000

    * test/sbuild-parse-value.cc: Update tests.
    * schroot/sbuild-keyfile.h (get_value): Catch exceptions thrown by
      parse errors and log a warning.
    * schroot/sbuild-environment.h (get): Catch exceptions thrown by
      parse errors and log a warning.
    * schroot/sbuild-parse-value.cc (parse_value): Add class
      constructor and destructor.
      (parse): Parse functions use this->value rather than a string
      value argument.
    * schroot/sbuild-parse-value.h: Move parse_value functions into
      the generic_value class as private parse methods; the string value
      is taken directly from this->value, rather than passed as an
      argument.  generic_value class renamed to parse_value.  On parse
      failure, an exception is thrown.

commit b1fffa17c3c8268ad1c52bec9d284c2597d527c2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 29 12:05:09 2006 +0000

    * schroot/sbuild-keyfile.h: Update documentation.

commit 5d4e173a750a610e12524abee543bbad70590e93
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 29 11:29:28 2006 +0000

    * TODO: Remove completed file repack item.

commit 65ae9ede8a60c1f98a4fe1e474e721d26bc71395
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 29 11:28:50 2006 +0000

    * test/sbuild-chroot-file.cc (chroot_file>): Check for
      CHROOT_FILE_REPACK in the environment.

commit db0a309f4689d901592c1a88e8a60c06f9402247
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 29 11:20:30 2006 +0000

    * NEWS: Document GCC portability.
    * test/Makefile.am (AM_CXXFLAGS): Remove -Wextra, for GCC 3.3/3.4
      portability.
    * schroot/sbuild-chroot-config.cc (load_data): Construct
      __gnu_cxx::stdio_filebuf appropriately, depending on the required
      construction semantics.
    * schroot/sbuild-chroot.cc (setup_session_info): Construct
      __gnu_cxx::stdio_filebuf appropriately, depending on the required
      construction semantics.
    * configure.ac: Check whether the old (GCC < 3.4) or new (GCC >=
      3.4) __gnu_cxx::stdio_filebuf construction semantics are required,
      for portability to older GCC versions.

commit a0895de24791d0d291a93824b85cfcea5357cc5d
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 26 17:58:36 2006 +0000

    Update translations.

commit f2684d11c180b06ab4bd0b6485af6aab9deb4be9
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 26 17:56:25 2006 +0000

    * schroot/setup/10mount (do_mount) : Create directories for
      mounting filesystems onto if they don't exist.

commit 652debc1e8e1d876b252ec2d0f1b52e5d4e65355
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 26 17:37:30 2006 +0000

    po/POTFILES.in: Add schroot/sbuild-format-detail.h

commit 2cf7906363d848ed386301d2b6d1b4dfbac96827
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Apr 26 17:33:27 2006 +0000

    * GCC 4.2 compatibility fixes.
    * test/sbuild-keyfile.cc (test_set_value): Use iterator ranges,
      rather than whole containers, when calling
      keyfile::set_list_value.
    * schroot/sbuild-chroot-source.cc
      (get_keyfile): Use iterator ranges, rather than whole containers,
      when calling keyfile::set_list_value.
      (set_keyfile): Reindent.
    * schroot/sbuild-chroot.cc
      (get_keyfile): Use iterator ranges, rather than whole containers,
      when calling keyfile::set_list_value.
      (set_keyfile): Reindent.
    * schroot/sbuild-keyfile.h
      (get_list_value): Templated on container type only; the value_type
      is no longer a template parameter.  generic_value is used for the
      type conversion.
      (set_list_value: A range specified by iterators is used, rather
      than the whole container.
    * schroot/sbuild-parse-value.h: Add a new generic_value class to
      wrap type conversions from strings.
    * schroot/sbuild-format-detail.h: Move templated operator<<
      methods outside the class definition.  Make format_details inline.

commit 997cfb988f530939d62de07f49b15a1f9a3263b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 8 16:39:18 2006 +0000

    * schroot/Makefile.am
      (sbuild_public_h_sources): Add sbuild-format-detail.h
    * schroot/sbuild.h: Include sbuild-format-detail.h.
    * schroot/sbuild-chroot.h: Remove sbuild::chroot::format_detail.
    * schroot/sbuild-format-detail.h: New class,
      sbuild::format_detail, moved from sbuild::chroot::format_detail.

commit fb75308aa6685508ec6ba7387cfdaa08640acc26
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Apr 8 15:47:31 2006 +0000

    * schroot/sbuild-keyfile.h: Use Boost if TR1 is not available.
    * schroot/sbuild-chroot.h: Use Boost if TR1 is not available.
    * schroot/sbuild-auth.h: Use Boost if TR1 is not available.
    * schroot/Makefile.am:
      (AM_CXXFLAGS): Remove -Wextra.
      (BUILT_SOURCES): Don't build sbuild.gch.
      (#CLEANFILES): Don't clean sbuild.gch.
      (nodist_libsbuild_la_SOURCES): Add sbuild-config.h.
    * configure.ac: Add a new header, schroot/sbuild-config.h.  Add
      header checks for tr1/memory, boost/shared_ptr.hpp, tr1/tuple and
      boost/tuple/tuple.hpp.

commit 41e8cc37820dd4fd05ff65eb01445b5ae0eb136a
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 7 11:05:45 2006 +0000

    * debian/changelog: Close #361108.
    * debian/README.Debian: Move chroot safety advice to README.

commit a9037df2bb6f4a127cf7863a39a8ed5302ea9f69
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 7 10:57:41 2006 +0000

    * configure.ac: Bump version to 0.2.9.
    * NEWS: Bump version to 0.2.9.
    * debian/changelog: Bump version to 0.2.9-1.

commit c6e2e522ac77a34a230b29c06c86a6cdb3bddb5c
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 7 10:50:40 2006 +0000

    * po/vi.po: Update.

commit a0e4edacd806dc99fdd940bdf62f0528539fd0ad
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Apr 7 10:42:57 2006 +0000

    * po/vi.po: Update.

commit 3c9e267756f73f8d0798e426918cc2d123352a10
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Mar 19 11:56:22 2006 +0000

    * Version 0.2.8.
    * debian/changelog: Update for 0.2.8.

commit a414492fa61cecfb1a5cc409a9059784a67d3d2e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 18 22:29:49 2006 +0000

    * configure.ac: Bump version to 0.2.8.
    * NEWS: Bump version to 0.2.8.
    * debian/changelog: Bump version to 0.2.8-1.

commit 2c87f799d06716ff4d0c601d00d6bdefb4cb8bcc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 18 22:07:25 2006 +0000

    * po/vi.po: Update.
    * po/sv.po: Update.

commit 0134425cf1713aad886fa335fefae19f38ae8f78
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 18 22:05:40 2006 +0000

    Update.

commit abc64cadfc1d062b4782f5e8204be0411d3090d5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Mar 18 22:05:21 2006 +0000

    * schroot/sbuild-session.cc (run_child): Don't fix up argv for a
      login shell if using a command-prefix, since this will not be a
      valid command for command-prefix to execute.

commit 749175f800d89a2afdebaf47b3d902ed1747fd80
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Mar 8 18:05:26 2006 +0000

    * debian/changelog: Version 0.2.7-2, released to fix a dchroot
      crash.
    * schroot/dchroot-session.cc
      (run_impl): Correctly chain up to the base class.

commit 33f7d3f002be186952f35196bb8cf7c3b7927ac8
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Mar 8 13:13:14 2006 +0000

    * Version 0.2.7.
    * debian/changelog: Update for 0.2.7.
    * NEWS: Update for 0.2.7.

commit dc255554ed7bf2f79f7482ec2b23767c7edd4fbf
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Mar 7 11:14:19 2006 +0000

    * debian/changelog: Bump version to 0.2.7.
    * NEWS: Bump version to 0.2.7.
    * configure.ac: Bump version to 0.2.7.
    * po/en_GB.po: Update translation.
    * schroot/sbuild-auth.cc
      (setupenv): For security, PATH is always set to a sane state for
      root, but only set in other cases if not preserving the
      environment.
    * schroot/sbuild-session.cc
      (run_child): When "command-prefix" has been specified, correctly
      set the filename to pass to execve.  Mark four strings for
      translation.

commit 62ba1f47bf7cd61a785abff7c88f1539d00ce779
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 6 19:20:36 2006 +0000

    * Version 0.2.6.
    * debian/changelog: Update for 0.2.6.

commit 0bf9475fc91ea09be39d781c5c6a6d21f27dfe12
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 6 18:53:16 2006 +0000

    * po/en_GB.po: Update translation.

commit 174a93a268ad7854bd70ad0adae867ec309b155b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 6 18:41:22 2006 +0000

    * TODO: Update.
    * schroot/schroot.conf.5.in: Document required ownership and
      permissions for file archives.
    * schroot/sbuild-chroot-file.cc
      (setup_lock): Check ownership and permissions of file archive.
    * schroot/sbuild-chroot-config.cc (check_security): Tidy error
      message formatting.
    * schroot/setup/10mount:
      (do_umount): Only umount if the mountpoint exists.
    * schroot/setup/05file:
      (repack_file): Preserve ownership and permissions of the original
      archive file.

commit e76d27c8d68665ddc10f803af94a60811c6af5ea
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 6 18:06:52 2006 +0000

    * schroot/schroot.1.in: Document environment sanitising.
    * schroot/schroot.cc
      (main): Allow the environment to be preserved even if changing
      users.
    * schroot/sbuild-auth.cc
      (setupenv): Add SHELL to default environment.  Sanitise the
      environment by removing dangerous variables (the same set used by
      sudo).

commit 31eebddbdba15c1dbba2ee39464b4c0df955c02d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Mar 6 17:59:06 2006 +0000

    * po/sv.po: Updated translated from the Free Translation Project.

commit 7ebbc373ef25a2ab723c8a6dca64bc59ae96be40
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Mar 2 23:20:52 2006 +0000

    * debian/changelog: Close #354780.
    * schroot/setup/05file: If the chroot status is not "ok", don't
      repack the file archive.
    * schroot/schroot-setup.5.in: Document second argument to setup
      and exec scripts (chroot status).
    * schroot/schroot.cc (main): Save and restore termios, so that
      abnormal session termination leaves the terminal in a usable
      state.
    * schroot/sbuild-session.cc
      (sighup_called): New variable to flag SIGHUP.
      (sighup_handler): New function to handle SIGHUP.
      (run_impl): Enable and disable handler for SIGHUP.  Switch
      chroot::SETUP_STOP action to after the catch block, to prevent it
      being run twice on failure.
      (setup_chroot): Set chroot_status to false on failure.  Use this
      as the second argument to setup and exec scripts.  If chroot
      locking fails, immediately unlock to ensure that any session
      metadata files are unlinked.
      (wait_for_child): If SIGHUP is caught, kill any child process and
      throw an error.
      (set_sighup_handler): Set a handler for SIGHUP.
      (clear_sighup_handler): Restore the previous handler for SIGHUP.
    * schroot/sbuild-session.h
      (chroot_status): New member to track the state of the chroot.
      (saved_signals): New member used to save and restore signals
      handlers.

commit 8c0f5fb125bddf7eaecb05df3049c94a04c17a90
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 23:07:03 2006 +0000

    * NEWS: Document new source chroots and file repacking.
    * schroot/schroot-setup.5.in: Document CHROOT_FILE_REPACK.
    * schroot/schroot.conf.5.in: Document source chroot options.

commit 525cc5a9517f7c014d8ce3031687ac0dae5d5f22
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 22:47:30 2006 +0000

    * schroot/setup/05file:
      (unpack_file): Use a temporary file to prevent data loss, and use
      trap to clean up on failure.

commit 6758381ecf6710d7582952b464672bace9e4fe9e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 22:04:53 2006 +0000

    * schroot/setup/05file:
      (check_filetype): Correctly escape '.'.

commit 66f92e6f3570da4bdf504a0ec1f93017404a3ada
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 21:51:18 2006 +0000

    * schroot/setup/05file: Fix incorrect comment.

commit eaaf53c604b80c7de85366b0c6e33c2e7d662677
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 21:45:34 2006 +0000

    * schroot/setup/05file: Fix incorrect comment.

commit ed64e9d8264bde333b231465e0a28ba15944b700
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 21:39:37 2006 +0000

    * schroot/setup/05file: Run check_filetype in all cases.
      (unpack_file): Correctly unpack tar.bz2 files.
      (repack_file): New function to pack up the chroot tree back into
      an archive file.

commit 1af7d57fb49deb3fb5df5425c3e525a17bb684f5
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 21:04:17 2006 +0000

    * schroot/sbuild-environment.h
      (add): Use std::boolalpha to correctly represent boolean values.

commit 4cf6323da7ad70fbe7b7a107b7378b2c94726801
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 20:49:29 2006 +0000

    * schroot/exec/00check: Add check for CHROOT_FILE_REPACK.
    * schroot/setup/00check: Add check for CHROOT_FILE_REPACK.
    * schroot/sbuild-chroot-file.cc:
      (chroot_file): repack member is false by default.
      (clone_source): Create a chroot_block_device source chroot.  Set
      repack to true.
      (setup_env): Chain up to chroot_source method.  Add a
      CHROOT_FILE_REPACK environment variable.
      (print_details): Chain up to chroot_source method.
      (get_keyfile): Chain up to chroot_source method.  Set a
      "file-repack" key.
      (set_keyfile): Chain up to chroot_source method.  Get a
      "file-repack" key, but only when restoring an active session.
    * schroot/sbuild-chroot-file.h: Derive from sbuild::chroot_source,
      and implement sbuild::chroot_source::clone_source.
      (repack): New member to allow repacking of the chroot on session
      ending.
    * schroot/sbuild-chroot-config.cc (parse_data): Remove unneeded
      dynamic_cast to chroot_lvm_snapshot *.  Make sure source chroot is
      valid before adding it.

commit 6fe845d19627b246dcaa42ad6d19745e6fb6d5ae
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 18:19:02 2006 +0000

    * schroot/sbuild-chroot-config.cc
      (parse_data): Remove special case for lvm-snapshot chroots.
      Instead, create and add a source chroot for any inactive chroot
      implementing chroot_source.
    * schroot/sbuild-chroot-lvm-snapshot.cc
      (clone_source): Create a chroot_block_device source chroot.
      (setup_env): Chain up to chroot_source method.
      (print_details): Chain up to chroot_source method.
      (get_keyfile): Chain up to chroot_source method.
      (set_keyfile): Chain up to chroot_source method.
    * schroot/sbuild-chroot-lvm-snapshot.h: Derive from
      sbuild::chroot_source, and implement
      sbuild::chroot_source::clone_source.

commit 99082abfa717498120e3f8dedf3a7ab48e2aa4ba
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 18:10:25 2006 +0000

    * All classes derived from sbuild::chroot use virtual public
      inheritance (to allow for the use of sbuild::chroot_source).

commit 6641f96f4f1f06f7ba272ac551be0396a5a672e4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 18:02:51 2006 +0000

    * Makefile.am: Add sbuild-chroot-source.(cc|h).
    * schroot/sbuild.h: Include sbuild-chroot-source.h.
    * schroot/sbuild-chroot-source.(cc|h): New file.  This is an
      interface class, to be implemented by chroots providing source
      chroots in addition to normal chroots.

commit 5ae8c09d7a7a3453a0018d1f924cf27d334fb1e0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 11:51:54 2006 +0000

    * debian/changelog: Update.
    * debian/schroot.init: Rename $DAEMON to $SCHROOT.  Don't exit
      with an error if session recovery for an individual chroot fails.

commit b455d90d076f936fe74b0c62e6a3357ff9243df8
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 11:35:19 2006 +0000

    * NEWS: Document changed behaviour of session operations.
    * schroot/schroot-options.cc (options): Allow session recovery,
      session running and session ending to be performed upon multiple
      chroots, rather than one at once.

commit b066306c35068627d5bc44b8f138f7b8786d2ae0
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 11:03:32 2006 +0000

    * schroot/sbuild-chroot-config.cc (parse_data): Don't create a
      "-source" chroot for LVM snapshots if the chroot is active.

commit 3912b9143c043c28dd97aebf8966e2064b0d5afb
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 11:00:42 2006 +0000

    * NEWS: Document exec.d and run-exec-scripts changes.

commit ee453438b3499a450ef615856c1a0f7a8fb6d59d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 28 10:55:55 2006 +0000

    * debian/changelog: Update.
    * debian/postinst: Move /etc/schroot/run.d/00check to
      /etc/schroot/exec.d/00check if modified locally.
    * debian/preinst: Remove /etc/schroot/run.d/00check if not
      modified locally.
    * Update tests.
    * schroot/schroot.conf: Rename run-session-scripts to
      run-exec-scripts.
    * schroot/schroot.conf.5.in: Document new configuration
      parameters, and deprecated parameters.
    * schroot/schroot.1.in: Document new setup script locations.
    * schroot/schroot-setup.5.in: Document new setup script locations
      and parameters.
    * schroot/Makefile.am (SUBDIRS): Rename run to exec.
    * configure.ac: Rename SCHROOT_CONF_RUN_D to SCHROOT_CONF_EXEC_D.
      Rename schroot/run/Makefile to schroot/exec/Makefile.  Tidy
      comments.
    * schroot/sbuild-session.cc: Use new chroot functions and enums.
      Also use SCHROOT_CONF_EXEC_D rather than SCHROOT_CONF_RUN_D.
      Execution scripts are called with "exec-start" and "exec-stop",
      rather than "run-start: and "run-stop", respectively.
    * Use new functions and enums in all derived chroot types.
    * schroot/sbuild-chroot.cc
      (get_run_exec_scripts): Rename from get_run_session_scripts.
      (set_run_exec_scripts): Rename from set_run_session_scripts.
      (print_details): Print "Run Execution Scripts" rather than "Run
      Session Scripts".
      (get_keyfile): Set "run-exec-scripts" in the keyfile.
      (set_keyfile): Get "run-exec-scripts" in the keyfile.  Also get
      "run-session-scripts" (now deprecated) for backward compatibility.
    * schroot/sbuild-chroot.h
      (setup_type): Rename RUN_START and RUN_STOP to EXEC_START and
      EXEC_STOP.
      (run_exec_scripts): Rename member from run_session_scripts.
    * Rename schroot/run to schroot/exec.

commit 427ba2348aebaaaa17540779f4384ce665d74576
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 27 23:08:47 2006 +0000

    * debian/postinst: Move /etc/schroot/run.d/50sbuild to
      /etc/schroot/setup.d/50sbuild if modified locally.
    * debian/preinst: Remove /etc/schroot/run.d/50sbuild if not
      modified locally.
    * schroot/schroot-setup.5.in: Update location of 50sbuild.
    * Move 50sbuild from schroot/run.d to schroot/setup.d.
    * schroot/setup/50sbuild: Move from schroot/run/50sbuild.

commit 8f8de1f963b3c5ad1bf0d12a23690e3ee4bed958
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 27 20:56:44 2006 +0000

    * configure.ac: Bump version to 0.2.6.

commit ef04dfb1f8619892ee53d901811c680deab043b1
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 27 20:54:23 2006 +0000

    * NEWS: Document "command-prefix" option.
    * schroot/schroot.conf.5.in: Document "command-prefix" option.
    * schroot/sbuild-session.cc
      (run_child): Concatenate command_prefix and command to get the
      command to run in the chroot.
    * schroot/sbuild-chroot.cc
      (get_command_prefix): New method to get command prefix.
      (set_command_prefix): New method to set command prefix.
      (print_details): Display command_prefix if set.
      (get_keyfile): Set command-prefix in keyfile.
      (set_keyfile): Get command-prefix from keyfile.
    * schroot/sbuild-chroot.h: New member command_prefix.

commit 63dbab0ddf7a844eba27507b7dc56b9d0cfb7bb1
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 27 12:31:52 2006 +0000

    * Remove bashisms in all setup and run shell scripts (test "-o"
      and "function" in shell functions).  Thanks to Clint Adams for
      this patch.

commit 5149d191f4d082631e5819a3e19c8eeb7daa4b7a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 26 21:48:49 2006 +0000

    * Version 0.2.5.
    * configure.ac: Update for 0.2.5.
    * debian/changelog: Update for 0.2.5.
    * NEWS: Document "Path" line.  Update for 0.2.5.
    * schroot/sbuild-chroot.cc (print_details): Output path
      information if available.

commit 8f8727d503711733e19fa0bdd0ab55b144c138d3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 26 21:09:38 2006 +0000

    * debian/changelog: Update to close the --help options (Bug
      #354477).

commit 3badc889474e0306f301befc5b714a10a501a541
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 26 21:03:49 2006 +0000

    * debian/changelog: Update.
    * schroot/run/50sbuild: Create
      ${CHROOT_PATH}/var/lib/sbuild/srcdep-lock and set ownership and
      permissions of all files under ${CHROOT_PATH}/var/lib/sbuild to
      root:sbuild and 02775, respectively.  Thanks to Adeodato Sim for
      this patch.

commit 98914fa72aa2ae894bf692b11541f4954bae32b1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 26 20:20:54 2006 +0000

    * schroot/schroot.1.in: Correct the --help options.  Thanks to
      Clint Adams for this patch.

commit 7f10b97dde08f79cc7e61d6954f355de6d0f9eb8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 25 13:50:42 2006 +0000

    * debian/changelog: Add acknowledgement for #354257.

commit 68d6c7ed9f6037db21df32011680d4bfd0ce360d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 25 13:09:47 2006 +0000

    * Version 0.2.4.
    * debian/changelog: Update for 0.2.4.
    * TODO: Update.

commit 2bf7716a2d995b32a41e3daef22b83e131341356
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 25 12:56:14 2006 +0000

    * schroot/sbuild-chroot-config.h: Fix Doxygen warnings.
    * schroot/sbuild-parse-value.cc: Fix Doxygen warnings.
    * schroot/sbuild-parse-value.h: Fix Doxygen warnings.

commit beeddd215ed97bc2a9ad9bba79740c4f70157030
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 25 12:06:20 2006 +0000

    * debian/changelog: Update.
    * NEWS: Update.
    * Update tests.
    * schroot/schroot.conf.5.in: Document "run-setup-scripts"
      behaviour for plain chroots.
    * schroot/setup/10mount: Allow plain chroots to run the mount
      script.  For plain chroots, bind mount LOCATION on MOUNT_LOCATION.
    * schroot/setup/00check: For plain chroots, verify
      CHROOT_LOCATION, rather than CHROOT_PATH (because CHROOT_PATH does
      not exist at this point).
    * schroot/sbuild-session.cc
      (run_impl): In addition to all other chroot types, if chroot is a
      chroot_plain chroot with setup scripts enabled, set the mount
      location to the session id.
    * schroot/sbuild-chroot-plain.cc
      (get_path): New virtual method to override base class
      implementation.  When setup scripts are enabled, return the mount
      location, or else the location.
      (setup_lock): When setup scripts are enabled, write out a session
      metadata.
      (get_session_flags): When setup scripts are enabled, enable
      SESSION_CREATE, or else 0.

commit 8ed945159a20d66e9aa8ee55918a16fe35664cbf
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Feb 24 20:26:07 2006 +0000

    * schroot/schroot.conf.5.in: Document "location" for block-device
      chroots.
    * schroot/schroot-setup.5.in: Document CHROOT_LOCATION and
      CHROOT_PATH.
    * Update tests to check CHROOT_LOCATION and CHROOT_PATH.
    * schroot/setup/50chrootname: Replace CHROOT_MOUNT_LOCATION with
      CHROOT_PATH.
    * schroot/setup/30passwd: Replace CHROOT_MOUNT_LOCATION with
      CHROOT_PATH.
    * schroot/setup/20network: Replace CHROOT_MOUNT_LOCATION with
      CHROOT_PATH.
    * schroot/setup/10mount: Replace CHROOT_MOUNT_LOCATION with
      CHROOT_PATH.
    * schroot/setup/00check: Add CHROOT_LOCATION and CHROOT_PATH.
      Replace CHROOT_MOUNT_LOCATION with CHROOT_PATH.
    * schroot/run/50sbuild: Replace CHROOT_MOUNT_LOCATION with
      CHROOT_PATH.
    * schroot/run/00check: Add CHROOT_LOCATION and CHROOT_PATH.
    * schroot/sbuild-chroot-config.cc
      (print_chroot_location): Use get_path() instead of
      get_mount_location().
    * schroot/sbuild-session.cc
      (run_child): Use get_path() instead of get_mount_location().
    * schroot/sbuild-chroot-plain.cc
      (get_location): Chain up to base class implementation.
      (set_location): Chain up to base class implementation.
      (print_details): Remove printing of location detail.
    * schroot/sbuild-chroot-plain.h
      (get_location): Make virtual.
      (set_location): Make virtual.
      (get_mount_location): Remove virtual function.
      (location): Remove member.
    * schroot/sbuild-chroot-block-device.cc
      (get_location): New method.  Get the location of a chroot on the
      device filesystem.
      (set_location): New method.  Set the location of a chroot on the
      device filesystem.
      (get_keyfile): Set location in keyfile.
      (set_keyfile): Get optional location from keyfile.
    * schroot/sbuild-chroot.cc
      (get_location): New virtual method.
      (set_location): New virtual method.
      (get_path): New virtual method.  The default implementation
      concatenates and returns the mount_location and the location.
      (setup_env): Add CHROOT_LOCATION and CHROOT_PATH to the
      environment.
      (print_details): print Location and Path.
    * schroot/sbuild-chroot.h:
      (location): New member.

commit 4595bf4794897fe7003db8600efddd34159a9d66
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Feb 24 13:36:45 2006 +0000

    * po/en_GB.po: Add missing space.

commit c584e6d33687fb92cfae6c9f515e56bb8eb6161c
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Feb 24 13:34:31 2006 +0000

    * debian/changelog: Bump version to 0.2.4.
    * NEWS: Bump version to 0.2.4.
    * configure.ac: Bump version to 0.2.4.

commit 5457bbd96528e4508f587deee486c7482ecbfc44
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 21:08:42 2006 +0000

    * schroot/schroot.conf.5.in: Fix typo.
    * schroot/dchroot.1.in: Fix syntax error.

commit 794577cce2002b4814010042038ffad04916138c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 21:07:38 2006 +0000

    * schroot/Makefile.am: Install dchroot setuid.

commit b62ed8cd3e223a18f3852313a8e030c1ea9a2f5d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 21:06:33 2006 +0000

    * debian/changelog: Update
    * debian/rules: dchroot must be installed setuid root.
    * debian/schroot.lintian-overrides: Add dchroot.

commit 0006c0b41551de43aed877c9df892537e60dba8c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 10:56:22 2006 +0000

    Update translations.

commit 4bd3abfa771dd1cc9a5fa2185730031e4b83e004
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 10:04:55 2006 +0000

    * Version 0.2.3.
    * debian/changelog: Update for 0.2.3.
    * NEWS: Document changed "--info" output.
    * TODO: Update.

commit 0a77a282750d1a3440b8ed33160f92f4d1eba1eb
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 09:57:54 2006 +0000

    * schroot/sbuild-chroot.cc (print_details): Add a "Session
      Managed" line if SESSION_CREATE is used.

commit c506c21a727de6204989a0e0405c5b6a349dad9c
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 09:32:55 2006 +0000

    * test/sbuild-chroot-config.cc: Account for additional -source
      chroots.

commit 5a53337f165ba90322bab274ad40ebddd356c771
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 21 00:38:32 2006 +0000

    * NEWS: Document automatic block-device creation for lvm-snapshot
      chroots.
    * TODO: Remove completed item.
    * schroot/schroot.conf.5.in: Document automatic block-device
      creation for lvm-snapshot chroots.
    * schroot/sbuild-chroot-config.cc (parse_data): Create a
      corresponding block-device chroot for each lvm-snapshot chroot.
      "-source" is appended to the chroot name and its aliases.

commit 1d7f3baf03f8e5f053d7b2c9680131f213fd4bed
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 20:37:29 2006 +0000

    * schroot/dchroot.1.in: Document how to remove dchroot.conf.

commit 336229de59f16408dafc61c8f60e8b38bbcc6509
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 20:29:52 2006 +0000

    * schroot/dchroot.1.in: Document reasons why schroot.conf should
      be used in preference to dchroot.conf.

commit 6385a6fa724460806a99b5413c3396bb36239fe3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 18:53:44 2006 +0000

    Updated translations.

commit 50f35ae32becafb55e76ae6411aedcf6130b3461
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 12:10:00 2006 +0000

    * schroot/dchroot-session.cc (run_impl): Use boost::format rather
      than printf specifiers.

commit 16016b6b4d91f1f4d39a872aa79b7daaac55de88
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 12:04:02 2006 +0000

    * Update po files.
    * po/POTFILES.in: Add dchroot files.

commit 08aeaaf089fac676dff4f8570514514eda4e405e
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:59:01 2006 +0000

    * .cvsignore: Update for dchroot.

commit af7ed811b10221f0377841e4cc22cde0dc07c663
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:57:37 2006 +0000

    * schroot/schroot.cc (main): Use ACTION_LOCATION, not
      ACTION_INFO_LOCATION.

commit d80174f075f8b0e98d4a3201ab3ad3af3dda1ee3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:55:30 2006 +0000

    * debian/changelog: Update for version 0.2.3-1.
    * debian/README.Debian: Update dchroot notes.
    * debian/rules (config.status): Add --enable-dchroot to configure,
      to package the dchroot + wrapper.
    * debian/control (schroot): Provide, Conflict and Replace dchroot.
      Enhances sbuild.  Suggest lvm-common for LVM support.  Update
      description.

commit 91f9fd733d20338d0622b4fac70e26495ff2630a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:32:08 2006 +0000

    * NEWS: Add dchroot.

commit d87bdfcf9bb0f79207a4a7e76f9ca62b404c2608
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:31:12 2006 +0000

    * schroot/schroot.1.in: Document new --location option.

commit 26d9afb976d4c6d2d9ff0b0cbd80f431662f9d1b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:30:12 2006 +0000

    * TODO: Add dchroot.
    * configure.ac: Create schroot/dchroot.1.
    * schroot/Makefile.am: If --enable-dchroot was used, build and
      install dchroot and dchroot.1.

commit df41e25aa94bda32f99a9e80dbe29be8e861f4e3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:27:42 2006 +0000

    * schroot/sbuild-session.h (session): The contructor chroots
      argument is a const reference rather than a value.

commit 22123e67d5cd063b77c698732525f84aa7acb58b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:25:08 2006 +0000

    * schroot/dchroot.1.in: Add manual page for dchroot.

commit 5541bf6138fcd69c74edf3cf4154ef33db4776f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:22:35 2006 +0000

    * schroot/schroot.cc: If SBUILD_DCHROOT_COMPAT is defined, run in
    dchroot compatibility mode, using the alternate
    dchroot::chroot_config and dchroot::session classes for reading
    the configuration and session handling.

commit 63e0f4142448ba76e551b809859d47cf780044cf
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:19:13 2006 +0000

    * schroot/schroot-options.cc
      (options): Set dchroot_compat if SBUILD_DCHROOT_COMPAT is defined.
      (options): If dchroot_compat is set, use dchroot compatible
      options, otherwise schroot options.
    * schroot/schroot-options.h
      (action_type): New action ACTION_LOCATION to print chroot
      location.
      (chroot_path): New member; chroot to print path.
      (dchroot_compat): New member; dchroot compatibility mode.

commit ac3dd90cbb95da1e78f4e16fe3223f6e9dfd1230
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:11:32 2006 +0000

    * schroot/dchroot-session.(cc|h): New class, dchroot::session,
      derived from sbuild::session.  This disables user authentication
      (but not authorisation), and disables user switching.
    * schroot/dchroot-chroot-config.(cc|h): New class,
      dchroot::chroot_config, derived from sbuild::chroot_config.  This
      parses the dchroot.conf configuration file.

commit cf6529274e25631be98f7962f6a58254acc3aefe
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 11:06:58 2006 +0000

    * configure.ac: Add --enable-dchroot check to enable dchroot
      compatibility.

commit d41477946f07503619bd5d425e99e09956aea769
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 10:03:29 2006 +0000

    * schroot/schroot.cc (main): Use the new session::ptr typedef.
    * schroot/sbuild-session.h: Add a ptr typedef, a shared_ptr to a
      session.

commit 08ff05286d609fd90ca1d0c2bf7a714f96b81636
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 09:50:37 2006 +0000

    * schroot/sbuild-chroot-config.cc
      (print_chroot_list_simple): New function to print the chroot list
      on a single line, in the same style as dchroot (comma-separated,
      with aliases in square brackets).
      (print_chroot_location): New function to print the mount location
      of the specified chroots.

commit ef4c787a44e8abd8ec7f4c2fcf9a61ea0fdb58c4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 20 09:46:42 2006 +0000

    * po/Makevars (XGETTEXT_OPTIONS): Add --boost so boost-format
      strings are correctly extracted.

commit 5828e2061d5575ecff0f4b21cbbaf01b450ba6c1
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 18 19:15:05 2006 +0000

    * Updated sv.po and vi.po from the Free Translation Project.

commit 4a8f4aa30563df09bd8892c4909efedd46c18b34
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Feb 18 00:20:29 2006 +0000

    * schroot/sbuild-chroot-config.h: Fix include guard naming.
    * schroot/sbuild-chroot-config.cc (add): New overloaded protected
      method to add a chroot, including checking for duplicates.  Split
      out from parse_data.

commit 4d904b2f87935d8fa9e5415b39e37dd6ae4abe01
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Feb 17 19:33:54 2006 +0000

    * test/sbuild-chroot-config.cc: Update tests.
    * schroot/schroot.cc
      (main): Use new chroot_config typedef, and use chroot_config::add
      instead of add_config_file and add_config_directory.
      * schroot/sbuild-chroot-config.h
      (ptr): New typedef for a shared_ptr to a chroot_config.
      (add_config_file: Now private.
      (add_config_directory): Now private.
    * schroot/sbuild-chroot-config.cc
      (add): New method.  This replaces the file/directory detection in
      the constructor, and then calls add_config_file or
      add_config_directory as required.
      (load_data): New function, renamed from load.
      (parse_data): New virtual function, called from load_data.  This
      parses the loaded data, and is split out from load.

commit 168211dca4ff81d515a31278e3c2b9a374bb3306
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Feb 17 19:29:44 2006 +0000

    Regenerated translations.

commit c334a56308017cc93045030a8fdbbd31472f5639
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 16 21:46:04 2006 +0000

    * schroot/schroot.cc (main): If --quiet is specified, don't log an
      error if the session fails.  A non-zero exit status is still
      returned.

commit eac233b5cf48893398a13e019b1411b0ef7e87f6
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 16 18:50:15 2006 +0000

    * schroot/sbuild-session.cc (run_child): If it is not possible to
      change into the correct directory inside the chroot, print a
      warning rather than an error.

commit 50777b21e1c587fbd9a798aca6505ed3518f2e39
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 7 17:15:03 2006 +0000

    * debian/changelog: Bump version to 0.2.3.
    * debian/control (Build-Depends): Add pkg-config build dependency.
    * NEWS: Bump version to 0.2.3.
    * configure.ac: Bump version to 0.2.3.

commit 501b4c3685eef190180757e5c859640ed08c0c73
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 7 17:09:41 2006 +0000

    * schroot/schroot-setup.5.in: Document setup/05file.
    * schroot/schroot.1.in: Fix typo in macro.

commit 08158c9fcb13cc3958d6b5628df50ceeabc1bdbc
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Feb 7 16:47:26 2006 +0000

    * schroot/schroot-options.cc
      (options): Fix typo (begining).  Thanks to Clytie Siddall at the
      Free Translation Project for spotting it.

commit 4276bcca722bcd5518b2fd1ab4932a587e5cbdf1
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 23:22:16 2006 +0000

    * Version 0.2.2.
    * debian/changelog: Update for 0.2.2.

commit 6e5f193582105fad0e3fc974252da96de4aaa22e
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 21:55:51 2006 +0000

    * po/en_GB.po: Update.
    * po/POTFILES.in: Update file list.
    * Minor cosmetic cleanups.

commit ca7a05583e5b0235018c127c1706e63a34238754
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 21:13:35 2006 +0000

    * Remove static qualifer from functions in the unnamed namespace.
    * schroot/sbuild-chroot-config.cc
      (chroot_alphashort): Move to unnamed namespace.
    * Update doxygen documentation for file members.

commit 7637a4b4e5deea438796cd9b0fceff6ac27d6a30
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 20:41:39 2006 +0000

    * Use the same indentation style for all function prototypes.

commit 86fcddec4c536bee950bccfff1970582869ec3d3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 19:01:22 2006 +0000

    * NEWS: Document updated defaults.
    * schroot/schroot.conf.5.in: Document updated defaults.
    * schroot/sbuild-chroot-lvm-snapshot.cc
      (chroot_lvm_snapshot): Default to running setup and session
      scripts.
    * schroot/sbuild-chroot-file.cc
      (chroot_file): Default to running setup and session scripts.

commit dfe77053b0a861381d8a1b019765eed1dac617d3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 15:21:38 2006 +0000

    * debian/control: Add versioned depends on libpam0g-dev >=
      0.79-3.1, because earlier versions have broken headers, due to
      redefining internal glibc/libstdc++ types.

commit f91993d9f94d56c3b9373e2ccac575a998286a34
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 13:44:22 2006 +0000

    * Remove all keyfile constructors from sbuild::chroot and derived
      classes.

commit 430a32c1ebf1fea7a097bea602d3d36843101091
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 12:33:54 2006 +0000

    * doc/schroot.dox.in: Strip the build directory from file
      pathnames, use built-in STL support, and sort classes by
      namespace.

commit 1d81f93e090c6703eee8e03b92c8fbfe3acfb314
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 11:37:49 2006 +0000

    * Rename sbuild::chroot::chroot_ptr to sbuild::chroot::ptr,
      sbuild::chroot::SetupType to sbuild::chroot::setup_type, and
      sbuild::chroot::SessionFlags to sbuild::chroot::session_flags.

commit 2d8a4736f54342b1687cc080b6788f4780c33d29
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 10:17:32 2006 +0000

    * Rename schroot::Options to schroot::options.

commit 2188080070917f1f719ecb31248b0c53e575d7d9
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 10:14:44 2006 +0000

    * Rename sbuild::Session to sbuild::session.

commit e5e2b9db4db886c1815d1ce37ae20febb46c65ce
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 10:05:29 2006 +0000

    * Rename sbuild::AuthConvTty to sbuild::auth_conv_tty.
    * Rename sbuild::AuthConv to sbuild::auth_conv.

commit 00099d96fe73c17be42cb07be7b609f7c83af68b
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 09:52:43 2006 +0000

    * Rename sbuild::AuthMessage to sbuild::auth_message.

commit 0904d1fd8dddd09ce3184652d6607bcde30cb463
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Feb 6 09:42:53 2006 +0000

    * Rename sbuild::Auth to sbuild::auth.

commit ec423ef0ea71ccb5fe64ae905a47b049a7b856b6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 23:38:40 2006 +0000

    * Rename Sbuild::Lock to sbuild::lock, Sbuild::FileLock to
      sbuild::file_lock, and Sbuild::DeviceLock to sbuild::device_lock.

commit d5db0ef490758e8187453f043bf50437f7aacba6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 23:25:03 2006 +0000

    * Rename sbuild-config.(cc|h) to sbuild-chroot-config.(cc|h).
    * Rename sbuild::Config to sbuild::chroot_config.

commit a849ccb4b1ceedf1a6dcd9895ef2ad422ac4c198
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 23:00:54 2006 +0000

    * Rename sbuild::ChrootLvmSnapshot to sbuild::chroot_lvm_snapshot.
    * Rename sbuild::ChrootBlockDevice to sbuild::chroot_block_device.
    * Rename sbuild::ChrootFile to sbuild::chroot_file.
    * Rename sbuild::ChrootPlain to sbuild::chroot_plain.

commit 402c05b69546f66ba7a8eca52266679dd885421a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 22:37:58 2006 +0000

    * Rename sbuild::Chroot to sbuild::chroot.
    * test/config.ex2/sarge
      (run-session-scripts): Remove duplicate line.

commit aa504f9765ff6baec527b8a07f511cb3675ecb40
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 18:45:29 2006 +0000

    * schroot/sbuild-auth-conv.h: Add an error exception typedef.
    * schroot/sbuild-auth-conv-tty.cc
      (get_delay): Throw an exception on fatal timeout.  Log a warning
      rather than using std::cerr.
      (read_string): Return a string rather than a pointer to an
      allocated string.  Throw an exception on failure.
      (read_string): Don't print a newline after the prompt message.
      (conversation): Remove all string cleanup code and replace with a
      single exception handler.

commit 6d2cbe9b5f57e17e2513816359905ff050d564a4
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 17:33:56 2006 +0000

    * schroot/sbuild-keyfile.h
      (operator >>): Linecounting counts from line 1, rather than 0.
      Fix error message capitalisation.  All parsed groups and keys are
      added to a temporary keyfile, which is then assigned to the
      current keyfile, to allow the correct catching of duplicate groups
      and keys.
    * schroot/sbuild-keyfile.cc
      (operator +=): New function.  Add all of the keys in one keyfile
      to another, overwriting keys on the lhs if already present.
      Comments are carried across.
      (operator +): New function.  Add two keyfiles together.

commit 575dfa2de4912c02730afffde3b94ca5fe080b28
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 13:21:02 2006 +0000

    * schroot/schroot.1.in: Add better description for the use of
      "--config".
    * schroot/schroot.conf.5.in: Document localised strings.
    * schroot/sbuild-config.cc (load): Exceptions thrown by keyfile
      parsing are not caught and treated as warnings; they are fatal.
    * schroot/sbuild-chroot.cc (set_keyfile): Get a localised value
      for the "description" key.
    * schroot/sbuild-keyfile.cc (get_locale_string): Add a set of
      overloaded functions to get localised string values.

commit e3697ef0782236c93c33d66994ae2e29382823ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Feb 5 11:22:27 2006 +0000

    * test/sbuild-keyfile.cc: Update.
    * schroot/sbuild-keyfile.h
      (set_value): Overload to provide an optional comment.  Call
      set_group to create nonexistent groups on the fly.
      (set_list_value): Overload to provide an optional comment.
      (operator >>): Parse comments.
    * schroot/sbuild-keyfile.cc
      (set_group): New function to add a group with a comment.
      (get_comment): An overloaded function to get group and item
      comments.
      (print_comment): Split string to print on '\n', and correctly
      reproduce whitespace.

commit cedf5a3c967e1fa2bf711f3fdf307f87b787350e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 21:17:25 2006 +0000

    * NEWS: Update.

commit e4fab6e810a214ad23b351724a828a7305cdf079
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 21:15:28 2006 +0000

    * schroot/schroot.1.in: Document new "--config" option.
    * schroot/schroot.cc (main): Print configuration if "--config" is
      specified.
    * schroot/schroot-options.cc: Add "--config" option to set
      ACTION_CONFIG.
    * schroot/schroot-options.h: New action_type enum ACTION_CONFIG.
    * schroot/sbuild-config.cc (print_chroot_config): New function to
      print chroot configuration (keyfile format).

commit 7ac1365c2e2129fa07ce47e0a65e00988a4d9325
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 20:57:06 2006 +0000

    * Update testcases.
    * schroot/sbuild-config.cc
      (print_chroot_info): Use new chroot streaming to output details to
      an ostream.
    * print_details is protected in all derived classes.
    * schroot/sbuild-chroot.h
      (print_details): Make protected.
      (operator <<): New friend function to output chroot details to an
      ostream.

commit 57614ff835a2e4a6854cb4e621519a98da99c521
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 20:51:42 2006 +0000

    * debian/changelog: Update.
    * debian/control (Build-Depends): Remove GLib.
    * README: Update build-dependencies.

commit 1be348b9e1ba1ab95ab4625f09c88edd49b1d93e
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 20:32:30 2006 +0000

    * Update TODO list.
    * Update testcases.
    * schroot/sbuild-config.cc (load): Use the new Chroot keyfile
      streaming functionality to initialise chroots.
    * Implement all new virtual functions in Chroot in derived
      classes.
    * Remove all functions removed from Chroot in derived classes.
    * schroot/sbuild-chroot.(cc|h)
      (Chroot): Remove overloaded construction to initialise with a
      keyfile.
      (create): Remove overloaded method for creating from a keyfile.
      (print_config): Remove.
      (get_keyfile): New protected virtual method to serialise a chroot
      to a keyfile.
      (set_keyfile): New protected virtual method to initialise a chroot
      from a keyfile.
      (operator >>): New friend function to stream from a keyfile.
      (operator <<): New friend function to stream to a keyfile.

commit 468c5e749d9b9c7276adc7d8209169e5f8938463
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Feb 2 15:11:59 2006 +0000

    * Simplify rethrow in catch blocks.
    * schroot/sbuild-session.cc (run_impl): Remove unneeded else
      block, to simplify the code.

commit 1a280d1ddd8ec8e4178bda1f642f7843ad96f026
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Feb 1 14:26:45 2006 +0000

    * debian/changelog: Update version to 0.2.2.
    * NEWS: Update version to 0.2.2.
    * configure.ac: Update version to 0.2.2.

commit 28f852ec01d362238310730c5085e97e37f93abc
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Feb 1 14:20:51 2006 +0000

    * schroot/sbuild-chroot.cc
      (Chroot): Get "mount-location" and "mount-device" from session
      keyfiles.
      (print_details): Use the correct virtual functions to get
      "Mount Location" and "Mount Device".
      (print_config): Use the correct virtual functions to get
      "mount-location" and "mount-device".

commit 64786a6700184e8a7efcc9d8d211055d3281fcfe
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Feb 1 11:51:25 2006 +0000

    Fix email address.

commit c506573769de17085968451557e36b0c697b3edd
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Feb 1 11:33:51 2006 +0000

    * Version 0.2.1.
    * debian/changelog: Update for 0.2.1.
    * schroot/sbuild-session.cc (wait_for_child): Set child_status to
      EXIT_FAILURE, rather than this->child_status.  This prevents a
      non-zero exit status being returned at all times by child
      processes.
    * NEWS: Update for 0.2.1.
    * configure.ac: Update version to 0.2.1.

commit aebad84c75f54ffd8aa248553690493b372560c6
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 30 13:10:35 2006 +0000

    * Version 0.2.0.
    * schroot/schroot.conf.5.in: Add example for file chroot.
    * test/config.ex2/config: Removed (duplicated in
      test/config.ex2/sarge).
    * test/config.ex2/file: New file.  Test data for file chroots.

commit d32c759d29ccad532dcfb2253af951269375df32
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 30 12:44:09 2006 +0000

    * schroot/schroot-options.cc: Beginning a session only works with
      normal chroots.  Session operations on active sessions load all
      chroots, not just session chroots.
    * schroot/sbuild-session.cc
      (run_impl): For persistent sessions, remove aliases prior to
      writing out the session data, to prevent duplicate aliases.
      (run_impl): Only run a command when performing the appropriate
      operations, rather than all the time.
      (setup_chroot): Correct bug in automatic operation which would
      potentially prevent correct cleanup.
    * schroot/sbuild-keyfile.h: Add TODO item for duplicate keys.
    * schroot/sbuild-config.cc (load): Add warnings when chroots and
      aliases names are duplicated.

commit e64a478afee96e15e490d525fd1bd92ce79c4264
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 29 23:57:27 2006 +0000

    * test/sbuild-chroot-file.cc: New file.  Unit test for ChrootFile.
    * schroot/sbuild-util.cc (string_list_to_strv): New function,
      moved from sbuild-session.cc.
    * schroot/sbuild-session.cc: Remove string functions.

commit f7dc0680d77939e7f8f3f5d5de0db40896601817
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 29 18:59:02 2006 +0000

    * schroot/sbuild-chroot.cc (create): Add support for "file" type
      chroots.
    * schroot/setup/05file: Split file type checking and unpacking
      into shell functions.
    * schroot/run/00check: Add support for file chroots.
    * schroot/setup/00check: Add support for file chroots.
    * schroot/setup/Makefile.am (setup_SCRIPTS): Add 05file.
    * schroot/schroot.1.in: Update help options.

commit ecd21cdea6c1e6cc18f60ac44ac226a3d57fb055
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 29 17:24:09 2006 +0000

    * schroot/sbuild-util.cc (find_program_in_path): Return the
      program name without the absolute prefix.
    * schroot/sbuild-session.cc (run_child): Don't prefix the program
      search path (find_program_in_path), because it's already running
      inside the chroot.
    * schroot/Makefile.am (DEFS): Remove G_LOG_DOMAIN.
    * schroot/schroot-options.cc: Remove debugging messages.

commit 0ec34e5cdb236dff8130eaf82373d445563900af
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 18:33:26 2006 +0000

    * debian/rules: Don't run the testsuite.

commit 05034a03044bc7a0a7a2d790819da5a6c3eb44e5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 18:29:35 2006 +0000

    * schroot/schroot-options.cc: Store positional arguments correctly
      using positional_options_description.

commit e4506078baf70b0d5452c23f428f33a4efb929d3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 17:38:44 2006 +0000

    * debian/changelog: Update for 0.2.0.
    * debian/control: Suggest unzip.
    * NEWS: Update for 0.2.0.

commit 0e2c42f2e96aea16c817174aca149393c82cb2fb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 17:00:52 2006 +0000

    * po/en_GB.po: Updated British English translation.

commit a7c77604f00b23bb21e89bef5ec1f3650453d352
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 16:39:33 2006 +0000

    * configure.ac: Remove check for stdbool.h.

commit b41f79e2ef1c4b1fd63d4bfbecaff5db02ca7f5e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 16:21:49 2006 +0000

    * schroot/sbuild-chroot.h: setup_session_info is protected and
      virtual.
    * test/Makefile.am: Distribute test data.

commit b28100759385367ee62f1713068b636b51d10d32
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 16:05:35 2006 +0000

    * schroot/setup/05file: Filetype checks are now quiet.

commit 47c06cfb0684409eea6b4b53417d30315e2d7ce2
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 16:01:59 2006 +0000

    * Update documentation.
    * schroot/setup/10mount: Add special cases for file chroots.
    * schroot/setup/05file: New file for unpacking and deleting
      file-based chroots.
    * schroot/sbuild-chroot-file.(cc|h): New file implementing
      file-based chroots.
    * schroot/sbuild-chroot.cc (setup_session_info): Add
      setup_session_info from ChrootLvmSnapshot.
    * schroot/sbuild-chroot-lvm-snapshot.cc: Remove setup_session_info.

commit e28d16e9467ae07135600c54403e0e108b63d071
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 13:39:48 2006 +0000

    * test/sbuild-parse-value.cc: New file.  Tests for parse_value.
    * schroot/sbuild-parse-value.h (parse_value): Check failbit rather
      than badbit to catch parse errors.
    * schroot/sbuild-parse-value.cc (parse_value): Correctly parse
      false boolean values.

commit fddeb86b229243602d34f6040a3501e08132839e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 11:51:57 2006 +0000

    * schroot/sbuild-session.cc (run_child): Search for the program to
      run inside the chroot, rather than on the root filesystem.
    * schroot/sbuild-util.cc (find_program_in_path): Add a prefix
      argument, to allow searching in non-root paths, for example inside
      a chroot.

commit 89674e415d112ce181eb5003315fffe7f57c0ef8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 00:42:00 2006 +0000

    * schroot/sbuild-config.cc (load): Catch and handle exceptions if
      chroot creation fails.
    * schroot/sbuild-chroot.cc (create): Throw an exception if
      creation fails.

commit 9d267bcd406702a60c91016f037aa72677d1bd33
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 28 00:08:25 2006 +0000

    * configure.ac: Update maintainer email address.
    * schroot/sbuild-config.h: Remove completed TODO item.

commit 1913984ca3c606d422cc3e88fa357493cf87a7b6
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 27 23:57:48 2006 +0000

    * test/sbuild-config.cc (class test_config): Update to use active
      argument.
    * schroot/schroot.cc (main): When loading chroot configuration,
      specify if they are active sessions or not.
    * schroot/sbuild-config.cc: All methods taking a file or directory
      name also take an "active" argument to specify if the chroots
      being loaded are active sessions or not.

commit e18f4d1bdbbf012077bdae6bbf3bcd2529386cd4
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 27 23:34:12 2006 +0000

    * schroot/sbuild-environment.h: Remove completed TODO item about
      recommending strv_delete().

commit 48fa99421597e809dbf1e07359f550caee598d98
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 27 22:56:04 2006 +0000

    * schroot/sbuild-auth-conv-tty.cc: Move static data and functions
      into the unnamed namespace.

commit f258ed59f415eb3b6ae42769a0572d3d6753b5b7
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 26 23:36:11 2006 +0000

    * schroot/schroot.cc (main): Only allow preservation of the user
      environment if not switching users.
    * schroot/sbuild-auth.cc (Auth, set_user): Throw exceptions rather
      than exiting on failure.
      (setupenv): Tidy up setting the environment.

commit de8c958ae55fd2bcfa8bab44db488cec5f194afa
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 26 22:59:42 2006 +0000

    * schroot/sbuild-auth.cc
      (~Auth): Shut down PAM if currently active.

commit 612a6eac77e029cd57e697154b007a3b7e86a966
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 26 22:15:53 2006 +0000

    * schroot/sbuild-keyfile.cc
      (check_priority): Add support for PRIORITY_DISALLOWED.
    * schroot/sbuild-config.cc: Convert to throw exception instead of
      immediately terminating with an error.  This makes unit testing
      possible, and errors are all caught correctly at the top-level.
    * schroot/sbuild-chroot-lvm-snapshot.cc: When reading a keyfile,
      only allow reading "lvm-snapshot-device" when restoring an active
      chroot.
    * configure.ac (AM_INIT_AUTOMAKE): Quote argument.
    * test/sbuild-config.cc: New file.  Test for sbuild::Config.

commit fa6f72332d7f05e7099737ef000923c9efbe4823
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 16 10:48:53 2006 +0000

    * po/vi.po: Add Vietnamese translation.

commit da65193e77a50864f44b2a6f8ee2b57af5dd53d2
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 13 22:53:22 2006 +0000

    * test/sbuild-log.cc: New file.  Test logging with stringbufs.
    * test/sbuild-nostream.cc (test_nostream): Fix whitespace.

commit d87a7b87e2fbc0acdd10d5341654406ab75852bd
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 13 19:22:56 2006 +0000

    * test/sbuild-nostream.cc: New file.  Test for nostream.
    * test/sbuild-environment.cc (add_simple_examples): Correct
      assertion.

commit 41532be70ec4a300c12d064062b5cdc85f315f1b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 12 23:09:05 2006 +0000

    * test/sbuild-lock.cc: New file.  Tests for locking.
    * schroot/sbuild-lock.cc (set_lock): If the current process
      doesn't own the lock, unlocking always succeeds.

commit c9a77f3f81e1d081bd0dce90af2c0a967b8fcfe6
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jan 12 17:24:54 2006 +0000

    * test/sbuild-keyfile.cc: New file.  Tests for keyfile.
    * schroot/sbuild-keyfile.h
      (set_value): Insert stringstream value, rather than templated
      value.
      (set_list_value): Fix bug with iterator by using binary operator +
      rather than +=.
      (operator <<): Print newline after key-value pairs.
    * schroot/sbuild-keyfile.cc
      (keyfile): Add constructor taking no arguments.
      (print_comment: Turn into static member function.

commit f7af3e9495d0a015b836cda026ff8961b1275dac
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 11 23:54:05 2006 +0000

    * test/sbuild-environment.cc: New file.  Tests for environment.
    * test/testmain.cc (main): Add debugging checks.
    * test/Makefile.am (libtest_la_LIBADD): Add libsbuild.la, and
      remove from all binary LDADD lines.
    * schroot/sbuild-util.cc (strv_delete): New function moved from
      sbuild-session.cc, with the iterator type corrected.
    * schroot/sbuild-session.cc: Remove strv_delete.
    * schroot/sbuild-environment.h: Fix constness of overloaded
      operators, and correct use of lvalue in binary operators.

commit bd3ce3674a9d6a8944cd606f8b3e56724efdfc6c
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Jan 11 11:45:43 2006 +0000

    * Remove completed and obsolete TODO items.
    * test/sbuild-util.cc: Update testcase with fixed path.
    * schroot/sbuild-session.cc (run_child): Use new
      find_program_in_path syntax.
    * schroot/sbuild-util.cc (find_program_in_path): Add path
      argument, to allow use of paths other than $PATH.

commit d25290610e9d0a9deb7ed75facae6a38aaafee2e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 8 19:38:19 2006 +0000

    * Update API reference.
    * test/sbuild-chroot-lvm-snapshot.cc: New file.  Tests for
      ChrootLvmSnapshot.
    * test/sbuild-chroot-block-device.cc: New file.  Tests for
      ChrootBlockDevice.
    * test/sbuild-chroot-plain.cc: New file. Tests for ChrootPlain.
    * test/test-sbuild-chroot.h: New file.  Base class for all chroot
      tests.
    * test/test-helpers.h (test_list): New file of test helper
      functions.  The initial function is a templated test for testing
      string_list getters and setters.
    * test/Makefile.am (noinst_LTLIBRARIES): Add libtest.la, a generic
      test library that contains the generic test runner and links with
      CppUnit.
    * schroot/sbuild-keyfile.h: Remove parse_value.
    * schroot/sbuild-environment.h (get): Use parse_value to parse
      values.
    * schroot/sbuild-parse-value.(cc|h): New files.  Split value
      parsing out from sbuild-keyfile to allow reuse.

commit 2bfe0f7c9635a3f167987dd0249ff2d3e250d332
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 7 10:54:23 2006 +0000

    * po/sv.po: Add Swedish translation.

commit c4264b4e68fc21de8d242611c30a9351771f7b6b
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jan 7 00:39:26 2006 +0000

    * Add copyright and GPL boilerplate to all testcase code.
    * test/sbuild-chroot.cc: New testcase for sbuild::Chroot.
    * schroot/sbuild-environment.cc (remove): For the "char **"
      overloaded method, use the correct iterator type (the same as the
      equivalent add function).
    * schroot/sbuild-environment.h (add): Specialise templated method
      for strings.
    * schroot/sbuild-environment.h (get): New templated method to
      retrieve the value of an environment variable by its name.

commit c9021e39b3324554a76986b3ddf3b3d7f06d741f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 6 16:30:27 2006 +0000

    * doc/Makefile.am (all-local): Don't rebuild doxygen documentation
      when not in maintainer mode.
    * configure.ac: Enable maintainer mode.

commit d744e6fa2846855c1a457ec05ca951143d3f3b03
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jan 6 15:55:30 2006 +0000

    * debian/rules: Build and run the testsuite in the build target.
    * debian/control (Build-Depends): Add libcppunit-dev.
    * schroot/sbuild-util.cc
      (find_program_in_path): Split PATH on ':' characters.
    * test/sbuild-util.cc: New file: tests for sbuild-util functions.
    * test/testmain.cc: New file: test runner for all tests.
    * configure.ac: Add check and conditinal for CppUnit.
    * Makefile.am (SUBDIRS): Add test directory.

commit 4e46cb031a26af34e6ac7c2e6e5df68256c58491
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 3 19:52:34 2006 +0000

    * schroot/sbuild-session.cc
      (unnamed namespace): Add child_wait variable to allow debugging of
      child processes.
      (get_auth_status): Correct checks for null chroot.
      (run_impl): Correct checks for null chroot.
      (setup_chroot): Call closelog in child before exec.
      (run_child): Remove mount_location assertion, since for some
      chroot types this will fail.
      (run_child): Use command[0] rather than command[1], which may not
      exist.  Call closelog in before exec.
      (run_chroot): Loop on child_wait to allow a debugger to be
      attached to the child, if debugging is enabled.
    * schroot/sbuild-environment.cc (add): Use char ** for iterator
      type, and add additional checks for null.
      (add): Add stricter substring range checks
      (remove): Add stricter substring range checks.
    * schroot/sbuild-chroot.cc
    * schroot/sbuild-chroot-plain.cc
      (ChrootPlain): Move read_keyfile code into the constructor.
    * schroot/sbuild-chroot-lvm-snapshot.cc
      (ChrootLvmSnapshot): Move read_keyfile code into the constructor.
    * schroot/sbuild-chroot-block-device.cc
      (ChrootBlockDevice): Move read_keyfile code into the constructor.
    * schroot/sbuild-chroot.cc
      (Chroot): Move read_keyfile code into the constructor.
      (print_details): Print mount_location and mount_device if set for
      both session and non-session chroots.

commit b244350f45a502b499b9c9135e86114229ff738b
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jan 3 00:17:55 2006 +0000

    * schroot/sbuild-auth.cc: Log a warning if construction fails.
      Correct buggy user assertions.

commit 77dbf119af72ffdd4bbab2424ca5c668260681eb
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 2 23:53:53 2006 +0000

    * Actually commit the new environment class.

commit 01ab592e3cc851a2f740a33e8813b1c02fd597f3
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 2 21:36:54 2006 +0000

    * schroot/schroot-options.cc (Options): Rewrite the checks which
      decide which chroot configuration files should be read, depending
      upon the action specified.
    * schroot/schroot-options.h (all_used): new method to detect if
      any of the --all* options are in effect.
    * schroot/schroot.cc (main): If no chroots are available, warn
      rather than exiting with an error, since for several commands
      there may well not be any chroots defined.
    * schroot/sbuild-config.cc (validate_chroots): Correct inverse
      match which treated all correctly named chroots as being invalid.

commit bcbd9c517b464e3e66deadfe043a488923d7b32d
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jan 2 00:28:22 2006 +0000

    * schroot/sbuild-types.h: Remove env and env_list typedefs.
    * schroot/sbuild-session.cc: Remove env_list_to_strv helper,
      replaced by environment::get_strv().  Replace setup_env_var
      helper with environment add method.
    * schroot/sbuild-chroot.h: Chroot::setup_env() uses environment
      rather than env_list; derived classes also changed.  Removed
      setup_env_var helper.
    * schroot/sbuild-auth.h: Replace env_list with environment.
      Rename Auth::environment member to user_environment.
    * schroot/sbuild-auth.cc: Remove env_string helper.
    * schroot/sbuild-environment.(cc|h): New class sbuild::environment
      to replace sbuild::env_list and its associated helpers in a number
      of classes.  This is a collection of environment variables.

commit 2fb303323f241f4cf21d3b4ba34d9cb90beeaae0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 1 16:51:30 2006 +0000

    Ignore precompiled headers (.gch).
    Remove GObject generated sources (typebuiltins and marshallers).

commit 64f69009f8b8ecc7924d0ea191928c63b5888e44
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jan 1 16:48:43 2006 +0000

    * Updated copyright notices to include 2006 changes.
    * schroot/Makefile.am: Generate a sbuild.gch precompiled header,
      and include sbuild.h in all sources which previously included an
      sbuild header.  This should improve compilation speed.
    * Rename schroot.h to sbuild.h, and include all sbuild-*.h
      headers.
    * schroot/sbuild-auth.cc (run): Fix casting to "const void **".

commit a5d614c8d503b1324453cb2846059d47854c586e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 31 17:45:07 2005 +0000

    * schroot/sbuild-auth.cc (run): Fix casting to "const void **".

commit d643316f057461220fa764175ee2cdeca60c8b42
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 31 17:23:15 2005 +0000

    * schroot/Makefile.am (AM_CXXFLAGS): Add additional warning flags.
    * schroot/sbuild-auth.cc (run): Use a static_cast instead of a
      C-style cast.
    * schroot/sbuild-lock.cc (set_lock): Initialise the l_pid member
      of struct flock.

commit 11de1deb8a1a09823e7980e7db6d2cf86866e791
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 31 16:01:21 2005 +0000

    * Change all instances of "const T&" to "T const&" for
      consistency.

commit 9b1171cadd361abf16cf324201285f55aae69c7d
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 23:56:38 2005 +0000

    * schroot/sbuild-chroot-lvm-snapshot.cc (setup_session_info):
      Imbue ostream with "C" locale.
    * schroot/sbuild-config.cc (load): Imbue istream with "C" locale.
    * schroot/sbuild-keyfile.cc (keyfile): Imbue ifstream with "C"
      locale.
    * schroot/sbuild-chroot.h (setup_env_var): Imbue stringstream with
      "C" locale.
    * schroot/sbuild-keyfile.h: All stringstreams are imbued with the
      "C" locale for locale-independent formatting.
    * schroot/schroot-releaselock.cc (main): Use C++ locale setup.
    * schroot/schroot.cc (main): Use C++ locale setup.

commit 9092a990ba53b31e14a16e19b608100371662dc1
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 23:11:33 2005 +0000

    * schroot/schroot.cc (main): Use actions rather than old bool
      values.  Compute the session operation using the action type.
      Surround the entire function in a try/catch block, so that
      exceptions thrown during program execution are reported nicely.
    * schroot/schroot-options.cc
      (set_action): Only allow one action to be specified.
      (Options): Set the appropriate actions when parsing.  Session
      operations are represented within the action member.
    * schroot/schroot-options.h (schroot): Add action_type enum.  This
      is used to represent all actions the user may specify, rather than
      using a separate bool for each.  Remove the session operation
      member.

commit 789a73319ce47f92c80bbb75dbf3715760b58bc9
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 22:23:34 2005 +0000

    * schroot/schroot-options.h: Fix include guard naming scheme.
    * schroot/schroot-releaselock-options.(cc|h): New class for
      schroot-releaselock options parsing.  The options structure has
      been split out from schroot-releaselock.cc to create this new
      class.

commit 969db52b8eac951190b00bc4fcc7071bcb6a657d
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 17:59:19 2005 +0000

    * Replace all format_detail_* typedef usage with format_details.
    * schroot/sbuild-chroot.h (format_details): Templated member
      function to construct the correct format_details class template.
      This replaces all the format_detail_* typedefs.

commit 587fe9f3d93b30b8b5f149da7cfcb0c9f49dce76
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 17:20:13 2005 +0000

    * All code updated to use Chroot::chroot_ptr.
    * schroot/sbuild-config.cc (load): Create chroots from keyfile
      using Chroot::create.
    * schroot/sbuild-chroot.h: Chroots are created by a factory
      function returning a shared_ptr (chroot_ptr).  All chroot types
      have protected constructors, and must be created using the static
      create methods.

commit 5fef47f426c6e4341f86ac42c4618f8372a8125c
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 16:15:15 2005 +0000

    * schroot/sbuild-chroot.h
      (format_detail::operator <<): Fix justification.
    * schroot/sbuild-chroot.cc (read_keyfile): Set chroot priority.

commit 6b0e596d020133b71527cd676a8a8526faf985b8
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 15:56:45 2005 +0000

    * schroot/sbuild-config.cc (load): Insert chroot name into alias
      map in addition to alias names.

commit 67db597726f488ec8d313649f5f676bbb174591d
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 30 15:46:30 2005 +0000

    * schroot/sbuild-chroot-plain.cc (read_keyfile): Use keyfile
      priorities.
    * schroot/sbuild-chroot-block-device.cc (read_keyfile): Use
      keyfile priorities.
    * schroot/sbuild-chroot.cc (read_keyfile): Set chroot name from
      group name, and use keyfile priorities.
    * schroot/sbuild-keyfile.h
      (parse_value): New templated method to parse a key value and set
      the value of the specified value type.
      (get_value): Use parse_value, and add debugging messages.  Add
      overloaded method to check key priority.
      (get_list_value): Use parse_value.  Add overloaded method to check
      key priority.
      (set_list, set_list_value): Use std::boolalpha to get text
      representation of bool.
      (operator >>): Correct off-by-one errors with substring lengths.
    * schroot/sbuild-keyfile.cc (check_priority): New method to check
      if a key is required, optional, deprecated or obsolete.  Log a
      warning or error message if a key is missing or present when it
      should not be.
    * schroot/sbuild-config.cc
      (Config): Throw error if construction fails.
      (add_config_directory): Correct error message.
      (load): Chroot type defaults to "plain".  Log a warning if the
      chroot type is incorrect.
    * schroot/sbuild-log.cc (log_debug): Report the debug level when
      printing messages.
    * schroot/schroot.cc (main): Set the default debugging level to
      DEBUG_NOTICE.

commit ceaf30877b5e40d1a5d9b3f91e0ef18c7a1add83
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 17:59:40 2005 +0000

    * NEWS: Bump version to 2.0

commit e7719f0d174a9d445685d41abc6193413fd02f22
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 17:18:06 2005 +0000

    * doc/schroot.dox.in
      (PROJECT_NUMBER): Use @VERSION@.
      (WARN_LOGFILE): Log to schroot.log.

commit ac802488cdebf0b72153f6e746e0c7b3a9be50e7
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 16:04:40 2005 +0000

    * schroot/sbuild-nostream.h: Rename m_sbuf to nbuf.

commit c224b465a89874bd44afd222217a88006835776a
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 00:44:51 2005 +0000

    * configure.ac: Bump version to 0.2.0, following the C++ and
      doxygen work.

commit a03b7987919070df3b8cae36eac3495a106ae962
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 00:02:56 2005 +0000

    Add schroot-stamp.

commit 47386734895c34cee7ef812fd164fe3583a17752
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 29 00:02:03 2005 +0000

    * Add doxygen support to configure and doc/Makefile.am, and
      distribute the doxygen-generated documentation.

commit b753f756ae17587196991e2bd88a55b3738e1a88
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Dec 28 22:39:23 2005 +0000

    * schroot/schroot-options.cc: Always qualify string_list with
      sbuild::.

commit 4b0e45f5d05212da506eb4757925173ea2a20994
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Dec 28 22:37:41 2005 +0000

    * schroot/sbuild-auth-conv-tty.h: (sbuild::AuthConvTty): Rename
      conversation_impl to conversation.
    * schroot/sbuild-auth-conv.h (sbuild::AuthConv): Remove
      conversation_impl method, replacing it with conversation.

commit 9728a7185e606870d685d68a1f18275a3044a4fa
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Dec 28 22:30:18 2005 +0000

    * Document remaining undocumented functions and typedefs.
      Implementations of pure virtual functions are not documented (a
      doxygen bug, Debian bug #324117).

commit de7428ff57436a77ca7b5a1c9029d6ad7bc4d03b
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Dec 28 19:00:34 2005 +0000

    * Convert all inline gtk-doc documentation to Doxygen format, and
      move it from the sources into the headers.

commit 458df93d3ddd6ddf9e55503e0c5d9a2234ccc6f4
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 26 16:52:55 2005 +0000

    Remove gtk-doc data.

commit 97635a217afef3a436586283de353feb684909d6
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 26 15:09:37 2005 +0000

    * Convert all classes to use runtime_error_custom, and remove all
      error code enums.
    * schroot/sbuild-error.h: Remove Exception class, and replace with
      a runtime_error base class, and runtime_error_custom<> template
      class (templated on class using it), which no longer has an error
      code member (the error code was a GError holdover which was not
      used).

commit 14bd54c87e73905f821f1f26f7f7e458e7dd8421
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 26 14:35:08 2005 +0000

    * schroot/sbuild-session.c:
      (run_impl, setup_chroot): Add mising format strings.

commit f1406ba59fa4c92c7843efddbe543aa8f7a3fe32
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 26 14:24:58 2005 +0000

    * Remove typedef'd enums in favour of plain enums.

commit 02f49b1b90e2f02b076af26988c554fbd46aa533
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 26 14:18:06 2005 +0000

    * schroot/sbuild-session.cc (is_group_member): Use new rather than
      C99 VLAs.
      (setup_chroot): setup_type_string is a std::string, rather than a
      char *.
    * schroot/sbuild-config.cc (validate_chroots): Return bad_chroots.
    * schroot/sbuild-chroot.cc (read_keyfile): Initialise bool values
      to quell compiler warning.
    * schroot/sbuild-auth.h (ErrorCode): Remove trailing comma.
    * schroot/sbuild-auth.cc
      (auth_conv): Use signed rather than unsigned int in for loops.
      (Auth::Auth): Correct member initialisation order.
    * schroot/Makefile.am (AM_CXXFLAGS): Add additional flags: -Wall
      -Wcast-align -Wwrite-strings -pedantic -Wcast-qual
      -Wredundant-decls.

commit 9c46b344f659e2b29050dc5cbe832d8e6f51dc82
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 25 14:55:01 2005 +0000

    * configure.ac: Remove checks for Glib.  Glib is now completely
      removed from the sources.
    * schroot/Makefile.am (libsbuild_la_LIBADD): Remove Glib library.
    * schroot/schroot-releaselock.cc: Convert from GOption to
      Boost.Program_options.

commit bf4b54b3b4a5d57b785ab9118c2daaeedd4787a5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 24 18:52:30 2005 +0000

    * schroot/sbuild-util.cc: Remove format_string.
    * Convert all uses of sbuild::format_string to boost::format.
    * schroot/sbuild-error.h (sbuild): Add a constructor which gets
      its message from a boost::format, rather than a std::string.

commit 9254f97fb957cd8b83a748ac3d4d28e89f2541de
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 24 13:39:25 2005 +0000

    * debian/control (Build-Depends): Add libboost-dev and
      libboost-program-options.
    * schroot/Makefile.am (libsbuild_la_LIBADD): Add BOOST_LIBS.
    * configure.ac: Add checks for Boost.Format and
      Boost.Program_options headers and shared libraries.

commit 2d257389e3e36f6dfacdf39186caff54ab4f99c8
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 23 00:53:46 2005 +0000

    * schroot/sbuild-session.cc:
      (sbuild_session_setup_chroot_child_setup): Remove.
      (setup_chroot): Replace g_spawn_sync with fork(), exec() and
      wait().  The uid, gid and group list are set prior to calling
      exec, as with sbuild_session_setup_chroot_child_setup previously.
      (run_child): Replace g_get_current_dir with GNU libc getcwd, and
      replace g_find_program_in_path with find_program_in_path.
      (wait_for_child): The variable to store the child exit status is
      passed in by reference, rather than being fixed.
    * schroot/sbuild-keyfile.h (keyfile::get_list_value): Use
      split_string instead of get_list_items.
    * schroot/sbuild-keyfile.cc (get_list_items): remove.
    * schroot/sbuild-util.cc
      (split_string): New function to split a string into a string_list,
      based upon sbuild::keyfile::get_list_value, but allows
      specification of a custom split character.  *
      (find_program_in_path): New function to search for an executable
      in $PATH.  A replacement for g_find_program_in_path.

commit 5f22d29531f7a6940bca7da363d0d7c65a78e9f2
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Dec 22 22:27:55 2005 +0000

    * schroot/sbuild-chroot.h (sbuild::Chroot::format_detail):
      template helper class to simplify streaming outout of chroot
      details.  Used by all derived chroot classes.
    * All Glib string functions have been replaced with the C++ or C99
      equivalent.
    * All uses of g_return[_val]_if_fail have been replaced with
      conditionals or static assertions.
    * All Glib logging and message functions have been replaced with
      the new logging functions and standard C++ streams.
    * All Glib types have been completely removed, with the exception
      of one instance of GError, and two uses of GOption.
    * Support for gtk-doc has been disabled and partially removed.
    * The dependency upon libsigc++ has been removed.  Virtual
      functions are used instead, which will provide more safety and
      security.
    * schroot/sbuild-keyfile.(cc|h): New class sbuild::keyfile, a
      replacement for GKeyFile.  Unlike GKeyFile, it uses templated
      methods to allow its use with any streamable type, in a type-safe
      manner.  The existing GKeyFile helper functions have been removed.
    * schroot/sbuild-log.(cc|h): New file: logging functions to
      replace the Glib print and logging utility functions.  Unlike the
      Glib types, these are based around ostreams.
    * schroot/sbuild-nostream.(cc|h): New class sbuild::basic_nostream
      with nostream and wnostream typedefs.  This is a "null ostream",
      which is a bit-bucket stream which discards all input.
    * schroot/sbuild-types.h: New file: commonly-used types.
    * Continue purge of Glib.

commit 7315e4a8c5c5cc0d08fa352de82b31c85e209ffc
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 19 13:21:33 2005 +0000

    * schroot/Makefile.am: Replace $(GOBJECT_LIBS) with $(GLIB_LIBS).
    * configure.ac: Replace check for GObject with a check for GLib,
      and adjust $SCHROOT_CFLAGS accordingly.
    * Remove GObject support.

commit 65c2ea4833f4add2060cfce75e2021042b60024f
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 19 13:11:57 2005 +0000

    * Replace all use of glib/gi18n.h with sbuild-i18n.h.
    * schroot/sbuild-i18n.h: New file: gettext macros.

commit 9a88eeb1cad11c5acc7e70b86c66f7dae7910ab8
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Dec 19 12:48:29 2005 +0000

    * schroot/sbuild-auth-conv-tty.cc, sbuild-auth.cc: Add support for
      iostream.
    * Replace most uses of g_strdup_printf with format_string.
    * schroot/sbuild-util.cc (format_string): New function to create a
      std::string from a C-style format string.

commit 9cdaa5dee8438fd1a8457f9672e536241254ca88
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 18 23:44:42 2005 +0000

    * Remove GLib types (gboolean, gchar, gint), and replace with
      standard C++ types.

commit 59c146be3542d359a6c044b17d3917ed30e0f160
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Dec 18 20:38:32 2005 +0000

    * All typedefs and enums have been moved into the class
      declarations, with the Sbuild and Object prefixes removed.
    * GError error propagation has been replaced with
      sbuild::Exception<> in all code.  The catch blocks are still
      local, simply replacing GError, but this will be fixed up later.
    * All Sbuild objects are in the "sbuild" namespace, and Schroot
      object are in the "schroot" namespace, with the prefix removed
      from the class names.
    * schroot/sbuild-error.h: Remove GError/GType glue, and replace
      with a simple templated exception class derived from
      std::runtime_error, initially to replace GError in a compatible
      manner.

commit d5a19d9fc8c7b9b191c79c5618ed86c71c8f3a1a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Dec 17 13:03:20 2005 +0000

    * schroot/sbuild-config.cc (load): Add GKeyFile error checking.
    * schroot/sbuild-chroot-lvm-snapshot.cc (read_keyfile): New
      private method to read a GKeyFile.
    * schroot/sbuild-chroot-block-device.cc (read_keyfile): New
      private method to read a GKeyFile.
    * schroot/sbuild-chroot-plain.cc (read_keyfile): New private
      method to read a GKeyFile.
    * schroot/sbuild-chroot.cc (read_keyfile): New private method to
      read a GKeyFile.
    * schroot/sbuild-keyfile.h: New file.  Simple wrapper funtions for
      interfacing with GKeyFile.

commit 899564055ea784475c829143ffdfead1a8e22aed
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Dec 16 10:42:02 2005 +0000

    * Convert all sources from GObject-based C to ISO C++.  This
      conversion is not yet complete, but builds without error.

commit b9943d4a299d2f1cd9dc078e8852b71da0c08915
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Nov 7 19:45:25 2005 +0000

    * debian/changelog: Update.
    * debian/schroot.init: Remove "function" bashism.

commit 95b08542cf7e3fba5b67c8d24c82785f342ab45d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 5 15:21:45 2005 +0000

    * debian/changelog: Update.
    * debian/rules (config.status): Use /usr/lib rather than
      ${prefix}/lib for libexecdir, to avoid unexpanded shell vars in
      config.h.

commit 88ab7052a47f5c4187b572ac974e369161e06eae
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 5 14:28:02 2005 +0000

    * schroot/sbuild-session.c (is_group_member): Don't fail if the
      supplementary group count is 0.  Also check the process' GID in
      addition to the supplementary groups.

commit 29f0f0b95a7e536ae2be09f0da68c62ae638c3b5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 5 14:24:38 2005 +0000

    * debian/changelog: Update for 0.1.8.
    * NEWS: Update for 0.1.8.
    * configure.ac: Update version to 0.1.8.

commit 78acd481c9237c8b3e23e99e835d326cd184b933
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Nov 5 00:18:47 2005 +0000

    * Version 0.1.7.
    * debian/changelog: Update date.
    * NEWS: Update.

commit 456a31110ab58884c1da81815b382e549168bde0
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Nov 4 19:32:09 2005 +0000

    * TODO: Remove completed items, and update new items.
    * README: Document new build dependencies.
    * schroot/schroot.conf.5.in: Add new chroot options to the examples.
    * schroot/schroot.conf: Add new chroot options to the examples.
    * schroot/schroot-setup.5.in: Document the setup and run scripts.

commit 96fd6e1bafee5aec6ce24bf5b94deaa9fe37bb57
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Nov 3 22:55:21 2005 +0000

    * debian/schroot.init: Use --quiet option to suppress an
      unnecessary error message.
    * schroot/schroot.c
      (main): If --quiet is used, don't print an error message if no
      chroots are defined.  Remove check for --quiet and --verbose, now
      moved to schroot_options_parse.
    * schroot/schroot-options.c
      (schroot_options_parse): Check if both --quiet and --verbose have
      been specified.

commit bfc24b0753ce847df56a62e16e0eddacd6c15362
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Nov 2 23:32:36 2005 +0000

    * schroot/sbuild-session.c
      (sbuild_session_run): Ensure child exit status is set to
      EXIT_FAILURE on session failure.
      (sbuild_session_init): Set child exit status to EXIT_SUCCESS by
      default.
    * debian/changelog: Document changes.
    * debian/rules (binary-arch): Use dh_installinit to install init
      script.
    * debian/schroot.init (NAME): New init script to perform session
      recovery at system startup.

commit 2cda911399c27d7ce66ac0c3ddf2f0c8758be05b
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Nov 2 22:32:51 2005 +0000

    * schroot/schroot-options.c
      (schroot_options_parse): Don't load all chroot configurations when
      in list mode.

commit 115a90aaf1b0eb3b63484588785afa2c3f129454
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Nov 2 18:46:50 2005 +0000

    * schroot/schroot.c
      (main): Delegate the decision about which chroot configuration
      files to load to schroot_options_parse.  Use
      sbuild_config_print_chroot_info to print chroot information.
    * schroot/schroot-options.h
      (struct _SchrootOptions): Add load_chroots and load_sessions
      members.
    * schroot/schroot-options.c
      (schroot_options_parse): Determine which chroot configuration
      files to load more accurately.
    * schroot/sbuild-config.c
      (sbuild_config_print_chroot_info): New function, split out from
      main() in schroot.c.

commit 051385943786893b04f55c31dd47f9f04940ef60
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Nov 1 19:37:09 2005 +0000

    * Updated documentation.
    * schroot/schroot.c: Update to use the new SchrootOptions option
      parsing:
      (get_chroot_options): An SchrootOptions struct is passed as an
      argument, since the options are no longer global.
      (main): Create and free an SchrootOptions struct.
    * schroot/schroot-options.[ch]: New files.  The command-line
      option parsing has been split out of schroot.c, with an new
      SchrootOptions struct to contain the parsed options.

commit 90fca14b127c50df9a7f87fb9100066e3c7daa2e
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 30 23:13:28 2005 +0000

    * schroot/schroot.1.in: Document --recover-session.
    * schroot/setup/*: Add support to setup scripts for
      "setup-recover" option.  In particular, filesystems are all
      remounted, and all "setup-start" tasks are performed, except for
      snapshotting.
    * schroot/schroot.c
      (parse_options): Add "--recover-session" session option.
      (parse_session_options): Parse "--recover-session".
      (main): Update configuration file loading to account for recovery.
    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): Add support for "setup-recover"
      argument in scripts.
      (sbuild_session_run): Add support for session recovery option.
    * schroot/sbuild-session.h
      (SbuildSessionOperation): Add SBUILD_SESSION_OPERATION_RECOVER.
    * schroot/sbuild-chroot.h
      (SbuildChrootSetupType): Add SBUILD_CHROOT_SETUP_RECOVER.

commit bd45085c5440229ca5c0eb1c75a9e551b9ffd3c5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 30 18:37:06 2005 +0000

    * schroot/schroot.c
      (main): Allow selection of non-session chroots as sessions, in
      order to allow session-like behaviour for all chroots, even those
      that can't natively support sessions.
    * schroot/sbuild-session.c
      (sbuild_session_run): Don't append a UUID to the session ID if the
      chroot does not support session creation.

commit da14f42d65d22e7ee31183a83c85f41e3a072df9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 30 18:07:24 2005 +0000

    * schroot/schroot.c (main): Abort if more than one chroot is
      specified when starting a session.

commit a9ea72c39ecce73ca95702a86fc576766c4da083
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 28 20:31:19 2005 +0000

    * schroot/schroot.c
      (parse_options): Remove unused "UUID" argument description for
      running and ending sessions.
      (main): Don't set the session id.
    * schroot/sbuild-session.c
      (sbuild_session_run): If not running or ending a session, generate
      a session ID in the form "chroot_name-uuid".

commit 548e538caf914a03137e7a7520aecd35406f6055
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 28 10:48:24 2005 +0000

    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): Propagate GError from
      sbuild_chroot_setup_lock.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_setup_lock): Use GError.  Refactor to
      propagate GError on failure, and reduce the number of return
      points.
      (sbuild_chroot_lvm_snapshot_setup_session_info): New function,
      split out from sbuild_chroot_lvm_snapshot_setup_lock to increase
      readability.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_setup_lock): Use GError.  Refactor to
      propagate GError on failure, and reduce the number of return
      points.
    * schroot/sbuild-chroot-plain.c
      (sbuild_chroot_plain_setup_lock): Use GError.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_error_quark): New function.
    * schroot/sbuild-chroot.h
      (SbuildChrootError): Add error enum.
      (SbuildChrootSetupLockFunc): Add a GError.

commit c3d94236c4b837b21db3470bc0bcec8d194d137f
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Oct 27 18:25:54 2005 +0000

    * schroot/sbuild-config.c
      (sbuild_config_clear_chroot_list): New helper function to clear
      stored chroot list.
      (sbuild_config_clear): New function; uses
      sbuild_config_clear_chroot_list.
      (sbuild_config_finalize): Use sbuild_config_clear_chroot_list.

commit 0e943ba3d655ddbfeb882abfea2d21931fda8667
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 23 18:43:49 2005 +0000

    * TODO: Remove chroot default item.
    * schroot/schroot.1.in: Document default fallback.
    * schroot/schroot.c (get_chroot_options): Fall back to "default"
      chroot if no chroot was specified.

commit 6b1e1d8487e812667e321d45d87daa7d609401a0
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Oct 23 18:30:42 2005 +0000

    * po/en_GB.po: Updated translation.
    * TODO: Update.  All locking and session items removed now that
      they are implemented.
    * schroot/schroot.1.in: Document new "--all-chroots" and
      "--all-sessions" options.
    * schroot/schroot.c: Add "--all-chroots" and "--all-sessions"
      command-line options.
      (get_chroot_options): Use new "--all" options.
      (get_chroot_options): Print a list of invalid chroots found during
      chroot validation.
      (main): Create the configuration using sbuild_config_new(), and
      add the approprate configuration and session configuration
      depending on the command-line options used.
    * schroot/sbuild-session.c
      (sbuild_session_run): When restoring a session, set the session ID
      from the chroot name.
      (sbuild_session_run): The session operations are only run if
      specified in the session operations.
    * schroot/sbuild-config.c
      (sbuild_config_new): New function.  This does not load any
      configuration files.
      (sbuild_config_add_config_file): New function, renamed from
      sbuild_config_set_config_file.  This now exported.
      (sbuild_config_add_config_directory): New function, renamed from
      sbuild_config_set_config_directory.  This now exported.
      (sbuild_config_find_generic): Cope with the case that no chroots
      exist.
      (sbuild_config_get_chroot_list): Cope with the case that no
      chroots exist.
      (sbuild_config_validate_chroots): Return a list of invalid chroot
      names, rather than FALSE.
      (sbuild_config_class_init): "config-file" and "config-directory"
      are no longer construct-only.  Both properties are now completely
      virtual, with no corresponding member data (a single filename no
      longer makes sense when multiple configuration files may be added
      at any time).
    * schroot/sbuild-config.h (struct _SbuildConfig): Removed file
      member.
    * schroot/sbuild-chroot.h: Fix function misordering.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_print_config): Print "active" property, don't
      translate any option names, and format "mount-device" correctly.
      (sbuild_chroot_set_property): Add the PROP_ACTIVE property.
      (sbuild_chroot_class_init): Make "active" a construction property;
      this is not documented, as it is not intended for use by users; it
      is for session recovery.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_print_config): Chain up using the
      print_config vfunc.
      (sbuild_chroot_lvm_snapshot_setup_lock): Use
      sbuild_chroot_print_config rather than
      sbuild_chroot_print_details.

commit 3f32c377df558c952943596e08dec8187652676b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Oct 20 22:23:27 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_run): Set and unset the
      chroot "active" property before and after running a session.
    * schroot/sbuild-config.c (sbuild_config_load): Remove active
      argument from sbuild_chroot_new_from_keyfile call.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_class_init): Make "active" property writable, and
      add methods to get and set the active property.
      (sbuild_chroot_new_from_keyfile): Remove active argument.

commit 39d833aab68b9b605214c67a7ca76ca6f97b316b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Oct 20 20:28:55 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_run): If a chroot sets
      SBUILD_CHROOT_SESSION_CREATE, update the chroot name with the
      session name.
    * schroot/sbuild-chroot.h (SbuildChrootSessionFlags) Removed
      unused session flags, and renamed SBUILD_CHROOT_SESSION_PERSISTENT
      to SBUILD_CHROOT_SESSION_CREATE.  All chroot types updated to
      reflect the change.

commit 88e0bfb129615839d59cf3cafc9e499c80a50bd9
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Oct 20 18:05:16 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_run): For LVM
      snapshots, set the chroot name to the session name.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_setup_lock): Write out a session file
      on session startup, and remove it when stopping the session.

commit f378c58d4ca2303a1d33fc14f1b3878451537198
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 17 23:21:09 2005 +0000

    * debian/rules (config.status): Add --libexecdir option to
    configure.
    
    * schroot/run/00check: Print new environment variables.
    
    * schroot/setup/05lvm: Use schroot-releaselock to release snapshot
      device lock just prior to snapshot removal.
    * schroot/setup/00check: Print new environment variables.
    * schroot/schroot-setup.5.in: Document new environment variables.
    * schroot/sbuild-session.c (sbuild_session_setup_chroot): Add
      LIBEXEC_DIR and PID setup environment variables.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_setup_lock): Don't unlock device at
      setup stop.
    * schroot/Makefile.am
      (pkglibexecdir): Set to $(SCHROOT_LIBEXEC_DIR).
      (pkglibexec_PROGRAMS): Add schroot-releaselock.
    * schroot/schroot-releaselock.c: New program to release device
      lock files using liblockdev.
    * configure.ac: Add SCHROOT_LIBEXEC_DIR define and substvar.

commit f3406e18e7388eccfd33ed069acc7f1e8d37d62a
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 17 22:15:31 2005 +0000

    * schroot/sbuild-lock.c (sbuild_lock_set_device_lock): Remove
      debugging print and sleep statements.

commit cda7775c1991b9298d142c31468ac2b888d64d41
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 17 20:30:05 2005 +0000

    * Update documentation.
    * schroot/sbuild-chroot.c (sbuild_chroot_class_init): Remove the
      "current-users" and "max-users" properties, and associated object
      members and methods.

commit 2de8a5c13429cdf481a8fe759cedb65ce6675720
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Oct 17 20:15:18 2005 +0000

    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_setup_lock): The device lock is held
      on the source device during snapshotting (setup start), and on the
      snapshot device from run start to run stop and then during setup
      stop while the chroot is destroyed.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_setup_lock): The device lock is held
      throughout the entire session.  It is acquired at setup start and
      released at setup stop.  This uses the new sbuild-lock device
      locking primitives.
    * schroot/sbuild-chroot.h: SbuildChrootSetupLockFunc uses a
      mutable chroot object.  All implementations of the setup_lock
      vfunc have been changed accordingly.
    * schroot/sbuild-lock.c
      (sbuild_lock_set_device_lock): New function.  Lock a device using
      liblockdev.
      (sbuild_lock_unset_device_lock): New function.  Unlock a device
      using liblockdev.

commit b30fb180ec81b8202ba005cebd6af84a66afda4c
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 14 21:38:39 2005 +0000

    * debian/changelog: Bump version to 0.1.7.
    * debian/control (Build-Depends): Add liblockdev1-dev.
    * schroot/Makefile.am (schroot_LDADD): Add $(LOCKDEV_LIBS).
    * configure.ac: Check for liblockdev.
    * Bump version to 0.1.7.

commit 54ddb73a9fa358f921f131d893ea9908902f2909
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Oct 14 17:59:25 2005 +0000

    * schroot/schroot.1.in: Restore session options.
    * schroot/schroot.c (parse_options): Restore session options.

commit 7f45914afe167ae633bc0825f46cec0e6546f542
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 12 23:23:30 2005 +0000

    * Version 0.1.6.
    * debian/changelog: Update
    * TODO: Update.
    * NEWS: Update.
    * schroot/schroot.1.in: Remove unused session options.
    * schroot/schroot.c: Disable unused session options.

commit 1df91be397442292a927acae3b4907c02ad8d166
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 12 23:03:11 2005 +0000

    * All manpages updated to document the new names and directory
    locations.
    
    * schroot/sbuild-chroot.h: Rename SBUILD_CHROOT_SETUP_START and
      SBUILD_CHROOT_SETUP_STOP to SBUILD_CHROOT_RUN_START and
      SBUILD_CHROOT_RUN_STOP.  Users of the enum changed to use the new
      names.
    * session.d script "session-start" and "session-stop" script
      arguments renamed to "run-start" and "run-stop".  All scripts
      changed to use the new names, and sbuild-session.c runs the
      scripts with the new new names.
    * Rename schroot/session to schroot/run.  Install scripts into
      $sysconfdir/schroot/run.d.  Update configure.ac, and
      schroot/Makefile.am.

commit 2af0be183d61cb284c457fb3c825a9e4562a11cb
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 12 22:14:22 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_setup_chroot): Use new
      function names.
    * schroot/sbuild-chroot-lvm-snapshot.c: Use new vfunc names.
      (sbuild_chroot_lvm_snapshot_setup_lock): stat devices, but still
    needs liblockdev support for full locking.
    * schroot/sbuild-chroot-block-device.c: Use new vfunc names.
      (sbuild_chroot_block_device_setup_lock): stat devices, but still
      needs liblockdev support for full locking.
    * schroot/sbuild-chroot-plain.c: Use new vfunc names.
      (sbuild_chroot_plain_setup_lock): Do no locking by default.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_setup_lock): Renamed from
      setup_chroot_get_setup_name.
      (sbuild_chroot_setup_env): Renamed from sbuild_chroot_setup.
      (sbuild_chroot_class_init): Use new vfunc names.
    * schroot/sbuild-chroot.h (struct _SbuildChrootClass): Rename
      setup to setup_env and get_setup_name to setup_lock, which now
      returns gboolean on lock failure.

commit 32850d686edbc7bb4322ccec5252d27943bc5641
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Oct 5 18:37:12 2005 +0000

    * debian/changelog: Manual pages say "schroot" rather than
      "sbuild".  Closes Debian Bug #331550.
    * schroot/schroot.conf.5.in: Use "schroot" rather than "sbuild".

commit 5f46190c0e1c6f54a7445404c41c8bf1e783dcde
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Oct 1 18:04:30 2005 +0000

    * configure.ac: Output schroot-setup.5
    * schroot/Makefile.am (man_MANS): Add schroot-setup.5
    * schroot/schroot.1.in: Remove setup script documentation.
    * schroot/schroot-setup.5.in: New file, documenting setup script
      environment.

commit fe6e06fb4e929de6b6fb57644c750995ef389cbb
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Oct 1 16:12:22 2005 +0000

    * schroot/setup/Makefile.am: Distribute 05lvm.
    * schroot/setup/10mount: Use new LVM variables, so snapshot names
      and mount locations are as set by the session.  Remove mount
      directory after unmounting, but only if it's under $MOUNT_DIR.
    * schroot/setup/05lvm: Use new LVM variables, so snapshot names
      and mount locations are as set by the session.
    * schroot/setup/00check, schroot/session/00check: Add MOUNT_DIR,
      SESSION_ID, CHROOT_LVM_SNAPSHOT_NAME and
      CHROOT_LVM_SNAPSHOT_DEVICE.
    * schroot/schroot.c
      (parse_options): Free the option context after use.
      (main): If a session ID was not specified, generate a UUID for the
      session.
      (main): Free the chroot list to make valgrind happy.
    * schroot/schroot.1.in: Document MOUNT_DIR, SESSION_ID,
      CHROOT_LVM_SNAPSHOT_NAME and CHROOT_LVM_SNAPSHOT_DEVICE
      environment variables.
    * schroot/sbuild-session.c
      (sbuild_session_get_session_id): session-id is no longer required
      to be a UUID.
      (sbuild_session_set_session_id): session-id is no longer required
      to be a UUID.  Allow setting of arbitrary strings.
      (sbuild_session_setup_chroot): Export MOUNT_DIR and SESSION_ID in
      the environment.
      (sbuild_session_run): Set the chroot mount location if the chroot
      did not already do so.
      (sbuild_session_run): For LVM snapshot chroots, set the snapshot
      name to the session ID.
      (sbuild_session_run): Cascade error handling properly on failure.
      (sbuild_session_class_init): Update session-id documentation now
      it is no longer a strict UUID.
    * schroot/sbuild-session.h (struct _SbuildSession): Change
      session_id type from uuid_t to gchar *.
    * schroot/sbuild-config.c (sbuild_config_load): Free GIOChannel,
      file data buffer and GKeyFile structure after use.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_print_config): Don't print NULL
      values.
      (sbuild_chroot_lvm_snapshot_setup): Don't set NULL values.  Set
      snapshot device name (path stripped) as CHROOT_LVM_SNAPSHOT_NAME.
      (sbuild_chroot_lvm_snapshot_get_setup_name): Implement
      get_setup_name vfunc.  This is of the form block-major-minor,
      obtained by stat()ing the block device.  For setup-start, this is
      the source LV, but for all other cases is the snapshot LV.
      (sbuild_chroot_lvm_snapshot_class_init): Added new
      "snapshot-device" property.  The "device" property is slaved to
      this value, and indirectly, the "device" property is also slaved.
    * schroot/sbuild-chroot-lvm-snapshot.h (struct
      _SbuildChrootLvmSnapshot): New snapshot_device member.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_print_details): Don't print NULL
      values.
      (sbuild_chroot_block_device_print_config): Don't print NULL
      values.
      (sbuild_chroot_block_device_setup): Don't set NULL values.
      (sbuild_chroot_block_device_get_setup_name): Implement
      get_setup_name vfunc.  This is of the form block-major-minor,
      obtained by stat()ing the block device.
    * schroot/sbuild-chroot-plain.c
      (sbuild_chroot_plain_print_details): Don't print NULL values.
      (sbuild_chroot_plain_print_config): Don't print NULL values.
      (sbuild_chroot_plain_setup): Don't set NULL values.
      (sbuild_chroot_plain_get_setup_name): Implement get_setup_name
      vfunc.  This is of the form directory-major-minor-inode, obtained
      by stat()ing the mount location.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_set_properties_from_keyfile): Don't leak GKeyFile
      string and string vector values.
      (sbuild_chroot_get_setup_name): New function.  Get the name for
      e.g. locking during setup.
      (sbuild_chroot_print_details): Don't print NULL values.
      (sbuild_chroot_print_config): Don't print NULL values.
      (setup_env_string): New helper function to build environment list.
      (setup_env_unsigned): New helper function to build environment list.
    * schroot/sbuild-chroot.h (struct _SbuildChrootClass): Add
      get_setup_name vfunc.
    * schroot/sbuild-auth.c (sbuild_auth_setupenv): Don't leak new
      environment.
    * schroot/Makefile.am (install-data-hook): Create mount directory.
    * configure.ac (SCHROOT_MOUNT_DIR): Add mount directory.

commit f245c89cb6f721f7ab35e44a01248866cfc0c21d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 27 22:21:35 2005 +0000

    * schroot/sbuild-lock.c: Minor documentation and error message
      tidying.

commit bc40de1fd5935a26de096cd3b45bf4d947d14382
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 27 21:56:38 2005 +0000

    * schroot/sbuild-config.c (sbuild_config_load): Report GError
      messages propagated by locking failure.
    * schroot/sbuild-lock.c
      (sbuild_lock_set_lock): Return errors as a GError, rather than
      aborting.  Don't run fcntl in a while loop now that timeouts are
      implemented with an itimer.
      (sbuild_lock_unset_lock): Return errors as a GError.
      (sbuild_lock_error_quark): New function.
    * schroot/sbuild-lock.h (SBUILD_LOCK_ERROR): Add error domain.
      Add locking errors as SbuildLockError enum.

commit 67142c4fc3a92c562dd37dea1f80324d740c6f19
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 27 21:03:29 2005 +0000

    * schroot/schroot.conf.5.in: Update documentation.
    * schroot/sbuild-chroot.c (sbuild_chroot_class_init): The
      run-session-scripts property defaults to FALSE, for compatibility
      with dchroot out-of-the-box.

commit 7c754fb7afd4853f4dae93a05407604f81c5d556
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 27 20:37:55 2005 +0000

    * Update documentation.
    
    * schroot/sbuild-config.c (sbuild_config_load): Acquire a read
      lock while reading schroot.conf.
    * schroot/schroot.h: Add sbuild-lock.h.
    * schroot/Makefile.am: Add sbuild-lock.[ch].
    * schroot/sbuild-lock.[ch]: New file, implementing simple
      whole-file advisory locking primitives.

commit 74fc11ea5bd5c2925ede637d5a75d304cf42383d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 25 23:27:57 2005 +0000

    * schroot/setup/00check: Remove "session-start" check.
    * schroot/session/00check: Remove duplicate "session-start" check.
    * schroot/session/50sbuild: New script to set up sbuild build
      directory and fix its ownership and permissions.

commit fc62969afa9d34800bfdfb6a9d8e0737469a1f71
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 25 15:57:03 2005 +0000

    * schroot/schroot.1.in: Document new session.d directory.
    * schroot/schroot.conf.5.in: Document run-setup-scripts and
      run-session-scripts options.
    * schroot/sbuild-chroot.c (sbuild_chroot_class_init): Replace
      run-setup property and associated accessors with two new
      properties, run-setup-scripts and run-session-scripts and
      associated accessors.  Setup script are not run by default,
      whereas session scripts are.
    * schroot/sbuild-chroot.h (struct _SbuildChroot): Replace
      run_setup with two members, run_setup_scripts and
      run_session_scripts.
    * schroot/Makefile.am (SUBDIRS): Add session.
    * schroot/session/00check: New session script.
    * schroot/session/Makefile.am: New file for installing session
      scripts.
    * configure.ac (SCHROOT_CONF_SETUP_D): New define and substitution
      variable.

commit 0558a1e83676f858f6302207873649d9ac3e0e1c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 25 14:34:59 2005 +0000

    * Update API reference.
    * schroot/schroot.1.in: Document new command-line options.
    * schroot/schroot.c: Add new session_opt struct, with operation,
      id and force members.
      (parse_options): Add new command line options: -b/--begin-session,
      -r/--run-session, -e/--end-session and --force in a new "session"
      option group.  These options do not currently have any effect.
      (parse_session_options): New helper function to parse session
      options.
      (main): Set session operation when creating a new session.  Set
      additional session properties (session-id, force) after
      construction.
    * schroot/sbuild-session.c (sbuild_session_class_init): Added new
      "operation" and "force" properties, and associated accessors.
      (sbuild_session_new): Add operation argument, and set the
      operation contruction property.
    * schroot/sbuild-session.h: Added SbuildSessionOperation enum to
      specify session operations.
      (struct _SbuildSession): Added new operation and force members.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_get_session_flags): New virtual
      function to get session flags.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_get_session_flags): New virtual
      function to get session flags.
    * schroot/sbuild-chroot-plain.c
      (sbuild_chroot_plain_get_session_flags): New virtual function to
      get session flags.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_get_session_flags): New function.  Calls
      get_session_flags vfunc.
      (sbuild_chroot_class_init): get_session_flags is pure virtual, so
      must be implemented in derived classes.
    * schroot/sbuild-chroot.h: Add SbuildChrootSessionFlags enum to
      specify chroot session behaviour.
      (struct _SbuildChrootClass): Added get_session_flags vfunc.

commit a7b6b5216477937a1bd00557398565d041320283
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 24 21:06:37 2005 +0000

    * debian/rules (config.status): Set $localstatedir when running configure.

commit 4409cc74e804fd681bfa6641a0b9841f67ee9c76
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 24 21:02:34 2005 +0000

    * schroot/schroot.1.in: Document new setup script parameters.
    
    * Modify all setup scripts to use the new setup names.
    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): Use SbuildChrootSetupTyoe to run
      the four different types of setup operation.
      (sbuild_session_run): Run the four different kinds of setup script
      in the correct order.
    * schroot/sbuild-chroot.h: Add SbuildChrootSetupType enum to
      replace internal SbuildSessionChrootSetupType.  This has
      enumerations for starting and stopping both chroot setup and
      session setup.

commit c8a9d9a4e309274b4bdee4a1b31b9bfe7693dd0d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 24 18:42:42 2005 +0000

    * schroot/sbuild-chroot.c
      (sbuild_chroot_set_properties_from_keyfile): Split keyfile
      property code out from sbuild_chroot_new_from_keyfile.  This will
      allow re-reading chroot configuration from disk for session
      handling.

commit 6468adba810badd78432ac134b5bba01f8cbdbd6
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Sep 24 15:41:38 2005 +0000

    * debian/preinst, debian/postinst: Preserve schroot.conf changes
      correctly when moving to /etc/schroot/schroot.conf, by checking
      the md5sum to detect local modifictions.  If not modified, delete
      and replace with the package version.

commit ad7c9fddc74ec8e169c0c7d83f48a29a2fa24bf3
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 22 19:53:38 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_run): Move chroot mount
      location fallback from sbuild_session_setup_chroot.
    * schroot/schroot.conf.5.in: Add additional "run-setup" notes.

commit 7ebdab4a69d591a4e9457105f7eabd6be4fa6f6e
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Sep 21 20:03:22 2005 +0000

    * debian/changelog: Bump version to 0.1.6.  Document run-setup
      changes for Debian Bug #329403.
    * schroot/schroot.conf.5.in: Document "run-setup" configuration
      option.
    * schroot/sbuild-session.c (sbuild_session_run): Only run setup
      scripts if enabled in the chroot configuration.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_class_init): Add "run-setup" property, and
      associated accessors.
      (sbuild_chroot_new_from_keyfile): Add support for G_TYPE_BOOLEAN
      properties as configuration options.
    * schroot/sbuild-chroot.h (struct _SbuildChroot): Add run_setup
      member.

commit b0b1001d59c9921fe6d8d9311f4c6544dba1a32d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 20 21:21:11 2005 +0000

    * schroot/sbuild-chroot.c
      (sbuild_chroot_new_from_keyfile): Fix a memory leak during chroot
      type identification.  Reorganise code to make layout more logical.
      (sbuild_chroot_print_details): Format detail listing to make it
      more readable, in the same style as used by the LVM tools.
    * schroot/sbuild-config.c (sbuild_config_load): Only add chroots
      to the SbuildConfig if they were successfully constructed.

commit 553db8679b834953fdf3ebd34aed4d11a28cd235
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 18 20:57:52 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_class_init): Add a new
      session-id property and associated accessors, which handle
      conversions between a string and uuid_t.
    * schroot/sbuild-session.h (struct _SbuildSession): Add a new
      session_id member containing the session UUID.
    * schroot/sbuild-config.c
      (sbuild_config_new_from_file): New function to replace
      sbuild_config_new.
      (sbuild_config_new_from_directory): New function to load a set of
      configuration files from a directory.
      (sbuild_config_class_init): config-file property is no longer
      readable.  Added new contruct only and write-only config-directory
      property.
      (sbuild_config_set_config_directory): New function to read a
      directory and load config files.
      (sbuild_config_load): Pass back the chroot list as an OUT
      parameter rather than a return value, to allow reusing the same
      list.
      (sbuild_config_set_config_file): Remove the restriction on loading
      a single config file.
    * schroot/sbuild-chroot-lvm-snapshot.c
      (sbuild_chroot_lvm_snapshot_print_config): New virtual function to
      print additional configuration details.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_print_config): New virtual function to
      print additional configuration details.
    * schroot/sbuild-chroot-plain.c
      (sbuild_chroot_plain_print_config): New virtual function to print
      additional configuration details.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_class_init): Added current-users, max-users and
      active properties, and associated accessors.
      (sbuild_chroot_new_from_keyfile): Add additional active parameter
      which is TRUE if reloading an existing session configuration.
      This relaxes permissions checks to allow setting of writable but
      not construction parameters.
      (sbuild_chroot_print_details): Print new properties.
      (sbuild_chroot_print_config): New function to write out current
      session state to a a configuration file for later restoration.
      (sbuild_chroot_setup): Set new properties as environment
      variables, except for active, since this is implicit in running a
      session).
    * schroot/sbuild-chroot.h
      (struct _SbuildChroot): Add current_users, max_users and active
      members.
      (struct _SbuildChrootClass): Add print_config vfunc.
    * debian/control (Build-Depends): Build-depend upon uuid-dev
    * schroot/Makefile.am
      (schroot_LDADD): Link with libuuid.
      (install-data-hook): Make SCHROOT_LOCK_DIR and
      SCHROOT_SESSION_DIR.
    * configure.ac:
      Check for libuuid and add UUID_CFLAGS to SCHROOT_CFLAGS.
      Add substitutions and defines for SCHROOT_LOCK_DIR and
      SCHROOT_SESSION_DIR.

commit d1f17a0cfdacb7bb50e0c18b9e821195daf1967f
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Sep 16 17:27:41 2005 +0000

    * schroot/sbuild-chroot.c (sbuild_chroot_new_from_keyfile):
      Require settable properties to be both constructible and writable.

commit 4c172acb547adc14c15a4e1d6437734dc61d3c31
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 15 21:33:12 2005 +0000

    * TODO: Update.
    
    * schroot/schroot.1.in: Document LVM snapshot script variables.
    
    * schroot/schroot.conf.5.in: Document LVM snapshot options.
    * schroot/setup/10mount: Hack LVM snapshot device name until it's
      supported by the session code.
    * schroot/setup/05lvm: New script to create and remove LVM
      snapshots.  Hack LVM snapshot device name until it's supported by
      the session code.
    * schroot/setup/00check: Report $CHROOT_LVM_SNAPSHOT_OPTIONS.
    * schroot/sbuild-chroot.c (sbuild_chroot_new_from_keyfile): Allow
      creation from type "lvm-snapshot".
    * schroot/sbuild-chroot-lvm-snapshot.[ch]: New files, implementing
      SbuildChrootLvmSnapshot, an object representing a chroot on a LVM
      logical volume which has a snapshot LV taken on demand, derived
      from SbuildChrootBlockDevice.

commit dee09cc221959e4c310866b417d6646eb808aada
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 15 18:49:00 2005 +0000

    * schroot/setup/Makefile.am (setup_SCRIPTS): Distribute 00check
      and 10mount.

commit 5e3b0309b95c21c1dbc1313e440db45e2b06df8c
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 15 18:27:02 2005 +0000

    * schroot/setup/10mount: Use $CHROOT_MOUNT_DEVICE.
    * schroot/setup/00check: Report $CHROOT_MOUNT_DEVICE.
    * schroot/sbuild-chroot-plain.c: Minor indentation fixes.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_set_mount_device): New function to
      slave the "device" property to the parent class "mount-device"
      property.
      Minor indentation fixes.
    * schroot/sbuild-chroot.c (sbuild_chroot_class_init): Added
      "mount-location" property and associated accessors.
    * schroot/sbuild-chroot.h (struct _SbuildChroot): Added
      mount_location member.

commit 0b8bbfaf8599dcfcb181e630ac39d510d4c18dfe
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Sep 15 17:56:46 2005 +0000

    * schroot/setup/50chrootname: Use ${CHROOT_MOUNT_LOCATION}.

commit fe66659abdb96cc1355b79d4dae6a54fc0f03eaf
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Sep 14 22:31:55 2005 +0000

    * schroot/schroot.conf.5.in: Document "mount-options".
    * schroot/setup/00check: Report $CHROOT_MOUNT_OPTIONS.
    * schroot/sbuild-chroot-block-device.c
      (sbuild_chroot_block_device_class_init): Added a "mount-options"
      property and associated accessors.
    * schroot/sbuild-chroot-block-device.h (struct
      _SbuildChrootBlockDevice): Added a mount_options member.

commit aae80c05e7391545366ca444c36bd2847da5a56a
Author: Roger Leigh <rleigh@debian.org>
Date:   Wed Sep 14 21:43:15 2005 +0000

    * Updated documentation.
    * schroot/setup/30passwd: Use $CHROOT_MOUNT_LOCATION.
    * schroot/setup/20network: Use $CHROOT_MOUNT_LOCATION.
    * schroot/setup/10mount: New script to mount block devices.
    * schroot/setup/00check: New script to do sanity checking before
      other scripts are run, and print the environment when run in
      verbose mode.
    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): Fall back to "/mnt" if no mount
      location is available.  This is temporary.
      (sbuild_session_setup_chroot): Set the environment correctly for
      subclassed SbuildChroot objects.
      (sbuild_session_setup_chroot_child_setup): New helper function to
      ensure that the setup scripts run as real and effective user and
      group root.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_get_chroot_type): New function, which calls the
      get_type vfunc.
      (sbuild_chroot_class_init): Renamed "location" property to
      "mount-location", and updated all methods accordingly.  "location"
      is now implemented only in SbuildChrootPlain.
      (sbuild_chroot_new_from_keyfile): Check the GKeyFile "type" key to
      check which SbuildChroot subclass to instantiate.  Add stricter
      checking of GKeyFile keys, by validating names and types against
      the registered properties for the GObjectClass, as well as
      checking if the properties are constructible and writable.
    * schroot/sbuild-chroot.h (struct _SbuildChrootClass): Added new
      get_type vfunc, for getting the type name of the chroot.
    * schroot/sbuild-chroot-block-device.[ch]: New files, implementing
      SbuildChrootBlockDevice, an object representing a chroot on a
      block device mounted on demand, derived from SbuildChroot.
    * schroot/sbuild-chroot-plain.[ch]: New files, implementing
      SbuildChrootPlain, an object representing a simple filesystem
      chroot, derived from SbuildChroot.
    * NEWS: Bump version to 0.1.6.
    * configure.ac: Bump version to 0.1.6.
    * schroot/sbuild-chroot.c (sbuild_chroot_new_from_keyfile): Warn
      if not constructible or writable types are used.

commit 79ca3b9ab90515ed1959b85302a688ff259a51ea
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Sep 13 21:34:11 2005 +0000

    * Translate g_warning messages.
    * schroot/schroot.c (main): When printing detailed chroot
      information, add a blank line between chroots.
    * schroot/sbuild-chroot.c (sbuild_chroot_new_from_keyfile): Parse
      options automatically by introspecting the GObject properties for
      a given chroot GType.  This will allow for automatic extension of
      the file format as new chroot types are added.

commit 3c8fbe03e26c9b11ee19831a820efc57e290b159
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Sep 12 22:20:48 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_setup_chroot): Call
      sbuild_chroot_setup to get chroot environment variables, and add
      additional auth environment variables to the same linked list.
      Convert the linked list into a vector.
    * schroot/sbuild-chroot.c (sbuild_chroot_print_details): Call
      print_details vfunc.
      (sbuild_chroot_setup): New function, used to set the environment
      in setup scripts.  It calls the setup vfunc to allow derived
      classes to set additional environment variables.
    * schroot/sbuild-chroot.h:
      (struct _SbuildChrootClass): New print_details and setup virtual
      functions.

commit 8ad7e61fdc364198464dc17f68495cbb7113b1f5
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 22:47:42 2005 +0000

    * Fixed minor typos in API reference.
    * Updated TODO.

commit 8804de9386f540f88385f021609036de15c17150
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 19:29:27 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_setup_chroot): Set
      AUTH_VERBOSITY, not AUTH_VERBOSE.
    * schroot/setup/50chrootname: Use $AUTH_VERBOSITY.
    * schroot/setup/30passwd: Use $AUTH_VERBOSITY.
    * schroot/setup/20network: Use $AUTH_VERBOSITY.
    * schroot/schroot.c (main): Fix pointer type warning.

commit 1105038f9ee7f14ff85cf25f9b3c11a90b996d54
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 18:59:17 2005 +0000

    * Update API reference.
    * schroot/schroot.1.in: Document new option, and the
      AUTH_VERBOSITY environment variable used in setup scripts.
    * schroot/schroot.c
      (parse_options): Add a new --verbose option.
      (main): Set requested verbosity level.
    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): Check verbosity level to set in the
      environment, and to pass to run-parts.
      (sbuild_session_run_child): Check verbosity level when printing
      information about the command being run.
    * schroot/sbuild-auth.c
      (sbuild_auth_get_verbosity): Replacement for
      sbuild_auth_get_quiet.
      (sbuild_auth_set_verbosity): Replacement for
      sbuild_auth_set_quiet.
      (sbuild_auth_class_init): Replace "quiet" property with
      "verbosity" property.
    * schroot/sbuild-auth.h:
      Add SbuildAuthVerbosity enum to specify message verbosity.
      (struct _SbuildAuth): Replace quiet member with verbosity member.

commit 328d3d571b83f33dc15bd7117b5664a85dac9244
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 15:39:20 2005 +0000

    * Version 0.1.5.
    * po/en_GB.po: Update.
    * debian/changelog: Update.

commit 17981975a0de0b70f6b8bacad34db346658ecabd
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 15:29:03 2005 +0000

    * debian/rules: Install the lintian override.
    * debian/schroot.lintian-overrides: New file to override
      setuid-binary lintian warning.

commit 0b0a36c0f23db5f121acbfbfd0388b1fe30f2ab7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 15:05:42 2005 +0000

    * schroot/Makefile.am (EXTRA_DIST): Correctly distribute
      schroot.conf.
    * debian/copyright (License): Update the FSF address.

commit e0e7cca1971e8e04302c12f393b68d6fa241d97a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Sep 11 14:19:06 2005 +0000

    * configure.ac:
      - Check for run-parts.
      - Define $PACKAGE_SYSCONF_DIR as the location for configuration files.
      - Define $SCHROOT_CONF_SETUP_D as the location for setup scripts.
    * schroot/Makefile.am (pkgsysconfdir): Install schroot.conf into
      $(PACKAGE_SYSCONF_DIR).
    * schroot/schroot.conf.5.in: Update date.
    * schroot/schroot.1.in: Add setup.d to FILES.  Update date.
    * schroot/setup/Makefile.am: Distribute and install 20network,
      30passwd and 50chrootname into $sysconfdir/schroot/setup.d.
    * schroot/setup/50chrootname: New file to set up chroot name in
      /etc/debian_chroot.
    * schroot/setup/30passwd: New file to set up passwd, shadow and
      group.
    * schroot/setup/20network: New file to set up resolv.conf.
    * schroot/sbuild-session.h: Add SBUILD_SESSION_ERROR_CHROOT_SETUP
      GError enum.
    * schroot/sbuild-session.c
      (sbuild_session_setup_chroot): New function to call run-parts(8).
      (sbuild_session_run): Call sbuild_session_setup_chroot before and
      after running the session command or shell.

commit 6307c9aeb601c974da03f07b91533ffd5f8437bd
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Aug 25 18:24:22 2005 +0000

    * schroot/schroot.c (main): Replace SCHROOT_CONFIG_FILE with
      SCHROOT_CONF.
    * schroot/Makefile.am (DEFS): Remove SCHROOT_CONFIG_FILE.
    * schroot/schroot.conf.5.in: Use @SCHROOT_CONF@, rather than the
      incorrect @prefix@/etc/schroot.conf.
    * schroot/schroot.1.in: Use @SCHROOT_CONF@, rather than the
      incorrect @prefix@/etc/schroot.conf.
    * configure.ac (PACKAGE_SYSCONF_DIR): Compute the final value of
      $sysconfdir before configure ends, and substitute and define
      SCHROOT_CONF with the location of schroot.conf.

commit 72aeeb44b24b60673719a948f2defc0b4e2a5fbb
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Aug 22 21:10:17 2005 +0000

    * schroot/sbuild-auth.c (sbuild_auth_require_auth_impl): Remove
      special root priveleges.
    * schroot/sbuild-session.c (sbuild_session_require_auth): Remove
      special root priveleges.

commit 70267d841fad4b79ae42b762d9ba9d92865b0261
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Aug 21 13:52:11 2005 +0000

    * schroot/Makefile.am: Added new source files.
    * schroot/schroot.c (main): Add support for SbuildAuthConv
      timeouts.
    * schroot/schroot.h: Added new headers.
    * schroot/sbuild-marshallers.list: Added new marshaller
      BOOLEAN:UINT,BOXED.
    * configure.ac: Remove check for libpam_misc.  Bump version to
      0.1.5
    * schroot/sbuild-auth.c: Add support for the conv member as a
      GObject property:
      (sbuild_auth_get_conv): New function.
      (sbuild_auth_set_conv): New function.
      (sbuild_auth_conv): New function; glue to interface PAM to
                          SbuildAuthConv.
      (sbuild_auth_start): Create a custom pam_conv which uses
                           sbuild_auth_conv to hook back into
                           SbuildAuthConv from PAM.
    * schroot/sbuild-auth.h: Add conv member to _SbuildAuthConv and
      sbuild_auth_get_conv and sbuild_auth_set_conv getters and
      setters, used to get and set the SbuildAuthConv interface used.
    * schroot/sbuild-auth-conv-tty.[ch]: New files, adding the
      SbuildAuthConvTty implementation of SbuildAuthConv.
    * schroot/sbuild-auth-conv.[ch]: New files, adding the
      SbuildAuthConv GInterface.
    * schroot/sbuild-auth-message.[ch] New files, adding the
      SbuildAuthMessagea and SbuildAuthMessageVector structures
      (registered as GBoxed types).

commit fabf7c8d974093c807d89b5e1a68f3903b6a229d
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 31 16:59:51 2005 +0000

    * Version 0.1.4.
    * NEWS: Update for 0.1.4.
    * po/en_GB.po: Update translation.

commit e252160862ef60c41047dd5b84fd0fa501154fbe
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 31 16:22:16 2005 +0000

    * schroot/sbuild-session.c (sbuild_session_run_child): Alter the
      message printed to stderr or logged with syslog, depending on
      whether the environment is being preserved (no login shell) or not
      (login shell).

commit 3e4e4338823a46afe32e3940411995b317bf6b61
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 31 14:59:11 2005 +0000

    * schroot/schroot.c (main): Set the service name to "schroot".
    * schroot/sbuild-session.c (sbuild_session_new): Set the
      SbuildAuth "service" construction property.
    * schroot/sbuild-auth.h (struct _SbuildAuth): Add service member.
    * schroot/sbuild-auth.c: Don't hardcode the PAM service name:
      (sbuild_auth_get_service): New function.
      (sbuild_auth_set_service): New function.
      (sbuild_auth_start): Use the service member when initialising PAM.

commit 6ac0bdf9c284e4340af5e15336a15b4e990f3030
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 31 10:46:14 2005 +0000

    * schroot/schroot.1.in: Include priority in the examples.
    * schroot/schroot.conf.5.in: Document new priority option and
      include it in the examples.
    * schroot/sbuild-chroot.h (struct _SbuildChroot): Add priority
      member.
    * schroot/sbuild-chroot.c
      (sbuild_chroot_get_priority): New function
      (sbuild_chroot_set_priority): New function
      (sbuild_chroot_new_from_keyfile): Parse priority

commit cf9131be6e8887647c2e09990230322c527fe9d9
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 31 10:09:50 2005 +0000

    * schroot/schroot.c (parse_options): Fix typo in documentation.
    * schroot/sbuild-session.c (sbuild_session_require_auth): Simplify
      by removing all redundant checks.

commit fd1dc770816c101ef194de89ada745088123e6c3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 17 17:27:36 2005 +0000

    * debian/control (Build-Depends): Add gettext.
    * Bump version numbers to 0.1.4.

commit 15ba0f2ff44fc7618630b693da58c1bc31ac86d8
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 17 15:48:13 2005 +0000

    * Version 0.1.3.
    * NEWS: Update for 0.1.3.

commit f7cf8d9f34c8b7df977898d26b7543bcfac16234
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 17 13:58:25 2005 +0000

    * schroot/sbuild-auth.c (sbuild_auth_setupenv): Add USER and
      LOGNAME to the list of environment variables to set if not
      preserving the old environment.

commit c6a9a2959637b499c72f92734eb4bb6233ca48be
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 17 12:23:18 2005 +0000

    * schroot/sbuild-auth.c
      (sbuild_auth_get_home): Add home directory property and get
      function for the session user.
      (sbuild_auth_setupenv): Add HOME to the list of environment
       variables to set if not preserving the old environment.

commit 056bf3d5f621f49f84b51e4b11fbd07051ab62cc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 17 10:16:32 2005 +0000

    * schroot/sbuild-session.c
      (sbuild_session_run_chroot): Split into two separate functions,
      sbuild_session_run_child() and sbuild_session_wait_for_child().
      (sbuild_session_wait_for_child): Notify the "child-status"
      property on change.

commit e73d4335e3639b2782df10a645ab3bb1e0e1dbfd
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 11 22:51:45 2005 +0000

    * TODO: Update.
    * Update gtk-doc documentation.

commit 4cfade3f55abf9de89243e1e5c5415ce0580cfa3
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 10 11:05:44 2005 +0000

    * schroot/schroot.c (main): Abort earlier if no chroots are
      defined in schroot.conf.

commit ac071c7425d7a92faae318115da5510e835776d7
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 9 12:37:05 2005 +0000

    * schroot/schroot.c (parse_options): Move the option entries[]
      array into the function as a static const variable.  Make sure the
      array is terminated by a null option entry, to prevent a segfault
      when parsing the options.

commit 00c6c1d218a278462c52674229616adac94d3b3b
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 8 17:13:45 2005 +0000

    * TODO: Update.
    * schroot/schroot.c (main): Use new SBUILD_AUTH casts and methods,
      to replace the corresponding SBUILD_SESSION types and methods.
    * SbuildSession derives from SbuildAuth.
      - The duplicated functionality has been removed from
        SbuildSession.
      - SbuildSession overrides the SbuildAuth virtual functions
        require_auth and session_run.

commit 54b3b33889412560709494a81b848942ca39db50
Author: Roger Leigh <rleigh@debian.org>
Date:   Fri Jul 8 17:05:23 2005 +0000

    * schroot/schroot.h: Add sbuild-auth.[ch].
    * schroot/sbuild-marshallers.list: Add new marshaller
      (sbuild_cclosure_marshal_BOOLEAN__BOXED).
    * Split SbuildSession PAM functionality into a separate SbuildAuth
      class, from which SbuildSession is derived.  SbuildAuth handles
      authentication and authorisation using PAM, with hooks for
      customising its behaviour.

commit a7cb8a736c7795a88db225dc0ee9d97d1ea7357b
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 7 20:33:04 2005 +0000

    * schroot/sbuild-session.h, schroot/sbuild-config.h: Make error
      quark functions publicly visible.

commit 2df286ab1139ba39e6408ff0dedbd6c643382af5
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 7 20:17:25 2005 +0000

    * schroot/schroot.c
      (entries): Make entries const, to fix compiliation with gcc-4.0.
      (parse_options): Check for parse errors, and exit on error.

commit 1db6585bdea007a43c7d0b1ec0ee6db2a3ecb422
Author: Roger Leigh <rleigh@debian.org>
Date:   Thu Jul 7 20:11:32 2005 +0000

    * schroot/sbuild-error.c, schroot/sbuild-error.h: Wrap GError as a
      GType (SBUILD_TYPE_ERROR and SBUILD_TYPE_ERROR_POINTER) for use
      with signals (GError * may be used as an "out" argument).

commit 69007ab277745ca9a9aae0477d8054b1cc80cfc4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jul 5 19:36:57 2005 +0000

    * po/.cvsignore: Ignore generated files.

commit 158c76cad284b35fde27b9dea35585610955d4b7
Author: Roger Leigh <rleigh@debian.org>
Date:   Mon Jul 4 22:45:30 2005 +0000

    * doc/schroot/schroot-docs.sgml: Include marshallers section.
    * doc/schroot/schroot-sections.txt: Add marshallers section.
    * schroot/schroot.h: New header.  This includes all other headers,
      and is used by glib-mkenums.
    * schroot/sbuild-marshallers.list: New file.  Generate a
      marshaller returning an enum and taking no arguments
      (sbuild_cclosure_marshal_ENUM__VOID).
    * schroot/Makefile.am: Generate GObject closure marshallers and
      GType typebuiltins.  Distribute the generated code.

commit 84a91127190b60209fe30597c1249d22958da795
Author: Roger Leigh <rleigh@debian.org>
Date:   Sun Jul 3 18:55:59 2005 +0000

    * configure.ac, NEWS, debian/changelog: Increase version number to 0.1.3.

commit b4df1b75024090ce681ded4cb28f710d5591b673
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 2 19:04:00 2005 +0000

    * Version 0.1.2.
    * schroot/sbuild-session.c
      (sbuild_session_pam_setupenv): If no environment was specified,
      create an initial environment containing PATH and TERM.
      (sbuild_session_run_chroot): Search PATH for the specified
      command, in case the user didn't use an absolute path.

commit f130eb678777379be19d216fc0d00936e3de577f
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 2 17:33:49 2005 +0000

    * README: Remove usage examples.
    * schroot/schroot.conf.5.in: Don't indent example.
    * schroot/schroot.1.in: Add usage examples.

commit 68064d6fa1c6d874376d58482231b4691351a86a
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jul 2 17:13:11 2005 +0000

    * Updated README (translation and usage examples).
    * po/en_GB.po: Add British English translation.
    * po/en.po: Remove.

commit 4cf7c1e31f351fe4c31159dd5470800743f9310c
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 25 20:51:41 2005 +0000

    * debian/control (Standards-Version): Upgrade to Standards-Version 3.6.2.

commit 6f79f70a71833bb8b30b4dc92bce76f5541c76cc
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 25 20:39:36 2005 +0000

    * configure.ac, NEWS, debian/changelog: Increase version number to 0.1.2.

commit ed02d25efc2226c96b4f666787e02af3b7001a22
Author: Roger Leigh <rleigh@debian.org>
Date:   Sat Jun 25 20:30:45 2005 +0000

    * Remove UCS characters from string literals.  For the time being,
      gettext will have to handle this.
    * Update .cvsignore files.
    * TODO: Remove gettext item.
    * po/en.po: Add an English translation, to make use of UTF-8
      characters.
    * schroot/Makefile.am, schroot/*.c: Mark up strings for
      translation with gettext, and add gettext and locale
      initialisation code to main().
    * Add po/POTFILES.in with all C source files included.
    * Add additional options to po/Makevars, to make xgettext read
      the source as UTF-8.
    * bootstrap, configure.ac, Makefile.am: add GNU gettext support.

commit 496e0c6dc23d47f8b755cb5b5ccec4e2b3bdbddc
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 22:23:30 2005 +0000

    * Version 0.1.1.
    * schroot/sbuild-config.c (sbuild_config_validate_chroots):
      use g_return_val_if_fail, not g_return_if_fail.
    * configure.ac: Remove the automake "tar-pax" option, because the
      Debian build infrastructure can't cope with it yet.

commit 6afefd68b694f1c0539dbba70e9a1495d8b68614
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 21:29:27 2005 +0000

    * Change all GPL boilerplate to use the new FSF postal address.

commit f6098c27f76f461d6b88c554b23df53c6666a42a
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 18:32:59 2005 +0000

    * debian/copyright:
      - Update the postal address of the FSF.
      - Refer to /usr/share/common-licenses/GPL.
      - Add new download location.
    * Makefile.am: Remove CVS directories from the generated tarball.
    * schroot/schroot.conf.5.in: Correct .TH section from 1 to 5.
    * Remove debian/conffiles, which is not required by debhelper.
    * debian/control: Add buildd-tools developers to Uploaders,
      and remove unused ${misc:Depends}.
    * debian/changelog: Update.

commit 5d4991dbd467b1fe7d83604e7eaf2be556dce813
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 17:50:16 2005 +0000

    * Add .cvsignore files to replace lost .arch-inventory files.

commit b1a2771ab1e0939841efbf4293516afab4db9712
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 17:47:39 2005 +0000

    * Add ChangeLog to CVS
    * No longer generate ChangeLog with "tla changelog".  It must now
      be edited manually.

commit cdb0e9804d8f41d63a04c0b9fbb5eb36e96e6d64
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:54:50 2005 +0000

    Summary:
      Add strict pointer checks and bump version
    Revision:
      schroot--mainline--0.1.1--patch-1
    
    - Add strict pointer checks to all function arguments and before
      dereferencing object members.
    - Increase version number to 0.1.1.

commit b9fd0947009fcc1c00ed6ea5061f9426a1cfba55
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:18:34 2005 +0000

    Summary:
      0.1.0 released.
    Revision:
      schroot--mainline--0.1.0--version-0
    
    - Preparation for 0.1.0.

commit e80c03dba128695fecee8ae697287db6bb7b1f8b
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:12:04 2005 +0000

    Summary:
      Update configuration file
    Revision:
      schroot--mainline--0.1.0--patch-20
    
    - Comment out all entries in the sample configuration file, so that
      the installation is secure from the start.
    - Add comments to the top of the configuration file.

commit 66b91461089ed3612e8d9f73a8bc4e0d42696c20
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:11:05 2005 +0000

    Summary:
      Add initial Debian packaging
    Revision:
      schroot--mainline--0.1.0--patch-19
    
    - Add debian directory and initial files.
    - Makefile.am: add debian to SUBDIRS.

commit 311a7de44229955ef12d69c99450b9b005743de4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:08:57 2005 +0000

    Summary:
      Run a real login shell
    Revision:
      schroot--mainline--0.1.0--patch-18
    
    - SbuildSession: If no environment has been set, and no command has been
      specified, run a real login shell by prefixing - to argv[0].

commit 6b1395490dc622d8b05ed095696f0a720f69fb04
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:08:17 2005 +0000

    Summary:
      Implement --quiet option
    Revision:
      schroot--mainline--0.1.0--patch-17
    
    - SbuildSession
      + Add "quiet" property, and get_quiet and set_quiet methods.
      + Only print fatal error messages if quiet is true.
    - schroot.c: If --quiet is used, set the session quiet status.

commit f03487c85645ddc53f6e41299015113369a89731
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:06:54 2005 +0000

    Summary:
      Add --enable-debug configure option
    Revision:
      schroot--mainline--0.1.0--patch-16
    
    - Add --enable-debug configure option
    - All source files include <config.h> to detect if debugging is
      enabled.
    - schroot.c: If debugging is enabled, install a null log handler
      for g_debug messages.
    - SbuildSession: add a missing "gid" property.
    - Add the initial project requirements file.

commit d18d851d2a8e45af581080c0ba21e641150fe64b
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 12:04:56 2005 +0000

    Summary:
      Enable preservation of user environment
    Revision:
      schroot--mainline--0.1.0--patch-15
    
    - SbuildSession:
      + Add public get_environment and set_environment methods, and
        an environment data member and property.
      + Add private pam_setupenv method to copy environment into PAM.
      + sbuild_session_run: After authentication has succeeded, call
        pam_setupenv.
    - schroot.c:
      Call sbuild_session_set_environment if required.

commit 4e9f8ebfdd6a24cd114ac909d25adb7c28c45a8e
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:53:29 2005 +0000

    Summary:
      Return child exit status
    Revision:
      schroot--mainline--0.1.0--patch-14
    
    - Propagate child exit status back to caller.
    - Update TODO.

commit 9e0d83fe75db33ccd239610d80ddfaff2ce0a6ac
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:49:31 2005 +0000

    Summary:
      Document internal API
    Revision:
      schroot--mainline--0.1.0--patch-13
    
    - Document internals (private functions).
    - Update TODO.

commit 40d2f0b919455474bd13b84d7a44244d0fc3de42
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:48:23 2005 +0000

    Summary:
      Update TODO
    Revision:
      schroot--mainline--0.1.0--patch-12
    
    - Remove gtk-doc item.

commit 1f797a7c7c9bca3028b577c4bd6e75e8a0976a6d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:47:34 2005 +0000

    Summary:
      Fix const correctness
    Revision:
      schroot--mainline--0.1.0--patch-11

commit ea7d33552b27fc34d49a63508773671afe898182
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:47:02 2005 +0000

    Summary:
      Document all user-visible symbols.
    Revision:
      schroot--mainline--0.1.0--patch-10
    
    - Document all user-visible symbols with gtk-doc.

commit ab3acf8149e80bb4edfdd98c0a86e945a2784569
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:45:34 2005 +0000

    Summary:
      Add gtk-doc framework
    Revision:
      schroot--mainline--0.1.0--patch-9
    
    - Added gtk-doc API reference to doc/schroot.
    - Updated README.
    - Updated TODO.

commit 1c2eddd0f0c617d7f5967f6af8fec6d31e0bca02
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:42:31 2005 +0000

    Summary:
      Improve syslog support
    Revision:
      schroot--mainline--0.1.0--patch-8
    
    - schroot.c:
      + Use LOG_NDELAY with openlog(), otherwise messages in child processes
        are not correctly logged.
    - SbuildSession:
      + Log command or shell being run.
      + Log authentication or permissions failures.
      + Call pam_open_session correctly.

commit 3a2e21bfef1753609a23ccdef7e4ce8bffedbe83
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:41:29 2005 +0000

    Summary:
      Add session properties and PAM debugging statements
    Revision:
      schroot--mainline--0.1.0--patch-7
    
    - SbuildSession
      + Add read-only properties for uid, gid, shell, ruid and ruser.
      + Add PAM debugging statements to track PAM failure paths.
    - Updated TODO.

commit 4b7c4e5523363d80b3d2c5a70c4e3d53fae4e790
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:40:36 2005 +0000

    Summary:
      Tighten up root access
    Revision:
      schroot--mainline--0.1.0--patch-6
    
    - sbuild_session_require_auth(): Check that the user is in both
      groups and root_groups for all chroots before granting access.

commit 9229a94cb457d654267de7d889f5ef3679737948
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:38:59 2005 +0000

    Summary:
      Add manual pages and TODO
    Revision:
      schroot--mainline--0.1.0--patch-5
    
    - Add sbuild.1.in and sbuild.conf.5.in manual pages.
    - Add TODO
    - Fix typo in sbuild-session.c.

commit b04192918e8089c32c36c6893be504f9493665bd
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:36:34 2005 +0000

    Summary:
      Improve session error handling and authorisation
    Revision:
      schroot--mainline--0.1.0--patch-4
    
    - SbuildSession:
      + Use GError checks with nested conditionals so that we can shut down
        the PAM library in the correct order on failure.  The first failure
        only is reported in the case of multiple errors being propagated.
      + The root user is always granted unconditional access
      + If the host and chroot user are the same, authentication is not
        required.
      + If the user is not in groups, they do not get any access, even
        with a password.  root access still needs tighter checking.

commit cde3f6733dbb09eb75d154b0b8c59b66a3c0e739
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:35:05 2005 +0000

    Summary:
      Split PAM calls into separate functions
    Revision:
      schroot--mainline--0.1.0--patch-3
    
    - SbuildSession:
      + Each PAM call (or related set of calls) is a separate function
        (sbuild_session_pam_*).
      + PAM errors are propagated back to the caller using GError.
      + sbuild_session_run prototype changed to propagate any PAM or
        session errors to the caller.
    - SbuildConfig:
      + sbuild.conf does not require root group ownership, to allow
        more flexible administration.
    - schroot.c: Use GError to detect any session errors.

commit 6ae33102fab951be6e0d80b5a0972756bec90b0d
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:33:20 2005 +0000

    Summary:
      Add PAM configuration file
    Revision:
      schroot--mainline--0.1.0--patch-2
    
    - Add schroot/pam/schroot containing a PAM configuration file to
      install in /etc/pam.d/schroot.

commit f89e3c7c7268090f271443dc41093857d5d5e6e4
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:30:41 2005 +0000

    Summary:
      Add autotools framework
    Revision:
      schroot--mainline--0.1.0--patch-1
    
    - Add support for autoconf, automake and libtool.
    - Add support for gtk-doc.
    - Install schroot setuid root.
    - Add --version option and embed version number in the output.
    - Add AUTHORS and NEWS files.
    - Generate ChangeLog with tla.

commit 129ac3ff8bfdd46bb689052c890fd888caa61a22
Author: Roger Leigh <rleigh@debian.org>
Date:   Tue Jun 21 11:27:34 2005 +0000

    Summary:
      Initial import
    Revision:
      schroot--mainline--0.1.0--base-0
    
    Initial import into GNU Arch.
